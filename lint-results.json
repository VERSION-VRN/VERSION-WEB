[{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\ai\\knowledge.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\ai\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bot' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Bot"},"fix":{"range":[322,326],"text":""},"desc":"Remove unused variable \"Bot\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Send' is defined but never used.","line":9,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Send"},"fix":{"range":[331,337],"text":""},"desc":"Remove unused variable \"Send\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronLeft' is defined but never used.","line":9,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":38,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChevronLeft"},"fix":{"range":[337,350],"text":""},"desc":"Remove unused variable \"ChevronLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Database' is defined but never used.","line":9,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":48,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Database"},"fix":{"range":[350,360],"text":""},"desc":"Remove unused variable \"Database\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":21,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1519,1522],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1519,1522],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1762,1765],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1762,1765],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":54,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2120,2123],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2120,2123],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2225,2228],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2225,2228],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":58,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":59,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2422,2425],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2422,2425],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":101,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5565,5568],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5565,5568],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/navigation';\r\nimport { aiVersionClient } from '@/services/aiVersionClient';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport { Bot, User, Send, ChevronLeft, Database, Terminal } from 'lucide-react';\r\nimport '../globals.css';\r\n\r\nexport default function AIChat() {\r\n    const { user, deductCredits, refreshCredits } = useAuth();\r\n    const [messages, setMessages] = useState([\r\n        { role: 'ai', content: 'Hola, Rebelde. Soy VERSION AI, tu estratega de contenido. He cargado el \"Master en YouTube\" y estoy listo para orquestar tu canal. ¬øQu√© paso del proceso vamos a automatizar hoy?' }\r\n    ]);\r\n    const [input, setInput] = useState('');\r\n    const [isTyping, setIsTyping] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const scrollRef = useRef<HTMLDivElement>(null);\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        setIsLoading(false);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (scrollRef.current) {\r\n            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n        }\r\n    }, [messages]);\r\n\r\n    if (isLoading) return <div className=\"min-h-screen bg-black\" />;\r\n\r\n    const handleSend = async () => {\r\n        if (!input.trim()) return;\r\n\r\n        const COST = 1;\r\n        if (!user || user.credits < COST) {\r\n            setMessages((prev: any[]) => [...prev, { role: 'ai', content: '‚ùå Saldo insuficiente para procesar tu consulta. (1 token requerido)' }]);\r\n            return;\r\n        }\r\n\r\n        const userMessage = { role: 'user', content: input };\r\n        setMessages((prev: any[]) => [...prev, userMessage]);\r\n        setInput('');\r\n        setIsTyping(true);\r\n        deductCredits(COST);\r\n\r\n        try {\r\n            const response = await aiVersionClient.chat(userMessage.content);\r\n            if (response.success && response.response) {\r\n                const content = response.response;\r\n                setMessages((prev: any[]) => [...prev, { role: 'ai', content }]);\r\n            } else {\r\n                setMessages((prev: any[]) => [...prev, { role: 'ai', content: `‚ùå Error de sistema: ${response.error || 'No se pudo obtener respuesta.'}` }]);\r\n            }\r\n        } catch (error) {\r\n            setMessages((prev: any[]) => [...prev, { role: 'ai', content: '‚ùå Error de conexi√≥n con el estratega.' }]);\r\n        } finally {\r\n            setIsTyping(false);\r\n            refreshCredits();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex h-screen bg-black text-white selection:bg-primary/30\">\r\n            {/* Sidebar */}\r\n            <aside className=\"w-20 hidden md:flex flex-col items-center py-12 border-r border-white/[0.04] bg-zinc-950/20 backdrop-blur-xl shrink-0\">\r\n                <Link href=\"/dashboard\" className=\"text-2xl font-black text-primary mb-12 hover:scale-110 transition-transform\">V.</Link>\r\n                <div className=\"flex flex-col gap-6\">\r\n                    <Link href=\"/dashboard\" title=\"Dashboard\" className=\"w-10 h-10 rounded-xl flex items-center justify-center text-lg opacity-40 hover:opacity-100 hover:bg-white/[0.04] transition-all\">üìä</Link>\r\n                    <span title=\"AI Chat\" className=\"w-10 h-10 rounded-xl flex items-center justify-center text-lg cursor-pointer bg-primary/10 border border-primary/15 text-primary\">ü§ñ</span>\r\n                    <Link href=\"/editor\" title=\"Video Editor\" className=\"w-10 h-10 rounded-xl flex items-center justify-center text-lg opacity-40 hover:opacity-100 hover:bg-white/[0.04] transition-all\">üé¨</Link>\r\n                    <Link href=\"/\" title=\"Home\" className=\"w-10 h-10 rounded-xl flex items-center justify-center text-lg opacity-40 hover:opacity-100 hover:bg-white/[0.04] transition-all\">üåê</Link>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Chat Container */}\r\n            <main className=\"flex-1 flex flex-col h-full relative overflow-hidden\">\r\n                <header className=\"p-6 md:px-12 border-b border-white/[0.04] flex justify-between items-center bg-black/40 backdrop-blur-md z-10\">\r\n                    <div className=\"flex items-center gap-6\">\r\n                        <div>\r\n                            <h1 className=\"text-sm font-black tracking-[0.3em] uppercase\">VERSION <span className=\"text-primary\">AI</span></h1>\r\n                            <div className=\"flex items-center gap-2 mt-1\">\r\n                                <span className=\"w-1.5 h-1.5 bg-primary rounded-full animate-pulse\"></span>\r\n                                <span className=\"text-[9px] text-primary font-bold uppercase tracking-widest\">Estratega Activo</span>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"hidden lg:flex items-center gap-2 px-4 py-2 bg-primary/5 border border-primary/10 rounded-full\">\r\n                            <span className=\"text-[8px] font-bold uppercase text-primary/70 tracking-tighter\">Database:</span>\r\n                            <span className=\"text-[9px] font-bold uppercase text-white tracking-widest\">YouTube_Master_Data</span>\r\n                        </div>\r\n                    </div>\r\n                </header>\r\n\r\n                <div\r\n                    ref={scrollRef}\r\n                    className=\"flex-1 overflow-y-auto p-6 md:p-12 space-y-8 custom-scrollbar scroll-smooth\"\r\n                >\r\n                    {messages.map((m: any, i: number) => (\r\n                        <div key={i} className={`flex flex-col ${m.role === 'user' ? 'items-end' : 'items-start'} max-w-4xl mx-auto w-full group/msg`}>\r\n                            <div className={`${m.role === 'ai'\r\n                                ? 'bg-zinc-950/60 backdrop-blur-xl border border-white/[0.06] p-8 rounded-3xl rounded-tl-lg shadow-2xl relative overflow-hidden'\r\n                                : 'bg-primary text-white p-6 rounded-3xl rounded-tr-lg shadow-[0_10px_40px_rgba(220,38,38,0.25)]'\r\n                                } max-w-[90%] md:max-w-[85%] text-sm font-medium leading-relaxed`}>\r\n\r\n                                {m.role === 'ai' && (\r\n                                    <div className=\"absolute -top-12 -right-12 w-32 h-32 bg-primary/5 blur-[50px] rounded-full pointer-events-none\" />\r\n                                )}\r\n\r\n                                {m.role === 'ai' ? (\r\n                                    <div className=\"prose prose-invert prose-sm max-w-none text-zinc-200\">\r\n                                        <ReactMarkdown\r\n                                            components={{\r\n                                                p: ({ children }) => <p className=\"mb-4 last:mb-0 leading-relaxed\">{children}</p>,\r\n                                                h1: ({ children }) => <h1 className=\"text-xl font-black uppercase tracking-tighter mb-4 text-white\">{children}</h1>,\r\n                                                h2: ({ children }) => <h2 className=\"text-lg font-black uppercase tracking-tighter mb-3 text-white/90\">{children}</h2>,\r\n                                                h3: ({ children }) => <h3 className=\"text-md font-bold uppercase tracking-widest mb-2 text-primary\">{children}</h3>,\r\n                                                ul: ({ children }) => <ul className=\"space-y-2 mb-4 list-disc list-inside\">{children}</ul>,\r\n                                                ol: ({ children }) => <ol className=\"space-y-2 mb-4 list-decimal list-inside\">{children}</ol>,\r\n                                                li: ({ children }) => <li className=\"text-zinc-400\">{children}</li>,\r\n                                                code: ({ children }) => <code className=\"bg-white/10 px-1.5 py-0.5 rounded text-primary font-mono text-[11px]\">{children}</code>,\r\n                                                blockquote: ({ children }) => <blockquote className=\"border-l-2 border-primary/40 pl-4 italic text-zinc-500 my-4\">{children}</blockquote>\r\n                                            }}\r\n                                        >\r\n                                            {m.content}\r\n                                        </ReactMarkdown>\r\n                                    </div>\r\n                                ) : (\r\n                                    <span className=\"whitespace-pre-wrap\">{m.content}</span>\r\n                                )}\r\n                            </div>\r\n                            <span className=\"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-zinc-600 mt-4 px-2 opacity-0 group-hover/msg:opacity-100 transition-opacity\">\r\n                                {m.role === 'ai' ? <><Terminal size={10} className=\"text-primary\" /> Strategist_Shell</> : <><User size={10} /> Authorized_User</>}\r\n                            </span>\r\n                        </div>\r\n                    ))}\r\n                    {isTyping && (\r\n                        <div className=\"max-w-4xl mx-auto w-full\">\r\n                            <div className=\"text-[10px] text-primary font-bold uppercase tracking-[0.2em] animate-pulse\">\r\n                                Extrayendo datos t√©cnicos...\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <footer className=\"p-6 md:p-12 bg-gradient-to-t from-black via-black/95 to-transparent\">\r\n                    <div className=\"max-w-4xl mx-auto relative group\">\r\n                        <input\r\n                            type=\"text\"\r\n                            value={input}\r\n                            onChange={(e) => setInput(e.target.value)}\r\n                            onKeyDown={(e) => e.key === 'Enter' && handleSend()}\r\n                            placeholder=\"Pregunta por ganchos, nichos, SEO o miniaturas...\"\r\n                            className=\"w-full bg-white/[0.03] border border-white/[0.06] rounded-2xl p-5 pr-28 text-sm focus:outline-none focus:border-primary/30 focus:shadow-[0_0_0_3px_rgba(220,38,38,0.06)] transition-all placeholder:text-zinc-600 font-medium\"\r\n                        />\r\n                        <button\r\n                            onClick={handleSend}\r\n                            className=\"absolute right-2.5 top-1/2 -translate-y-1/2 px-6 py-2.5 bg-primary text-[10px] font-bold uppercase tracking-widest rounded-xl hover:bg-primary-hover transition-colors shadow-lg active:scale-95\"\r\n                        >\r\n                            Enviar\r\n                        </button>\r\n                    </div>\r\n                </footer>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\dashboard\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\dashboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EliteBadge' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":20,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"EliteBadge"},"fix":{"range":[319,377],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Navbar' is defined but never used.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Navbar"},"fix":{"range":[493,540],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1518,1521],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1518,1521],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchHistory' and 'router'. Either include them or remove the dependency array.","line":48,"column":8,"nodeType":"ArrayExpression","endLine":48,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [user, isLoading, router, fetchHistory]","fix":{"range":[1921,1938],"text":"[user, isLoading, router, fetchHistory]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":291,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":291,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17282,17285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17282,17285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useRouter, usePathname } from 'next/navigation';\r\nimport { EliteCard } from '@/components/ui/EliteCard';\r\nimport { EliteButton } from '@/components/ui/EliteButton';\r\nimport { EliteBadge } from '@/components/ui/EliteBadge';\r\nimport { EmptyState } from '@/components/ui/EmptyState';\r\nimport { CreditsBar } from '@/components/ui/CreditsBar';\r\nimport { Navbar } from '@/components/Navbar';\r\n\r\nconst TASK_TYPE_META: Record<string, { icon: string, label: string }> = {\r\n    'editor': { icon: 'üé¨', label: 'Editor' },\r\n    'thumbnails': { icon: 'üñºÔ∏è', label: 'Dise√±o' },\r\n    'writer': { icon: 'üìù', label: 'Writer' },\r\n    'seo': { icon: 'üöÄ', label: 'SEO' },\r\n    'ai': { icon: 'ü§ñ', label: 'VERSION AI' }\r\n};\r\n\r\n// Navegaci√≥n centralizada para evitar duplicados\r\nconst SIDEBAR_NAV = [\r\n    { label: 'Vista General', href: '/dashboard', icon: 'üìä' },\r\n    { label: 'VERSION AI Chat', href: '/ai', icon: 'ü§ñ' },\r\n    { label: 'VERSION Editor', href: '/editor', icon: 'üé¨' },\r\n    { label: 'Thumbnails', href: '/thumbnails', icon: 'üñºÔ∏è' },\r\n    { label: 'Script Writer', href: '/writer', icon: 'üìù' },\r\n    { label: 'VERSION SEO', href: '/seo', icon: 'üöÄ' },\r\n];\r\n\r\nexport default function DashboardPage() {\r\n    const { user, isAdmin, logout } = useAuth();\r\n    const router = useRouter();\r\n    const pathname = usePathname();\r\n    const [history, setHistory] = useState<any[]>([]);\r\n    const [isLoadingHistory, setIsLoadingHistory] = useState(true);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (!user && !isLoading) {\r\n            router.push('/login');\r\n        } else {\r\n            setIsLoading(false);\r\n            fetchHistory();\r\n        }\r\n    }, [user, isLoading]);\r\n\r\n    const fetchHistory = async () => {\r\n        if (!user?.id) return;\r\n        try {\r\n            const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/all-videos?user_id=${user.id}`);\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                setHistory(data);\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Error fetching history:\", err);\r\n        } finally {\r\n            setIsLoadingHistory(false);\r\n        }\r\n    };\r\n\r\n    const handleLogout = () => {\r\n        logout();\r\n    };\r\n\r\n    const userName = user?.name || user?.email || 'Usuario';\r\n\r\n    if (isLoading) return <div className=\"min-h-screen\" style={{ background: 'var(--background)' }} />;\r\n\r\n    return (\r\n        <div className=\"flex min-h-screen selection:bg-primary/30\" style={{ background: 'var(--background)', color: 'var(--foreground)' }}>\r\n\r\n            {/* Mobile Bottom Navigation */}\r\n            <div className=\"lg:hidden fixed bottom-6 left-1/2 -translate-x-1/2 z-[100] w-[90%] max-w-md\">\r\n                <div className=\"bg-zinc-950/80 backdrop-blur-2xl border border-white/10 rounded-2xl p-2 flex justify-around items-center shadow-2xl\">\r\n                    {SIDEBAR_NAV.slice(0, 4).map((item) => {\r\n                        const isActive = pathname === item.href;\r\n                        return (\r\n                            <Link key={item.href} href={item.href} className={`flex flex-col items-center p-2 rounded-xl transition-all ${isActive ? 'bg-primary/10 text-primary' : 'text-zinc-500 hover:text-white'}`}>\r\n                                <span className=\"text-lg\">{item.icon}</span>\r\n                                <span className=\"text-[8px] font-bold uppercase mt-1 tracking-tighter\">{item.label.split(' ')[0]}</span>\r\n                            </Link>\r\n                        );\r\n                    })}\r\n                    <button\r\n                        onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}\r\n                        className=\"flex flex-col items-center p-2 text-zinc-500 hover:text-white\"\r\n                    >\r\n                        <span className=\"text-lg\">‚ò∞</span>\r\n                        <span className=\"text-[8px] font-bold uppercase mt-1\">M√°s</span>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Mobile Expandable Menu */}\r\n            {isMobileMenuOpen && (\r\n                <div className=\"fixed inset-0 z-[110] bg-black/60 backdrop-blur-sm lg:hidden\" onClick={() => setIsMobileMenuOpen(false)}>\r\n                    <div className=\"absolute bottom-24 left-1/2 -translate-x-1/2 w-[90%] max-w-md animate-slide-up\" onClick={e => e.stopPropagation()}>\r\n                        <EliteCard variant=\"glass\" className=\"overflow-hidden !p-2\">\r\n                            {SIDEBAR_NAV.map((item) => (\r\n                                <Link key={item.href} href={item.href} className=\"flex items-center gap-4 p-4 hover:bg-white/5 rounded-xl text-xs font-bold transition-all\">\r\n                                    <span className=\"text-xl\">{item.icon}</span> {item.label}\r\n                                </Link>\r\n                            ))}\r\n                            <button onClick={handleLogout} className=\"w-full flex items-center gap-4 p-4 text-red-500 hover:bg-red-500/10 rounded-xl text-xs font-bold transition-all border-t border-white/5 mt-2\">\r\n                                <span>üö™</span> Cerrar Sesi√≥n\r\n                            </button>\r\n                        </EliteCard>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Desktop Sidebar */}\r\n            <aside className=\"w-[280px] hidden lg:flex flex-col border-r border-white/[0.04] p-8 fixed h-full bg-zinc-950/20 backdrop-blur-xl z-50\">\r\n                <Link href=\"/\" className=\"text-xl font-black tracking-tighter uppercase mb-12 flex items-center gap-1 group\">\r\n                    <span className=\"group-hover:text-primary transition-colors\">VERSION</span><span className=\"text-primary text-3xl\">.</span>\r\n                </Link>\r\n\r\n                <nav className=\"flex flex-col gap-2\">\r\n                    <div className=\"text-[10px] text-zinc-500 font-bold tracking-widest mb-4 uppercase\">Men√∫ Principal</div>\r\n                    {SIDEBAR_NAV.map((item) => {\r\n                        const isActive = pathname === item.href;\r\n                        return (\r\n                            <Link\r\n                                key={item.href}\r\n                                href={item.href}\r\n                                className={`flex items-center gap-3 p-3.5 text-xs font-bold transition-all rounded-xl border-l-2 ${isActive\r\n                                        ? 'bg-white/[0.04] border-primary text-foreground'\r\n                                        : 'border-transparent text-zinc-500 hover:text-white hover:bg-white/[0.04]'\r\n                                    }`}\r\n                            >\r\n                                <span className={`opacity-70 transition-opacity ${isActive ? 'opacity-100' : ''}`}>{item.icon}</span>\r\n                                {item.label}\r\n                            </Link>\r\n                        );\r\n                    })}\r\n                </nav>\r\n\r\n                <div className=\"mt-auto pt-8 border-t border-white/[0.04]\">\r\n                    <CreditsBar credits={user?.credits || 0} maxCredits={isAdmin ? 1000000 : 1000} label={isAdmin ? 'Infinite Access' : 'Tokens Disponibles'} />\r\n                    <button onClick={handleLogout} className=\"w-full mt-8 p-3.5 text-[10px] font-bold uppercase tracking-widest text-zinc-600 hover:text-red-500 border border-white/[0.04] hover:border-red-500/20 rounded-xl transition-all\">\r\n                        Cerrar Sesi√≥n\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"flex-1 lg:ml-[280px] p-8 md:p-12 pb-32 lg:pb-12\">\r\n                <header className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-16\">\r\n                    <div>\r\n                        <div className=\"flex items-center gap-3 mb-2\">\r\n                            <h1 className=\"text-4xl md:text-5xl font-black tracking-tighter uppercase\">\r\n                                HOLA, <span className=\"text-primary\">{isAdmin ? 'ADMIN' : userName.split(' ')[0]}</span>\r\n                            </h1>\r\n                            {isAdmin && (\r\n                                <span className=\"text-[10px] font-black bg-primary/10 text-primary border border-primary/20 px-3 py-1 rounded-full uppercase tracking-widest animate-pulse\">\r\n                                    Admin Mode\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                        <p className=\"font-medium text-sm\" style={{ color: 'var(--muted)' }}>\r\n                            {isAdmin ? 'Panel de control maestro activo. Ecosistema bajo control.' : 'Tu arsenal digital est√° listo para la acci√≥n.'}\r\n                        </p>\r\n                    </div>\r\n                </header>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-20 animate-fade\">\r\n                    <EliteCard variant=\"glass\" className=\"flex justify-between items-center p-8 group hover:scale-[1.01]\">\r\n                        <div>\r\n                            <span className=\"text-[10px] text-zinc-500 font-bold uppercase tracking-widest mb-2 block\">Tokens de Combate</span>\r\n                            <div className=\"text-5xl font-black tabular-nums transition-transform group-hover:scale-110 origin-left duration-500\">{isAdmin ? '‚àû' : user?.credits || 0}</div>\r\n                        </div>\r\n                        <EliteButton variant=\"outline\" size=\"md\" onClick={() => router.push('/pricing')}>\r\n                            A√±adir Fondos\r\n                        </EliteButton>\r\n                    </EliteCard>\r\n                    <EliteCard variant=\"glass\" className=\"flex justify-between items-center p-8 group hover:scale-[1.01]\">\r\n                        <div>\r\n                            <span className=\"text-[10px] text-zinc-500 font-bold uppercase tracking-widest mb-2 block\">Rendimiento Operativo</span>\r\n                            <div className=\"text-5xl font-black tabular-nums transition-colors group-hover:text-primary duration-500 opacity-20 group-hover:opacity-100\">68%</div>\r\n                        </div>\r\n                        <div className=\"text-[9px] text-zinc-600 font-bold uppercase tracking-widest text-right\">Optimizaci√≥n <br /> en curso</div>\r\n                    </EliteCard>\r\n                </div>\r\n\r\n                {/* Grid de Aplicaciones */}\r\n                <section className=\"mb-20 animate-fade\" style={{ animationDelay: '0.1s' }}>\r\n                    <div className=\"flex justify-between items-center mb-8\">\r\n                        <h2 className=\"text-xs font-bold tracking-[0.3em] text-zinc-500 uppercase flex items-center gap-2\">\r\n                            <span className=\"w-1.5 h-1.5 bg-primary rounded-full animate-ping\" />\r\n                            Apps & Herramientas\r\n                        </h2>\r\n                        <Link href=\"/pricing\" className=\"text-primary text-[10px] font-bold uppercase tracking-widest hover:text-primary/70 transition-all\">Ver Planes Elite ‚Üí</Link>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                        {/* VERSION EDITOR */}\r\n                        <EliteCard\r\n                            variant=\"glass\"\r\n                            title=\"VERSION Editor\"\r\n                            subtitle=\"Pro Ready\"\r\n                            description=\"Automatizaci√≥n de clips de YouTube con IA y edici√≥n profesional integrada.\"\r\n                            headerAction={<span className=\"text-3xl\">üé¨</span>}\r\n                        >\r\n                            <EliteButton variant=\"primary\" size=\"md\" fullWidth onClick={() => router.push('/editor')}>\r\n                                Abrir Sistema\r\n                            </EliteButton>\r\n                        </EliteCard>\r\n\r\n                        {/* VERSION THUMBNAILS */}\r\n                        <EliteCard\r\n                            variant=\"glass\"\r\n                            title=\"Thumbnails\"\r\n                            subtitle=\"Visual Core\"\r\n                            description=\"Dise√±o de miniaturas y an√°lisis CTR avanzado con redes neuronales.\"\r\n                            headerAction={<span className=\"text-3xl\">üñºÔ∏è</span>}\r\n                        >\r\n                            <EliteButton variant=\"outline\" size=\"md\" fullWidth className=\"hover:!bg-[#a855f7] hover:!text-white hover:!border-[#a855f7]\" onClick={() => router.push('/thumbnails')}>\r\n                                Dise√±ar Impacto\r\n                            </EliteButton>\r\n                        </EliteCard>\r\n\r\n                        {/* VERSION WRITER */}\r\n                        <EliteCard\r\n                            variant=\"glass\"\r\n                            title=\"Writer\"\r\n                            subtitle=\"Script Engine\"\r\n                            description=\"Ingenier√≠a de guiones virales con estructuras de alta retenci√≥n.\"\r\n                            headerAction={<span className=\"text-3xl\">üìù</span>}\r\n                        >\r\n                            <EliteButton variant=\"outline\" size=\"md\" fullWidth className=\"hover:!bg-red-500 hover:!text-white hover:!border-red-500\" onClick={() => router.push('/writer')}>\r\n                                Iniciar Script\r\n                            </EliteButton>\r\n                        </EliteCard>\r\n\r\n                        {/* VERSION SEO */}\r\n                        <EliteCard\r\n                            variant=\"glass\"\r\n                            title=\"SEO Growth\"\r\n                            subtitle=\"Growth Engine\"\r\n                            description=\"Dominaci√≥n de motores de b√∫squeda y an√°lisis de competencia viral.\"\r\n                            headerAction={<span className=\"text-3xl\">üöÄ</span>}\r\n                        >\r\n                            <EliteButton variant=\"outline\" size=\"md\" fullWidth className=\"hover:!bg-green-500 hover:!text-white hover:!border-green-500\" onClick={() => router.push('/seo')}>\r\n                                Optimizar Canal\r\n                            </EliteButton>\r\n                        </EliteCard>\r\n\r\n                        {/* VERSION AI */}\r\n                        <EliteCard\r\n                            variant=\"glass\"\r\n                            title=\"VERSION AI\"\r\n                            subtitle=\"Neural System\"\r\n                            description=\"Consultor estrat√©gico 24/7 basado en el Master de YouTube.\"\r\n                            headerAction={<span className=\"text-3xl\">ü§ñ</span>}\r\n                            className=\"md:col-span-2 lg:col-span-1\"\r\n                        >\r\n                            <EliteButton variant=\"secondary\" size=\"md\" fullWidth onClick={() => router.push('/ai')}>\r\n                                Hablar con Or√°culo\r\n                            </EliteButton>\r\n                        </EliteCard>\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Historial Operativo */}\r\n                <section className=\"animate-fade\" style={{ animationDelay: '0.2s' }}>\r\n                    <div className=\"flex justify-between items-center mb-8\">\r\n                        <h2 className=\"text-xs font-bold tracking-[0.3em] text-zinc-500 uppercase\">Historial Operativo</h2>\r\n                        <span className=\"text-[10px] text-zinc-600 font-mono italic\">√öltimos despliegues</span>\r\n                    </div>\r\n\r\n                    <EliteCard variant=\"solid\" className=\"overflow-hidden !p-0\">\r\n                        {isLoadingHistory ? (\r\n                            <div className=\"p-20 text-center animate-pulse text-zinc-700 uppercase tracking-widest text-[10px] font-bold\">\r\n                                Sincronizando datos...\r\n                            </div>\r\n                        ) : history.length > 0 ? (\r\n                            <div className=\"overflow-x-auto custom-scrollbar\">\r\n                                <table className=\"w-full text-left border-collapse min-w-[600px]\">\r\n                                    <thead>\r\n                                        <tr className=\"border-b border-white/[0.04] bg-white/[0.01]\">\r\n                                            <th className=\"px-6 py-4 text-[9px] font-bold uppercase tracking-widest text-zinc-500\">Origen / Herramienta</th>\r\n                                            <th className=\"px-6 py-4 text-[9px] font-bold uppercase tracking-widest text-zinc-500\">Estado</th>\r\n                                            <th className=\"px-6 py-4 text-[9px] font-bold uppercase tracking-widest text-zinc-500 text-right\">Acciones</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody className=\"divide-y divide-white/[0.02]\">\r\n                                        {history.map((item: any) => {\r\n                                            const meta = TASK_TYPE_META[item.task_type] || { icon: 'üì¶', label: 'Proceso' };\r\n                                            return (\r\n                                                <tr key={item.id} className=\"hover:bg-white/[0.01] transition-colors group\">\r\n                                                    <td className=\"px-6 py-4\">\r\n                                                        <div className=\"flex items-center gap-3\">\r\n                                                            <span className=\"text-lg opacity-40 group-hover:opacity-100 transition-opacity\">{meta.icon}</span>\r\n                                                            <div>\r\n                                                                <div className=\"text-[11px] font-black uppercase tracking-tight\">{item.filename || 'Proceso sin nombre'}</div>\r\n                                                                <div className=\"text-[8px] text-zinc-500 font-bold uppercase tracking-widest\">{meta.label} System ‚Ä¢ {new Date(item.created_at).toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit' })}</div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </td>\r\n                                                    <td className=\"px-6 py-4\">\r\n                                                        <span className={`text-[8px] font-black uppercase tracking-widest px-2.5 py-1 rounded-full border ${item.status === 'completed' ? 'border-emerald-500/20 text-emerald-500 bg-emerald-500/5' :\r\n                                                            item.status === 'failed' ? 'border-red-500/20 text-red-500 bg-red-500/5' :\r\n                                                                'border-amber-500/20 text-amber-500 bg-amber-500/5 animate-pulse'\r\n                                                            }`}>\r\n                                                            {item.status === 'completed' ? 'Sincronizado' :\r\n                                                                item.status === 'failed' ? 'Error Cr√≠tico' :\r\n                                                                    'En Proceso'}\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td className=\"px-6 py-4 text-right\">\r\n                                                        <div className=\"flex justify-end gap-2 text-[10px]\">\r\n                                                            {item.result_url && (\r\n                                                                <a href={item.result_url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"p-2.5 bg-primary/10 border border-primary/20 text-primary rounded-lg transition-all hover:bg-primary/20\">\r\n                                                                    DESCARGAR\r\n                                                                </a>\r\n                                                            )}\r\n                                                            <button className=\"p-2.5 bg-white/5 border border-white/10 rounded-lg transition-all hover:bg-white/10\">\r\n                                                                DETALLES\r\n                                                            </button>\r\n                                                        </div>\r\n                                                    </td>\r\n                                                </tr>\r\n                                            );\r\n                                        })}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        ) : (\r\n                            <EmptyState\r\n                                icon=\"üì≠\"\r\n                                title=\"Sin despliegues registrados\"\r\n                                description=\"A√∫n no has iniciado ninguna operaci√≥n de generaci√≥n. Tu historial aparecer√° aqu√≠.\"\r\n                                actionLabel=\"Abrir Editor\"\r\n                                actionHref=\"/editor\"\r\n                            />\r\n                        )}\r\n                    </EliteCard>\r\n                </section>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\editor\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\editor\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\editor\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":197,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8579,8582],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8579,8582],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleUploadMusic' is assigned a value but never used.","line":217,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":217,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":246,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":246,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10768,10771],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10768,10771],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":586,"column":41,"nodeType":"JSXOpeningElement","endLine":590,"endColumn":43},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":712,"column":98,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":712,"endColumn":101,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[42138,42141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[42138,42141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/navigation';\r\nimport '../globals.css';\r\nimport Toast, { ToastType } from '@/components/Toast';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { apiFetch, getApiUrl } from '@/lib/api';\r\n\r\ninterface Voice {\r\n    name: string;\r\n    id: string;\r\n}\r\n\r\ninterface Prompt {\r\n    name: string;\r\n    prompt: string;\r\n}\r\n\r\ninterface Metadata {\r\n    idiomas: string[];\r\n    voices: Record<string, Voice[]>;\r\n    prompts: Record<string, Prompt[]>;\r\n    subtitle_styles: string[];\r\n    subtitle_colors: string[];\r\n    subtitle_positions: string[];\r\n}\r\n\r\nconst DEFAULT_SUBTITLE_STYLES = [\"Cl√°sico\", \"Din√°mico (Efusivo)\", \"Moderno\", \"Impacto\", \"Limpio (Caja)\"];\r\nconst DEFAULT_SUBTITLE_COLORS = [\"Blanco\", \"Amarillo\", \"Rojo\", \"Azul\", \"Verde\", \"Cian\", \"Magenta\", \"Naranja\", \"Gris\"];\r\nconst DEFAULT_SUBTITLE_POSITIONS = [\"Abajo\", \"Centro\", \"Arriba\"];\r\n\r\n// ‚îÄ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ\r\nconst isValidYoutubeUrl = (url: string) => {\r\n    return /^(https?:\\/\\/)?(www\\.)?(youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/shorts\\/)[\\w-]+/.test(url);\r\n};\r\n\r\nconst getYoutubeThumbnail = (url: string) => {\r\n    const regExp = /^.*(youtu\\.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|\\&v=)([^#\\&\\?]*).*/;\r\n    const match = url.match(regExp);\r\n    if (match && match[2].length === 11) {\r\n        return `https://img.youtube.com/vi/${match[2]}/mqdefault.jpg`;\r\n    }\r\n    return null;\r\n};\r\n\r\nconst STEP_LABELS = ['Recursos', 'Datos', 'Estilo'];\r\n\r\nexport default function VideoEditor() {\r\n    const { user, deductCredits, refreshCredits } = useAuth();\r\n    const credits = user?.credits || 0;\r\n    const [metadata, setMetadata] = useState<Metadata | null>(null);\r\n    const [isAdmin, setIsAdmin] = useState(false);\r\n    const [isLoadingAuth, setIsLoadingAuth] = useState(true);\r\n    const router = useRouter();\r\n\r\n    const [currentStep, setCurrentStep] = useState(1);\r\n    const totalSteps = 3;\r\n\r\n    const [selectedIdioma, setSelectedIdioma] = useState('Espa√±ol');\r\n    const [selectedVoice, setSelectedVoice] = useState('');\r\n    const [selectedPrompt, setSelectedPrompt] = useState('');\r\n    const [formData, setFormData] = useState({\r\n        url: '',\r\n        titulo: '',\r\n        miniatura: '',\r\n        backgroundVideo: null as File | null,\r\n        backgroundVideoPath: '',\r\n        music: null as File | null,\r\n        musicPath: '',\r\n        musicVolume: 0.15\r\n    });\r\n    const [selectedSubtitleStyle, setSelectedSubtitleStyle] = useState('Cl√°sico');\r\n    const [selectedSubtitleColor, setSelectedSubtitleColor] = useState('Blanco');\r\n    const [selectedSubtitlePosition, setSelectedSubtitlePosition] = useState('Abajo');\r\n\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n    const [progress, setProgress] = useState(0);\r\n    const [statusMessage, setStatusMessage] = useState('');\r\n    const [uploadingBg, setUploadingBg] = useState(false);\r\n    const [uploadProgress, setUploadProgress] = useState(0);\r\n    const [configError, setConfigError] = useState('');\r\n    const [isLoadingConfig, setIsLoadingConfig] = useState(true);\r\n    const [resultData, setResultData] = useState<{ video_path: string, script_path?: string } | null>(null);\r\n    const [currentTaskId, setCurrentTaskId] = useState<string | null>(null);\r\n    const [isAwaitingScript, setIsAwaitingScript] = useState(false);\r\n    const [editedScript, setEditedScript] = useState('');\r\n    const [isConfirmingScript, setIsConfirmingScript] = useState(false);\r\n    const [targetLength, setTargetLength] = useState<'short' | 'medium' | 'long'>('medium');\r\n\r\n    // Toast State\r\n    const [toast, setToast] = useState<{ message: string; type: ToastType } | null>(null);\r\n    const showToast = (message: string, type: ToastType = 'info') => {\r\n        setToast({ message, type });\r\n    };\r\n\r\n\r\n    useEffect(() => {\r\n        if (!user) return;\r\n        setIsAdmin(user.role === 'admin');\r\n        setIsLoadingAuth(false);\r\n\r\n        const loadConfig = async () => {\r\n            setIsLoadingConfig(true);\r\n            setConfigError('');\r\n            try {\r\n                const metaData = await apiFetch<Metadata & { success: boolean }>('/metadata');\r\n                if (metaData.success) {\r\n                    setMetadata(metaData);\r\n                    const defaultLang = \"Espa√±ol\";\r\n                    const initialLang = metaData.idiomas.includes(defaultLang) ? defaultLang : metaData.idiomas[0];\r\n                    setSelectedIdioma(initialLang);\r\n                    if (metaData.voices[initialLang]) setSelectedVoice(metaData.voices[initialLang][0].id);\r\n                    if (metaData.prompts[initialLang]) setSelectedPrompt(metaData.prompts[initialLang][0].name);\r\n                    if (metaData.subtitle_styles) setSelectedSubtitleStyle(metaData.subtitle_styles[0]);\r\n                    if (metaData.subtitle_colors) setSelectedSubtitleColor(metaData.subtitle_colors[0]);\r\n                    if (metaData.subtitle_positions) setSelectedSubtitlePosition(metaData.subtitle_positions[0]);\r\n                }\r\n            } catch (err) {\r\n                const errorMessage = err instanceof Error ? err.message : 'Error desconocido';\r\n                console.error('Error de Carga:', err);\r\n                setConfigError('No se pudo conectar con el servidor. ' + errorMessage);\r\n            } finally {\r\n                setIsLoadingConfig(false);\r\n            }\r\n        };\r\n        loadConfig();\r\n    }, [user]);\r\n\r\n    const handleIdiomaChange = (lang: string) => {\r\n        setSelectedIdioma(lang);\r\n        if (metadata) {\r\n            if (metadata.voices[lang]) setSelectedVoice(metadata.voices[lang][0].id);\r\n            if (metadata.prompts[lang]) setSelectedPrompt(metadata.prompts[lang][0].name);\r\n        }\r\n    };\r\n\r\n    const handleUploadBackground = async (file: File) => {\r\n        setUploadingBg(true);\r\n        setUploadProgress(0);\r\n        setStatusMessage('Iniciando carga...');\r\n\r\n        const CHUNK_SIZE = 2 * 1024 * 1024;\r\n        const totalChunks = Math.ceil(file.size / CHUNK_SIZE);\r\n        const fileId = `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\r\n\r\n        try {\r\n            for (let i = 0; i < totalChunks; i++) {\r\n                const start = i * CHUNK_SIZE;\r\n                const end = Math.min(start + CHUNK_SIZE, file.size);\r\n                const chunk = file.slice(start, end);\r\n\r\n                const chunkFormData = new FormData();\r\n                chunkFormData.append('file_id', fileId);\r\n                chunkFormData.append('chunk_index', i.toString());\r\n                chunkFormData.append('total_chunks', totalChunks.toString());\r\n                chunkFormData.append('file', chunk);\r\n\r\n                let retries = 3;\r\n                let success = false;\r\n\r\n                while (retries > 0 && !success) {\r\n                    try {\r\n                        const res = await fetch(getApiUrl('/upload-chunk'), {\r\n                            method: 'POST',\r\n                            headers: { 'bypass-tunnel-reminder': 'true', 'ngrok-skip-browser-warning': 'true' },\r\n                            body: chunkFormData\r\n                        });\r\n                        if (res.ok) {\r\n                            success = true;\r\n                        } else {\r\n                            const errorText = await res.text();\r\n                            let errorDetail = 'Server error';\r\n                            try {\r\n                                const errorJson = JSON.parse(errorText);\r\n                                errorDetail = errorJson.detail || errorJson.error || errorText;\r\n                            } catch { errorDetail = errorText || `Error ${res.status}`; }\r\n                            throw new Error(`[Chunk ${i}] ${res.status}: ${errorDetail}`);\r\n                        }\r\n                    } catch (e) {\r\n                        retries--;\r\n                        if (retries === 0) throw e;\r\n                        await new Promise(r => setTimeout(r, 1500));\r\n                    }\r\n                }\r\n                const percent = Math.round(((i + 1) / totalChunks) * 100);\r\n                setUploadProgress(percent);\r\n                setStatusMessage(`Subiendo: ${percent}%`);\r\n            }\r\n\r\n            setStatusMessage('Ensamblando...');\r\n            const formDataAssemble = new FormData();\r\n            formDataAssemble.append('file_id', fileId);\r\n            formDataAssemble.append('filename', file.name);\r\n\r\n            const data = await apiFetch<any>('/assemble-file', {\r\n                method: 'POST',\r\n                body: formDataAssemble\r\n            });\r\n            if (data.success) {\r\n                setFormData({ ...formData, backgroundVideo: file, backgroundVideoPath: data.path });\r\n                setStatusMessage('');\r\n            } else {\r\n                throw new Error(data.error || 'Error desconocido');\r\n            }\r\n        } catch (err) {\r\n            const errorMessage = err instanceof Error ? err.message : 'Error desconocido';\r\n            showToast('Error al subir el video: ' + errorMessage, 'error');\r\n            setStatusMessage('');\r\n        } finally {\r\n            setUploadingBg(false);\r\n            setUploadProgress(0);\r\n        }\r\n    };\r\n\r\n    const handleUploadMusic = async (file: File) => {\r\n        try {\r\n            setUploadingBg(true);\r\n            setStatusMessage('Subiendo m√∫sica...');\r\n            const fileId = Math.random().toString(36).substring(7);\r\n            const chunkSize = 1024 * 1024; // 1MB\r\n            const totalChunks = Math.ceil(file.size / chunkSize);\r\n\r\n            for (let i = 0; i < totalChunks; i++) {\r\n                const chunk = file.slice(i * chunkSize, (i + 1) * chunkSize);\r\n                const formDataChunk = new FormData();\r\n                formDataChunk.append('file', chunk);\r\n                formDataChunk.append('file_id', fileId);\r\n                formDataChunk.append('chunk_index', i.toString());\r\n                formDataChunk.append('total_chunks', totalChunks.toString());\r\n\r\n                const res = await fetch(getApiUrl('/upload-chunk'), {\r\n                    method: 'POST',\r\n                    headers: { 'bypass-tunnel-reminder': 'true', 'ngrok-skip-browser-warning': 'true' },\r\n                    body: formDataChunk\r\n                });\r\n                if (!res.ok) throw new Error(`Error en chunk ${i}`);\r\n                setUploadProgress(Math.round(((i + 1) / totalChunks) * 100));\r\n            }\r\n\r\n            const formDataAssemble = new FormData();\r\n            formDataAssemble.append('file_id', fileId);\r\n            formDataAssemble.append('filename', file.name);\r\n\r\n            const data = await apiFetch<any>('/assemble-file', {\r\n                method: 'POST',\r\n                body: formDataAssemble\r\n            });\r\n            if (data.success) {\r\n                setFormData({ ...formData, music: file, musicPath: data.filename });\r\n                showToast('M√∫sica subida correctamente', 'success');\r\n            }\r\n        } catch (err) {\r\n            const errorMessage = err instanceof Error ? err.message : 'Error desconocido';\r\n            showToast('Error al subir m√∫sica: ' + errorMessage, 'error');\r\n        } finally {\r\n            setUploadingBg(false);\r\n            setUploadProgress(0);\r\n            setStatusMessage('');\r\n        }\r\n    };\r\n\r\n    const handleNextStep = () => {\r\n        if (currentStep === 1 && !formData.backgroundVideoPath) return showToast(\"Sube un video de fondo.\", \"warning\");\r\n        if (currentStep === 2) {\r\n            if (!formData.url || !isValidYoutubeUrl(formData.url)) {\r\n                return showToast(\"Ingresa una URL de YouTube v√°lida.\", \"error\");\r\n            }\r\n            if (!formData.titulo) return showToast(\"Ingresa un t√≠tulo para el proyecto.\", \"warning\");\r\n        }\r\n        setCurrentStep(prev => Math.min(prev + 1, totalSteps));\r\n    };\r\n\r\n    const handlePrevStep = () => setCurrentStep(prev => Math.max(prev - 1, 1));\r\n\r\n    const handleCancel = async () => {\r\n        if (!currentTaskId) return;\r\n        if (!confirm('¬øCancelar el proceso?')) return;\r\n        try {\r\n            setStatusMessage('Cancelando...');\r\n            await apiFetch(`/cancel/${currentTaskId}`, { method: 'POST' });\r\n        } catch { alert(\"No se pudo cancelar.\"); }\r\n    };\r\n\r\n    const handleConfirmScript = async () => {\r\n        if (!currentTaskId) return;\r\n        setIsConfirmingScript(true);\r\n        setStatusMessage('Confirmando guion...');\r\n        try {\r\n            const data = await apiFetch<{ success: boolean; detail?: string }>(`/confirm-script/${currentTaskId}`, {\r\n                method: 'POST',\r\n                body: JSON.stringify({ script: editedScript })\r\n            });\r\n            if (data.success) {\r\n                setIsAwaitingScript(false);\r\n                setIsProcessing(true);\r\n                const currentCost = targetLength === 'short' ? 5 : targetLength === 'long' ? 20 : 10;\r\n                startStatusPolling(currentTaskId, currentCost);\r\n            } else {\r\n                alert('Error: ' + data.detail);\r\n            }\r\n        } catch { alert('Error de conexi√≥n.'); }\r\n        finally { setIsConfirmingScript(false); }\r\n    };\r\n\r\n    const startStatusPolling = (taskId: string, cost: number) => {\r\n        const interval = setInterval(async () => {\r\n            try {\r\n                const status = await apiFetch<{\r\n                    status: string;\r\n                    progress: number;\r\n                    message: string;\r\n                    script_content?: string;\r\n                    result?: { video_rel_path?: string; video_path: string; script_rel_path?: string };\r\n                }>(`/status/${taskId}`);\r\n                setProgress(status.progress);\r\n                setStatusMessage(status.message);\r\n\r\n                if (['completed', 'failed', 'cancelled', 'awaiting_review'].includes(status.status)) {\r\n                    clearInterval(interval);\r\n                    setIsProcessing(false);\r\n                    if (status.status === 'completed' && status.result) {\r\n                        if (!isAdmin) {\r\n                            deductCredits(cost);\r\n                        }\r\n                        refreshCredits();\r\n                        const vp = status.result.video_rel_path || status.result.video_path.split(/[\\\\/]/).pop();\r\n                        const sp = status.result.script_rel_path || (vp ? vp.replace('.mp4', '_GUION.txt') : '');\r\n                        setResultData({ video_path: getApiUrl(`/downloads/${encodeURI(vp || '')}`), script_path: getApiUrl(`/downloads/${encodeURI(sp)}`) });\r\n                        setCurrentTaskId(null);\r\n                    } else if (status.status === 'failed') {\r\n                        alert('‚ùå ' + status.message);\r\n                        setCurrentTaskId(null);\r\n                    } else if (status.status === 'cancelled') {\r\n                        setCurrentTaskId(null);\r\n                    } else if (status.status === 'awaiting_review') {\r\n                        setEditedScript(status.script_content || '');\r\n                        setIsAwaitingScript(true);\r\n                    }\r\n                }\r\n            } catch { clearInterval(interval); setIsProcessing(false); }\r\n        }, 2500);\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        const currentCost = targetLength === 'short' ? 5 : targetLength === 'long' ? 20 : 10;\r\n\r\n        if (!isAdmin && credits < currentCost) return showToast(`Cr√©ditos insuficientes (${currentCost} tokens requeridos).`, 'error');\r\n        if (!formData.backgroundVideoPath || !formData.url || !formData.titulo || !selectedVoice || !selectedPrompt)\r\n            return showToast('Completa todos los campos obligatorios.', 'warning');\r\n\r\n        setIsProcessing(true);\r\n        setProgress(0);\r\n        setStatusMessage('Iniciando...');\r\n        setResultData(null);\r\n\r\n        try {\r\n            const requestId = crypto.randomUUID();\r\n            const userEmail = user?.email || 'unknown';\r\n            const data = await apiFetch<{ success: boolean; task_id: string; detail?: string; message?: string }>('/process', {\r\n                method: 'POST',\r\n                body: JSON.stringify({\r\n                    url: formData.url, idioma: selectedIdioma, voz: selectedVoice,\r\n                    prompt_name: selectedPrompt, titulo: formData.titulo,\r\n                    miniatura: formData.miniatura || formData.titulo, add_subtitles: true,\r\n                    background_video: formData.backgroundVideoPath, request_id: requestId,\r\n                    user_id: userEmail, subtitle_style: selectedSubtitleStyle,\r\n                    subtitle_color: selectedSubtitleColor, subtitle_position: selectedSubtitlePosition,\r\n                    pause_at_script: true,\r\n                    target_length: targetLength,\r\n                    bg_music: formData.musicPath || null,\r\n                    bg_music_vol: formData.musicVolume\r\n                })\r\n            });\r\n            if (!data.success) { setIsProcessing(false); return showToast('Error: ' + (data.detail || data.message), 'error'); }\r\n            setCurrentTaskId(data.task_id);\r\n            startStatusPolling(data.task_id, currentCost);\r\n        } catch { setIsProcessing(false); showToast('Error de conexi√≥n con el servidor.', 'error'); }\r\n    };\r\n\r\n    const handleNewVideo = () => {\r\n        setResultData(null); setCurrentStep(1); setCurrentTaskId(null);\r\n        setFormData({\r\n            url: '', titulo: '', miniatura: '',\r\n            backgroundVideo: null, backgroundVideoPath: '',\r\n            music: null, musicPath: '', musicVolume: 0.15\r\n        });\r\n        setEditedScript(''); setIsAwaitingScript(false); setProgress(0); setStatusMessage('');\r\n    };\r\n\r\n    const wordCount = editedScript.trim().split(/\\s+/).filter(Boolean).length;\r\n\r\n    if (isLoadingAuth) return <div className=\"min-h-screen bg-black\" />;\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Pill button for option selectors ‚îÄ‚îÄ‚îÄ\r\n    const OptionPill = ({ selected, onClick, children }: { selected: boolean; onClick: () => void; children: React.ReactNode }) => (\r\n        <button\r\n            onClick={onClick}\r\n            className={`px-4 py-2.5 text-[10px] font-bold uppercase tracking-wider transition-all duration-200 rounded-xl text-left ${selected\r\n                ? 'bg-primary/15 text-primary border border-primary/30 shadow-[0_0_12px_rgba(220,38,38,0.1)]'\r\n                : 'bg-white/[0.03] text-zinc-500 border border-white/[0.06] hover:border-white/15 hover:bg-white/[0.05]'\r\n                }`}\r\n        >\r\n            {children}\r\n        </button>\r\n    );\r\n\r\n    const OptionPillAlt = ({ selected, onClick, children }: { selected: boolean; onClick: () => void; children: React.ReactNode }) => (\r\n        <button\r\n            onClick={onClick}\r\n            className={`px-4 py-2.5 text-[10px] font-bold uppercase tracking-wider transition-all duration-200 rounded-xl text-left ${selected\r\n                ? 'bg-white text-black border border-white shadow-[0_2px_10px_rgba(255,255,255,0.1)]'\r\n                : 'bg-white/[0.03] text-zinc-500 border border-white/[0.06] hover:border-white/15 hover:bg-white/[0.05]'\r\n                }`}\r\n        >\r\n            {children}\r\n        </button>\r\n    );\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-black text-white selection:bg-primary/30\">\r\n            {/* ‚îÄ‚îÄ‚îÄ Navbar ‚îÄ‚îÄ‚îÄ */}\r\n            <nav className=\"fixed top-0 inset-x-0 z-50 bg-black/70 backdrop-blur-2xl border-b border-white/[0.04]\">\r\n                <div className=\"max-w-2xl mx-auto px-6 h-16 flex items-center justify-between\">\r\n                    <Link href=\"/dashboard\" className=\"text-sm font-black tracking-tight uppercase hover:text-primary transition-colors\">\r\n                        VERSION<span className=\"text-primary\">.ED</span>\r\n                    </Link>\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"bg-white/[0.04] border border-white/[0.06] rounded-full px-4 py-1.5 flex items-center gap-2\">\r\n                            <span className=\"text-[10px] font-medium text-zinc-500\">Saldo</span>\r\n                            <span className=\"text-xs font-black text-primary\">{isAdmin ? '‚àû' : credits}</span>\r\n                        </div>\r\n                        <div className=\"w-2 h-2 bg-primary rounded-full animate-pulse shadow-[0_0_8px_var(--primary)]\" />\r\n                    </div>\r\n                </div>\r\n            </nav>\r\n\r\n            {/* ‚îÄ‚îÄ‚îÄ Main ‚îÄ‚îÄ‚îÄ */}\r\n            <main className=\"max-w-2xl mx-auto px-6 pt-28 pb-20\">\r\n\r\n                {/* ‚îÄ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ */}\r\n                <div className=\"text-center mb-10 animate-fade\">\r\n                    <h1 className=\"text-3xl font-black tracking-tight mb-2\">\r\n                        Crear <span className=\"text-gradient\">Video</span>\r\n                    </h1>\r\n                    <p className=\"text-zinc-600 text-xs font-medium\">Genera contenido con IA en minutos</p>\r\n                </div>\r\n\r\n                {/* ‚îÄ‚îÄ‚îÄ Steps ‚îÄ‚îÄ‚îÄ */}\r\n                <div className=\"flex items-center justify-center gap-1.5 mb-10\">\r\n                    {STEP_LABELS.map((label, i) => {\r\n                        const step = i + 1;\r\n                        const isActive = currentStep === step;\r\n                        const isDone = currentStep > step;\r\n                        return (\r\n                            <button\r\n                                key={step}\r\n                                onClick={() => isDone && setCurrentStep(step)}\r\n                                className={`\r\n                                    px-5 py-2 text-[10px] font-bold uppercase tracking-wider transition-all duration-300 rounded-full\r\n                                    ${isActive ? 'bg-primary text-white shadow-[0_0_20px_rgba(220,38,38,0.25)] scale-105' : ''}\r\n                                    ${isDone ? 'bg-white/[0.06] text-zinc-300 hover:bg-white/[0.1] cursor-pointer' : ''}\r\n                                    ${!isActive && !isDone ? 'text-zinc-700 cursor-default' : ''}\r\n                                `}\r\n                            >\r\n                                {isDone ? '‚úì' : `${step}.`} {label}\r\n                            </button>\r\n                        );\r\n                    })}\r\n                </div>\r\n\r\n                {/* ‚îÄ‚îÄ‚îÄ Result ‚îÄ‚îÄ‚îÄ */}\r\n                {resultData ? (\r\n                    <div className=\"animate-fade-scale text-center py-16\">\r\n                        <div className=\"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-green-500/20 to-emerald-500/5 border border-green-500/15 flex items-center justify-center text-4xl shadow-[0_0_40px_rgba(34,197,94,0.1)]\">\r\n                            ‚ú®\r\n                        </div>\r\n                        <h2 className=\"text-2xl font-black tracking-tight mb-2\">¬°Video Listo!</h2>\r\n                        <p className=\"text-zinc-500 text-xs font-medium mb-10\">Tu contenido ha sido generado exitosamente</p>\r\n\r\n                        <div className=\"flex flex-col gap-3 max-w-xs mx-auto\">\r\n                            <a href={resultData.video_path} className=\"btn-primary !py-4 text-center block\" target=\"_blank\" download>\r\n                                Descargar Video\r\n                            </a>\r\n                            <button onClick={() => router.push(`/editor/timeline?video=${encodeURIComponent(resultData.video_path)}&length=${targetLength}&style=${encodeURIComponent(selectedPrompt)}`)}\r\n                                className=\"btn-outline !py-3 text-center block !border-primary/20 hover:!border-primary/40 w-full\">\r\n                                ‚úÇÔ∏è Editar en Timeline\r\n                            </button>\r\n                            <a href={resultData.script_path} className=\"btn-outline !py-3 text-center block !border-white/10\" target=\"_blank\" download>\r\n                                Ver Guion\r\n                            </a>\r\n                            <button onClick={handleNewVideo} className=\"text-zinc-600 hover:text-white text-[10px] font-bold uppercase tracking-widest mt-6 transition-colors\">\r\n                                + Crear Nuevo Video\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    <>\r\n                        {/* ‚îÄ‚îÄ‚îÄ Step 1: Recursos ‚îÄ‚îÄ‚îÄ */}\r\n                        {currentStep === 1 && (\r\n                            <div className=\"animate-fade\">\r\n                                <div className=\"mb-6\">\r\n                                    <h2 className=\"text-lg font-black tracking-tight mb-1\">Video de Fondo</h2>\r\n                                    <p className=\"text-zinc-600 text-xs\">Sube el recurso visual base.</p>\r\n                                </div>\r\n\r\n                                {!formData.backgroundVideoPath ? (\r\n                                    <div className=\"relative group\">\r\n                                        <input\r\n                                            type=\"file\" accept=\"video/*\"\r\n                                            onChange={(e) => e.target.files?.[0] && handleUploadBackground(e.target.files[0])}\r\n                                            className=\"absolute inset-0 opacity-0 cursor-pointer z-10\"\r\n                                            disabled={uploadingBg}\r\n                                        />\r\n                                        <div className=\"border-2 border-dashed border-white/[0.06] group-hover:border-primary/30 transition-all rounded-3xl py-20 flex flex-col items-center justify-center gap-4 bg-white/[0.01] group-hover:bg-primary/[0.02]\">\r\n                                            {uploadingBg ? (\r\n                                                <>\r\n                                                    <div className=\"w-12 h-12 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\r\n                                                    <span className=\"text-xs font-bold text-zinc-400\">{statusMessage}</span>\r\n                                                    <div className=\"w-52 h-1.5 bg-white/[0.06] rounded-full overflow-hidden\">\r\n                                                        <div className=\"h-full bg-primary rounded-full transition-all duration-300 shadow-[0_0_8px_rgba(220,38,38,0.4)]\"\r\n                                                            style={{ width: `${uploadProgress}%` }} />\r\n                                                    </div>\r\n                                                </>\r\n                                            ) : (\r\n                                                <>\r\n                                                    <div className=\"w-14 h-14 rounded-2xl bg-white/[0.04] border border-white/[0.06] flex items-center justify-center text-2xl text-zinc-600 group-hover:text-primary group-hover:border-primary/20 transition-all\">\r\n                                                        ‚Üë\r\n                                                    </div>\r\n                                                    <span className=\"text-[11px] font-bold text-zinc-500 group-hover:text-zinc-300 transition-colors\">\r\n                                                        Arrastra o selecciona un archivo\r\n                                                    </span>\r\n                                                    <span className=\"text-[10px] text-zinc-700 bg-white/[0.03] px-3 py-1 rounded-full\">MP4, MOV, AVI ‚Ä¢ Hasta 500MB</span>\r\n                                                </>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"border border-white/[0.06] bg-white/[0.02] rounded-2xl p-5 flex items-center justify-between\">\r\n                                        <div className=\"flex items-center gap-4\">\r\n                                            <div className=\"w-12 h-12 bg-primary/10 border border-primary/15 rounded-xl flex items-center justify-center text-primary text-xl\">‚ñ∂</div>\r\n                                            <div>\r\n                                                <p className=\"text-sm font-bold truncate max-w-[240px]\">{formData.backgroundVideo?.name}</p>\r\n                                                <div className=\"flex items-center gap-1.5 mt-1\">\r\n                                                    <span className=\"w-1.5 h-1.5 bg-green-500 rounded-full\" />\r\n                                                    <span className=\"text-[9px] text-green-500/70 font-bold uppercase tracking-wider\">Listo</span>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <button\r\n                                            onClick={() => setFormData({ ...formData, backgroundVideoPath: '', backgroundVideo: null })}\r\n                                            className=\"w-8 h-8 rounded-full bg-white/[0.04] hover:bg-red-500/10 flex items-center justify-center text-zinc-600 hover:text-red-500 transition-all text-sm\"\r\n                                        >‚úï</button>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* ‚îÄ‚îÄ‚îÄ Step 2: Datos ‚îÄ‚îÄ‚îÄ */}\r\n                        {currentStep === 2 && (\r\n                            <div className=\"animate-fade space-y-5\">\r\n                                <div className=\"mb-2\">\r\n                                    <h2 className=\"text-lg font-black tracking-tight mb-1\">Datos del Video</h2>\r\n                                    <p className=\"text-zinc-600 text-xs\">Define la fuente y t√≠tulo.</p>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-1.5\">\r\n                                    <label className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 ml-1\">URL de YouTube</label>\r\n                                    <div className=\"relative group\">\r\n                                        <input type=\"url\" value={formData.url}\r\n                                            onChange={(e) => setFormData({ ...formData, url: e.target.value })}\r\n                                            placeholder=\"https://youtube.com/watch?v=...\"\r\n                                            className={`input-field pr-12 ${formData.url && !isValidYoutubeUrl(formData.url) ? 'border-red-500/50' : ''}`} />\r\n                                        {formData.url && isValidYoutubeUrl(formData.url) && (\r\n                                            <div className=\"absolute right-4 top-1/2 -translate-y-1/2 text-green-500 animate-fade\">‚úì</div>\r\n                                        )}\r\n                                    </div>\r\n                                    {formData.url && !isValidYoutubeUrl(formData.url) && (\r\n                                        <p className=\"text-[9px] text-red-500/70 font-bold uppercase tracking-wider ml-1 animate-fade\">URL No V√°lida</p>\r\n                                    )}\r\n                                </div>\r\n\r\n                                {formData.url && isValidYoutubeUrl(formData.url) && (\r\n                                    <div className=\"animate-fade-scale flex items-center gap-4 p-3 bg-white/[0.02] border border-white/[0.06] rounded-2xl overflow-hidden shadow-[0_4px_20px_rgba(0,0,0,0.2)]\">\r\n                                        <img\r\n                                            src={getYoutubeThumbnail(formData.url) || ''}\r\n                                            alt=\"Preview\"\r\n                                            className=\"w-24 aspect-video object-cover rounded-lg shadow-lg\"\r\n                                        />\r\n                                        <div className=\"flex-1 min-w-0\">\r\n                                            <p className=\"text-[10px] font-bold text-primary uppercase tracking-widest mb-0.5\">Detectado</p>\r\n                                            <p className=\"text-[11px] text-zinc-400 truncate font-medium\">{formData.url}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                <div className=\"space-y-1.5\">\r\n                                    <label className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 ml-1\">T√≠tulo del Proyecto</label>\r\n                                    <input type=\"text\" value={formData.titulo}\r\n                                        onChange={(e) => setFormData({ ...formData, titulo: e.target.value })}\r\n                                        placeholder=\"Ej: Curiosidades sobre el Espacio\"\r\n                                        className=\"input-field\" />\r\n                                </div>\r\n\r\n                                <div className=\"space-y-1.5\">\r\n                                    <label className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 ml-1\">\r\n                                        Texto de Gancho <span className=\"text-zinc-700\">(Opcional)</span>\r\n                                    </label>\r\n                                    <input type=\"text\" value={formData.miniatura}\r\n                                        onChange={(e) => setFormData({ ...formData, miniatura: e.target.value })}\r\n                                        placeholder=\"Texto breve para la miniatura\"\r\n                                        className=\"input-field\" />\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* ‚îÄ‚îÄ‚îÄ Step 3: Estilo ‚îÄ‚îÄ‚îÄ */}\r\n                        {currentStep === 3 && (\r\n                            <div className=\"animate-fade\">\r\n                                <div className=\"mb-6\">\r\n                                    <h2 className=\"text-lg font-black tracking-tight mb-1\">Personalizaci√≥n</h2>\r\n                                    <p className=\"text-zinc-600 text-xs\">Voz, idioma y estilo visual.</p>\r\n                                </div>\r\n\r\n                                {isLoadingConfig ? (\r\n                                    <div className=\"py-20 flex justify-center\">\r\n                                        <div className=\"w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\r\n                                    </div>\r\n                                ) : configError ? (\r\n                                    <div className=\"p-5 bg-red-500/5 border border-red-500/15 rounded-2xl text-red-400 text-xs font-bold text-center\">{configError}</div>\r\n                                ) : (\r\n                                    <div className=\"space-y-8\">\r\n                                        {/* Idioma & Voz */}\r\n                                        <div className=\"grid grid-cols-2 gap-5\">\r\n                                            <div className=\"space-y-2.5\">\r\n                                                <label className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 ml-1\">Idioma</label>\r\n                                                <div className=\"flex flex-col gap-1.5 max-h-36 overflow-y-auto custom-scrollbar pr-1\">\r\n                                                    {metadata?.idiomas.map(lang => (\r\n                                                        <OptionPill key={lang} selected={selectedIdioma === lang} onClick={() => handleIdiomaChange(lang)}>\r\n                                                            {lang}\r\n                                                        </OptionPill>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"space-y-2.5\">\r\n                                                <label className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 ml-1\">Voz IA</label>\r\n                                                <div className=\"flex flex-col gap-1.5 max-h-36 overflow-y-auto custom-scrollbar pr-1\">\r\n                                                    {metadata?.voices[selectedIdioma]?.map(v => (\r\n                                                        <OptionPillAlt key={v.id} selected={selectedVoice === v.id} onClick={() => setSelectedVoice(v.id)}>\r\n                                                            {v.name}\r\n                                                        </OptionPillAlt>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Subt√≠tulos */}\r\n                                        <div className=\"border-t border-white/[0.04] pt-6 space-y-5\">\r\n                                            <div className=\"grid grid-cols-2 gap-5\">\r\n                                                <div className=\"space-y-2.5\">\r\n                                                    <label className=\"text-[10px] font-bold uppercase tracking-widest text-primary/70 ml-1\">Estilo Subt√≠tulos</label>\r\n                                                    <div className=\"flex flex-col gap-1.5 max-h-36 overflow-y-auto custom-scrollbar pr-1\">\r\n                                                        {(metadata?.subtitle_styles || DEFAULT_SUBTITLE_STYLES).map(style => (\r\n                                                            <OptionPill key={style} selected={selectedSubtitleStyle === style} onClick={() => setSelectedSubtitleStyle(style)}>\r\n                                                                {style}\r\n                                                            </OptionPill>\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"space-y-2.5\">\r\n                                                    <label className=\"text-[10px] font-bold uppercase tracking-widest text-primary/70 ml-1\">Color</label>\r\n                                                    <div className=\"flex flex-col gap-1.5 max-h-36 overflow-y-auto custom-scrollbar pr-1\">\r\n                                                        {(metadata?.subtitle_colors || DEFAULT_SUBTITLE_COLORS).map(color => (\r\n                                                            <OptionPillAlt key={color} selected={selectedSubtitleColor === color} onClick={() => setSelectedSubtitleColor(color)}>\r\n                                                                {color}\r\n                                                            </OptionPillAlt>\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"space-y-2.5\">\r\n                                                <label className=\"text-[10px] font-bold uppercase tracking-widest text-primary/70 ml-1\">Posici√≥n</label>\r\n                                                <div className=\"grid grid-cols-3 gap-2\">\r\n                                                    {(metadata?.subtitle_positions || DEFAULT_SUBTITLE_POSITIONS).map(pos => (\r\n                                                        <button key={pos} onClick={() => setSelectedSubtitlePosition(pos)}\r\n                                                            className={`py-3 text-[10px] font-bold uppercase tracking-wider transition-all rounded-xl text-center border ${selectedSubtitlePosition === pos\r\n                                                                ? 'bg-primary text-white border-primary rounded-xl shadow-[0_0_12px_rgba(220,38,38,0.15)]'\r\n                                                                : 'bg-white/[0.03] text-zinc-600 border-white/[0.06] hover:border-white/15'\r\n                                                                }`}>\r\n                                                            {pos === \"Arriba\" ? \"‚Üë Arriba\" : pos === \"Centro\" ? \"‚Äî Centro\" : \"‚Üì Abajo\"}\r\n                                                        </button>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Longitud del Guion */}\r\n                                        <div className=\"border-t border-white/[0.04] pt-6 space-y-3\">\r\n                                            <label className=\"text-[10px] font-bold uppercase tracking-widest text-primary/70 ml-1\">Longitud del Guion</label>\r\n                                            <div className=\"grid grid-cols-3 gap-2\">\r\n                                                {[\r\n                                                    { id: 'short', label: 'Corto', detail: '~5 min ‚Ä¢ 5 Tokens' },\r\n                                                    { id: 'medium', label: 'Medio', detail: '~15 min ‚Ä¢ 10 Tokens' },\r\n                                                    { id: 'long', label: 'Largo', detail: '30+ min ‚Ä¢ 20 Tokens' }\r\n                                                ].map(opt => (\r\n                                                    <button\r\n                                                        key={opt.id}\r\n                                                        onClick={() => setTargetLength(opt.id as any)}\r\n                                                        className={`p-3 flex flex-col items-center justify-center gap-1 transition-all rounded-xl border ${targetLength === opt.id\r\n                                                            ? 'bg-primary/10 border-primary text-primary shadow-[0_4_12px_rgba(220,38,38,0.1)]'\r\n                                                            : 'bg-white/[0.03] text-zinc-500 border-white/[0.06] hover:border-white/20'\r\n                                                            }`}\r\n                                                    >\r\n                                                        <span className=\"text-[10px] font-black uppercase tracking-tight\">{opt.label}</span>\r\n                                                        <span className=\"text-[8px] font-medium opacity-60 tracking-wider whitespace-nowrap\">{opt.detail}</span>\r\n                                                    </button>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Estrategia */}\r\n                                        <div className=\"border-t border-white/[0.04] pt-6 space-y-2.5\">\r\n                                            <label className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 ml-1\">Estrategia de Guion</label>\r\n                                            <div className=\"flex flex-col gap-1.5 max-h-48 overflow-y-auto custom-scrollbar pr-1\">\r\n                                                {metadata?.prompts[selectedIdioma]?.map(p => (\r\n                                                    <button key={p.name} onClick={() => setSelectedPrompt(p.name)}\r\n                                                        className={`px-4 py-3 text-left transition-all rounded-xl border ${selectedPrompt === p.name\r\n                                                            ? 'bg-primary/10 border-primary/25'\r\n                                                            : 'bg-white/[0.02] border-white/[0.06] hover:border-white/15'\r\n                                                            }`}>\r\n                                                        <div className={`text-[10px] font-bold uppercase tracking-wider ${selectedPrompt === p.name ? 'text-primary' : 'text-white'}`}>{p.name}</div>\r\n                                                        <div className=\"text-[9px] text-zinc-600 line-clamp-1 mt-0.5\">{p.prompt}</div>\r\n                                                    </button>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* ‚îÄ‚îÄ‚îÄ Nav Buttons ‚îÄ‚îÄ‚îÄ */}\r\n                        <div className=\"flex items-center justify-between mt-10 pt-6 border-t border-white/[0.04]\">\r\n                            <button onClick={handlePrevStep}\r\n                                className={`text-[10px] font-bold uppercase tracking-widest text-zinc-600 hover:text-white transition-colors rounded-full px-4 py-2 hover:bg-white/[0.05] ${currentStep === 1 ? 'invisible' : ''}`}>\r\n                                ‚Üê Atr√°s\r\n                            </button>\r\n\r\n                            {currentStep < totalSteps ? (\r\n                                <button onClick={handleNextStep} className=\"btn-primary !py-3 !px-8\">\r\n                                    Siguiente ‚Üí\r\n                                </button>\r\n                            ) : (\r\n                                <button onClick={handleSubmit} disabled={isProcessing}\r\n                                    className={`btn-primary !py-3.5 !px-10 ${isProcessing ? 'opacity-50 cursor-not-allowed' : ''}`}>\r\n                                    {isProcessing ? 'Procesando...' : '‚ö° Generar Video'}\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* ‚îÄ‚îÄ‚îÄ Processing ‚îÄ‚îÄ‚îÄ */}\r\n                        {isProcessing && (\r\n                            <div className=\"mt-8 bg-white/[0.02] border border-white/[0.06] rounded-2xl p-6 animate-fade\">\r\n                                <div className=\"flex items-center justify-between mb-3\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <div className={`w-2 h-2 rounded-full animate-pulse ${statusMessage.toLowerCase().includes('cola') ? 'bg-amber-500' : 'bg-primary'}`} />\r\n                                        <span className={`text-[10px] font-bold uppercase tracking-widest ${statusMessage.toLowerCase().includes('cola') ? 'text-amber-500' : 'text-primary'}`}>\r\n                                            {statusMessage.toLowerCase().includes('cola') ? 'En Cola de Espera' : 'Procesando'}\r\n                                        </span>\r\n                                    </div>\r\n                                    <span className=\"text-xs font-mono text-zinc-500\">\r\n                                        {statusMessage.toLowerCase().includes('cola') ? '#' : ''}{progress}%\r\n                                    </span>\r\n                                </div>\r\n                                <div className=\"h-1.5 w-full bg-white/[0.04] rounded-full overflow-hidden mb-3 text-gradient-primary\">\r\n                                    <div className={`h-full rounded-full shadow-[0_0_10px_rgba(220,38,38,0.4)] transition-all duration-500 ${statusMessage.toLowerCase().includes('cola') ? 'bg-amber-500 shadow-[0_0_10px_rgba(245,158,11,0.4)]' : 'bg-primary'}`}\r\n                                        style={{ width: `${progress}%` }} />\r\n                                </div>\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <p className=\"text-[10px] text-zinc-500 font-mono italic truncate max-w-[70%]\">{statusMessage}</p>\r\n                                    <button onClick={handleCancel}\r\n                                        className=\"text-[9px] text-zinc-700 hover:text-white font-bold uppercase tracking-widest transition-colors rounded-full px-3 py-1 bg-white/[0.03] hover:bg-red-500/10\">\r\n                                        Cancelar\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* ‚îÄ‚îÄ‚îÄ Config Tags ‚îÄ‚îÄ‚îÄ */}\r\n                        {!isProcessing && (\r\n                            <div className=\"mt-6 flex items-center justify-center gap-1.5 flex-wrap\">\r\n                                {formData.backgroundVideoPath && (\r\n                                    <span className=\"text-[9px] font-bold text-zinc-600 bg-white/[0.03] px-3 py-1.5 rounded-full border border-white/[0.05]\">‚ñ∂ Video</span>\r\n                                )}\r\n                                {formData.titulo && (\r\n                                    <span className=\"text-[9px] font-bold text-zinc-600 bg-white/[0.03] px-3 py-1.5 rounded-full border border-white/[0.05] truncate max-w-[120px]\">{formData.titulo}</span>\r\n                                )}\r\n                                <span className=\"text-[9px] font-bold text-zinc-600 bg-white/[0.03] px-3 py-1.5 rounded-full border border-white/[0.05]\">{selectedIdioma}</span>\r\n                                <span className=\"text-[9px] font-bold text-zinc-600 bg-white/[0.03] px-3 py-1.5 rounded-full border border-white/[0.05]\">{selectedSubtitleStyle}</span>\r\n                            </div>\r\n                        )}\r\n                    </>\r\n                )}\r\n            </main>\r\n\r\n            {/* ‚îÄ‚îÄ‚îÄ Script Modal ‚îÄ‚îÄ‚îÄ */}\r\n            {isAwaitingScript && (\r\n                <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-6 bg-black/90 backdrop-blur-2xl\">\r\n                    <div className=\"w-full max-w-2xl max-h-[85vh] flex flex-col bg-zinc-950 border border-white/[0.06] rounded-3xl p-8 shadow-[0_0_80px_rgba(0,0,0,0.6)] animate-fade-scale\">\r\n                        {/* Header */}\r\n                        <div className=\"flex items-center justify-between mb-6 pb-5 border-b border-white/[0.04]\">\r\n                            <div>\r\n                                <h2 className=\"text-xl font-black tracking-tight\">\r\n                                    Revisar <span className=\"text-gradient\">Guion</span>\r\n                                </h2>\r\n                                <p className=\"text-[10px] text-zinc-600 mt-1\">Edita el texto antes de generar el audio</p>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <span className=\"text-[10px] font-mono text-zinc-500 bg-white/[0.03] px-3 py-1 rounded-full\">{wordCount} palabras</span>\r\n                                <span className=\"text-[9px] font-bold text-primary uppercase tracking-wider bg-primary/5 px-3 py-1.5 rounded-full border border-primary/10\">Fase 2/3</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Editor */}\r\n                        <div className=\"flex-1 mb-6\">\r\n                            <textarea\r\n                                value={editedScript}\r\n                                onChange={(e) => setEditedScript(e.target.value)}\r\n                                className=\"w-full h-[340px] bg-white/[0.02] border border-white/[0.05] rounded-2xl p-5 text-sm text-zinc-300 focus:border-primary/25 focus:outline-none transition-all font-medium leading-relaxed resize-none custom-scrollbar focus:shadow-[0_0_0_3px_rgba(220,38,38,0.05)]\"\r\n                                placeholder=\"Escribe o edita tu guion aqu√≠...\"\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Actions */}\r\n                        <div className=\"flex items-center justify-between pt-4 border-t border-white/[0.04]\">\r\n                            <button onClick={() => { setIsAwaitingScript(false); handleCancel(); }}\r\n                                className=\"text-[10px] font-bold text-zinc-600 hover:text-red-500 uppercase tracking-widest transition-colors rounded-full px-4 py-2 hover:bg-red-500/5\">\r\n                                Cancelar\r\n                            </button>\r\n                            <button onClick={handleConfirmScript} disabled={isConfirmingScript}\r\n                                className={`btn-primary !py-3 !px-8 ${isConfirmingScript ? 'opacity-50 cursor-not-allowed' : ''}`}>\r\n                                {isConfirmingScript ? 'Procesando...' : '‚ö° Confirmar y Generar'}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n            {/* ‚îÄ‚îÄ‚îÄ Toast Notifications ‚îÄ‚îÄ‚îÄ */}\r\n            {toast && (\r\n                <Toast\r\n                    message={toast.message}\r\n                    type={toast.type}\r\n                    onClose={() => setToast(null)}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\editor\\timeline\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'trimHandle' is assigned a value but never used.","line":91,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'trimClipId' is assigned a value but never used.","line":92,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":92,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'handleDeleteClip', 'handleSplit', and 'seekTo'. Either include them or remove the dependency array.","line":250,"column":8,"nodeType":"ArrayExpression","endLine":250,"endColumn":61,"suggestions":[{"desc":"Update the dependencies array to be: [currentTime, selectedClipId, duration, clips.length, handleSplit, handleDeleteClip, seekTo]","fix":{"range":[11791,11844],"text":"[currentTime, selectedClipId, duration, clips.length, handleSplit, handleDeleteClip, seekTo]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":460,"column":45,"nodeType":"JSXOpeningElement","endLine":460,"endColumn":166},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":580,"column":65,"nodeType":"JSXOpeningElement","endLine":581,"endColumn":126}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useRef, useCallback, Suspense } from 'react';\r\nimport Link from 'next/link';\r\nimport { useSearchParams } from 'next/navigation';\r\nimport '../../globals.css';\r\nimport { aiVersionClient, MediaFile } from '@/services/aiVersionClient';\r\nimport { apiFetch, getApiUrl } from '@/lib/api';\r\n\r\n// ‚îÄ‚îÄ‚îÄ Types ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\ninterface Clip {\r\n    id: string;\r\n    startTime: number;\r\n    endTime: number;\r\n    duration: number;\r\n    label: string;\r\n    color: string;\r\n}\r\n\r\ninterface OverlayItem {\r\n    id: string;\r\n    mediaId: string;\r\n    mediaUrl: string;\r\n    mediaName: string;\r\n    mediaType: 'image' | 'video';\r\n    startTime: number;\r\n    endTime: number;\r\n    x: number;       // % 0-100\r\n    y: number;       // % 0-100\r\n    width: number;   // % 5-100\r\n    opacity: number; // 0-1\r\n}\r\n\r\ntype ActivePanel = 'clips' | 'media' | 'properties';\r\n\r\n// ‚îÄ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\nconst formatTime = (s: number) => {\r\n    const h = Math.floor(s / 3600);\r\n    const m = Math.floor((s % 3600) / 60);\r\n    const sec = Math.floor(s % 60);\r\n    const ms = Math.floor((s % 1) * 100);\r\n    if (h > 0) return `${h}:${m.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;\r\n    return `${m}:${sec.toString().padStart(2, '0')}.${ms.toString().padStart(2, '0')}`;\r\n};\r\nconst generateId = () => Math.random().toString(36).substring(2, 9);\r\n\r\nconst CLIP_COLORS = [\r\n    'from-red-500/40 to-red-600/20',\r\n    'from-blue-500/40 to-blue-600/20',\r\n    'from-emerald-500/40 to-emerald-600/20',\r\n    'from-purple-500/40 to-purple-600/20',\r\n    'from-amber-500/40 to-amber-600/20',\r\n    'from-cyan-500/40 to-cyan-600/20',\r\n];\r\nconst CLIP_BORDERS = [\r\n    'border-red-500/50', 'border-blue-500/50', 'border-emerald-500/50',\r\n    'border-purple-500/50', 'border-amber-500/50', 'border-cyan-500/50',\r\n];\r\nconst OVERLAY_TRACK_COLORS = ['bg-violet-500/30 border-violet-500/50', 'bg-sky-500/30 border-sky-500/50', 'bg-rose-500/30 border-rose-500/50'];\r\n\r\n// ‚îÄ‚îÄ‚îÄ Component ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\nfunction TimelineEditorContent() {\r\n    const searchParams = useSearchParams();\r\n    const videoUrl = searchParams.get('video') || '';\r\n    const targetLength = searchParams.get('length') || 'medium';\r\n    const scriptStyle = searchParams.get('style') || 'Est√°ndar';\r\n\r\n    // Refs\r\n    const videoRef = useRef<HTMLVideoElement>(null);\r\n    const timelineRef = useRef<HTMLDivElement>(null);\r\n    const previewRef = useRef<HTMLDivElement>(null);\r\n    const animFrameRef = useRef<number>(0);\r\n    const mediaInputRef = useRef<HTMLInputElement>(null);\r\n\r\n    // Video State\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [currentTime, setCurrentTime] = useState(0);\r\n    const [duration, setDuration] = useState(0);\r\n    const [volume, setVolume] = useState(1);\r\n    const [isMuted, setIsMuted] = useState(false);\r\n    const [playbackRate, setPlaybackRate] = useState(1);\r\n    const [isVideoLoaded, setIsVideoLoaded] = useState(false);\r\n    const [videoError, setVideoError] = useState('');\r\n\r\n    // Timeline/Clip State\r\n    const [clips, setClips] = useState<Clip[]>([]);\r\n    const [selectedClipId, setSelectedClipId] = useState<string | null>(null);\r\n    const [zoom, setZoom] = useState(1);\r\n    const [isDraggingPlayhead, setIsDraggingPlayhead] = useState(false);\r\n    const [isTrimming, setIsTrimming] = useState(false);\r\n    const [trimHandle, setTrimHandle] = useState<'start' | 'end' | null>(null);\r\n    const [trimClipId, setTrimClipId] = useState<string | null>(null);\r\n\r\n    // Overlay State\r\n    const [overlays, setOverlays] = useState<OverlayItem[]>([]);\r\n    const [selectedOverlayId, setSelectedOverlayId] = useState<string | null>(null);\r\n    const [isDraggingOverlay, setIsDraggingOverlay] = useState(false);\r\n    const [overlayDragStart, setOverlayDragStart] = useState<{ ox: number; oy: number; mx: number; my: number } | null>(null);\r\n\r\n    // Media Pool State\r\n    const [mediaFiles, setMediaFiles] = useState<MediaFile[]>([]);\r\n    const [isLoadingMedia, setIsLoadingMedia] = useState(false);\r\n    const [isUploadingMedia, setIsUploadingMedia] = useState(false);\r\n\r\n    // UI State\r\n    const [activePanel, setActivePanel] = useState<ActivePanel>('clips');\r\n    const [isExporting, setIsExporting] = useState(false);\r\n    const [exportProgress, setExportProgress] = useState(0);\r\n    const [exportMessage, setExportMessage] = useState('');\r\n    const [exportResult, setExportResult] = useState<string | null>(null);\r\n    const [toast, setToast] = useState<{ msg: string; type: 'info' | 'success' | 'error' } | null>(null);\r\n\r\n    const showToast = (msg: string, type: 'info' | 'success' | 'error' = 'info') => {\r\n        setToast({ msg, type });\r\n        setTimeout(() => setToast(null), 3000);\r\n    };\r\n\r\n    // ‚îÄ‚îÄ‚îÄ API ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Video Init ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    useEffect(() => {\r\n        if (!videoUrl) { setVideoError('No se proporcion√≥ URL de video.'); return; }\r\n        const video = videoRef.current;\r\n        if (!video) return;\r\n\r\n        let url = videoUrl;\r\n        if (window.location.hostname === 'localhost' && url.includes('.loca.lt')) {\r\n            url = `http://localhost:8000${url.split('.loca.lt')[1]}`;\r\n        }\r\n        video.src = url;\r\n        video.load();\r\n\r\n        const onMeta = () => {\r\n            if (isNaN(video.duration) || video.duration === Infinity) { setVideoError('Duraci√≥n inv√°lida.'); return; }\r\n            setDuration(video.duration);\r\n            setIsVideoLoaded(true);\r\n            setClips([{ id: generateId(), startTime: 0, endTime: video.duration, duration: video.duration, label: 'Clip 1', color: CLIP_COLORS[0] }]);\r\n        };\r\n        const onErr = () => setVideoError('Error al cargar el video. Verifica la URL.');\r\n        video.addEventListener('loadedmetadata', onMeta);\r\n        video.addEventListener('error', onErr);\r\n        return () => { video.removeEventListener('loadedmetadata', onMeta); video.removeEventListener('error', onErr); };\r\n    }, [videoUrl]);\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Playhead sync ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    const syncPlayhead = useCallback(() => {\r\n        if (videoRef.current && !isDraggingPlayhead) setCurrentTime(videoRef.current.currentTime);\r\n        animFrameRef.current = requestAnimationFrame(syncPlayhead);\r\n    }, [isDraggingPlayhead]);\r\n    useEffect(() => {\r\n        animFrameRef.current = requestAnimationFrame(syncPlayhead);\r\n        return () => cancelAnimationFrame(animFrameRef.current);\r\n    }, [syncPlayhead]);\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Playback ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    const seekTo = (t: number) => {\r\n        const v = videoRef.current;\r\n        if (!v) return;\r\n        v.currentTime = Math.max(0, Math.min(t, duration));\r\n        setCurrentTime(v.currentTime);\r\n    };\r\n    const togglePlay = () => {\r\n        const v = videoRef.current;\r\n        if (!v) return;\r\n        if (v.paused) { v.play(); setIsPlaying(true); }\r\n        else { v.pause(); setIsPlaying(false); }\r\n    };\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Timeline Click ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    const handleTimelineClick = (e: React.MouseEvent<HTMLDivElement>) => {\r\n        if (isTrimming) return;\r\n        const rect = e.currentTarget.getBoundingClientRect();\r\n        seekTo(((e.clientX - rect.left) / rect.width) * duration);\r\n    };\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Playhead Drag ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    const handlePlayheadMouseDown = (e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        setIsDraggingPlayhead(true);\r\n        const move = (ev: MouseEvent) => {\r\n            const tl = timelineRef.current;\r\n            if (!tl) return;\r\n            const r = tl.getBoundingClientRect();\r\n            seekTo(((Math.max(0, Math.min(ev.clientX - r.left, r.width))) / r.width) * duration);\r\n        };\r\n        const up = () => { setIsDraggingPlayhead(false); document.removeEventListener('mousemove', move); document.removeEventListener('mouseup', up); };\r\n        document.addEventListener('mousemove', move);\r\n        document.addEventListener('mouseup', up);\r\n    };\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Trim ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    const handleTrimStart = (e: React.MouseEvent, clipId: string, handle: 'start' | 'end') => {\r\n        e.stopPropagation();\r\n        setIsTrimming(true); setTrimHandle(handle); setTrimClipId(clipId);\r\n        const move = (ev: MouseEvent) => {\r\n            const tl = timelineRef.current;\r\n            if (!tl) return;\r\n            const r = tl.getBoundingClientRect();\r\n            const t = ((Math.max(0, Math.min(ev.clientX - r.left, r.width))) / r.width) * duration;\r\n            setClips(prev => prev.map(c => {\r\n                if (c.id !== clipId) return c;\r\n                if (handle === 'start') { const s = Math.max(0, Math.min(t, c.endTime - 0.5)); return { ...c, startTime: s, duration: c.endTime - s }; }\r\n                else { const end = Math.max(c.startTime + 0.5, Math.min(t, duration)); return { ...c, endTime: end, duration: end - c.startTime }; }\r\n            }));\r\n        };\r\n        const up = () => { setIsTrimming(false); setTrimHandle(null); setTrimClipId(null); document.removeEventListener('mousemove', move); document.removeEventListener('mouseup', up); };\r\n        document.addEventListener('mousemove', move);\r\n        document.addEventListener('mouseup', up);\r\n    };\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Split ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    const handleSplit = () => {\r\n        const target = clips.find(c => currentTime >= c.startTime && currentTime <= c.endTime);\r\n        if (!target) { showToast('Playhead no est√° dentro de un clip.', 'error'); return; }\r\n        if (currentTime - target.startTime < 0.5 || target.endTime - currentTime < 0.5) { showToast('Punto de corte muy cerca del borde.', 'error'); return; }\r\n        const idx = clips.length % CLIP_COLORS.length;\r\n        setClips(prev => {\r\n            const i = prev.findIndex(c => c.id === target.id);\r\n            const list = [...prev];\r\n            list.splice(i, 1, { ...target, endTime: currentTime, duration: currentTime - target.startTime },\r\n                { id: generateId(), startTime: currentTime, endTime: target.endTime, duration: target.endTime - currentTime, label: `Clip ${prev.length + 1}`, color: CLIP_COLORS[idx] });\r\n            return list;\r\n        });\r\n        showToast('Clip dividido', 'success');\r\n    };\r\n\r\n    const handleDeleteClip = (id: string) => {\r\n        if (clips.length <= 1) { showToast('Debe quedar al menos un clip.', 'error'); return; }\r\n        setClips(p => p.filter(c => c.id !== id));\r\n        if (selectedClipId === id) setSelectedClipId(null);\r\n        showToast('Clip eliminado', 'info');\r\n    };\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Keyboard shortcuts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    useEffect(() => {\r\n        const onKey = (e: KeyboardEvent) => {\r\n            if (e.target instanceof HTMLInputElement || e.target instanceof HTMLTextAreaElement) return;\r\n            switch (e.key) {\r\n                case ' ': e.preventDefault(); togglePlay(); break;\r\n                case 's': case 'S': if (!e.ctrlKey) handleSplit(); break;\r\n                case 'Delete': case 'Backspace': if (selectedClipId) handleDeleteClip(selectedClipId); break;\r\n                case 'ArrowLeft': seekTo(currentTime - (e.shiftKey ? 5 : 1)); break;\r\n                case 'ArrowRight': seekTo(currentTime + (e.shiftKey ? 5 : 1)); break;\r\n                case '+': case '=': setZoom(z => Math.min(z + 0.5, 5)); break;\r\n                case '-': setZoom(z => Math.max(z - 0.5, 0.5)); break;\r\n            }\r\n        };\r\n        window.addEventListener('keydown', onKey);\r\n        return () => window.removeEventListener('keydown', onKey);\r\n    }, [currentTime, selectedClipId, duration, clips.length]);\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Media Pool ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    const loadMedia = useCallback(async () => {\r\n        setIsLoadingMedia(true);\r\n        try {\r\n            const res = await aiVersionClient.listMedia();\r\n            if (res.success && res.files) setMediaFiles(res.files as MediaFile[]);\r\n        } finally { setIsLoadingMedia(false); }\r\n    }, []);\r\n    useEffect(() => { loadMedia(); }, [loadMedia]);\r\n\r\n    const handleUploadMedia = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n        setIsUploadingMedia(true);\r\n        try {\r\n            const res = await aiVersionClient.uploadMedia(file);\r\n            if (res.success) { showToast('Archivo subido', 'success'); await loadMedia(); }\r\n            else showToast(res.error || 'Error al subir', 'error');\r\n        } finally { setIsUploadingMedia(false); if (mediaInputRef.current) mediaInputRef.current.value = ''; }\r\n    };\r\n\r\n    const handleDeleteMedia = async (id: string) => {\r\n        const res = await aiVersionClient.deleteMedia(id);\r\n        if (res.success) { setMediaFiles(p => p.filter(f => f.id !== id)); showToast('Eliminado', 'info'); }\r\n    };\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Overlays ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    const addOverlay = (media: MediaFile) => {\r\n        if (!isVideoLoaded) { showToast('Carga un video primero', 'error'); return; }\r\n        const base = process.env.NEXT_PUBLIC_API_URL || 'http://127.0.0.1:8000';\r\n        const o: OverlayItem = {\r\n            id: generateId(), mediaId: media.id,\r\n            mediaUrl: `${base}${media.url}`, mediaName: media.name,\r\n            mediaType: media.type as 'image' | 'video',\r\n            startTime: currentTime, endTime: Math.min(currentTime + 5, duration),\r\n            x: 5, y: 5, width: 25, opacity: 1,\r\n        };\r\n        setOverlays(p => [...p, o]);\r\n        setSelectedOverlayId(o.id);\r\n        setActivePanel('properties');\r\n        showToast(`Overlay \"${media.name}\" a√±adido`, 'success');\r\n    };\r\n\r\n    const updateOverlay = (id: string, changes: Partial<OverlayItem>) =>\r\n        setOverlays(p => p.map(o => o.id === id ? { ...o, ...changes } : o));\r\n\r\n    const deleteOverlay = (id: string) => {\r\n        setOverlays(p => p.filter(o => o.id !== id));\r\n        if (selectedOverlayId === id) setSelectedOverlayId(null);\r\n        showToast('Overlay eliminado', 'info');\r\n    };\r\n\r\n    // Overlay drag inside preview\r\n    const startOverlayDrag = (e: React.MouseEvent, id: string) => {\r\n        e.stopPropagation();\r\n        setSelectedOverlayId(id);\r\n        const o = overlays.find(x => x.id === id);\r\n        if (!o || !previewRef.current) return;\r\n        setIsDraggingOverlay(true);\r\n        setOverlayDragStart({ ox: o.x, oy: o.y, mx: e.clientX, my: e.clientY });\r\n    };\r\n    useEffect(() => {\r\n        if (!isDraggingOverlay || !overlayDragStart || !selectedOverlayId || !previewRef.current) return;\r\n        const rect = previewRef.current.getBoundingClientRect();\r\n        const onMove = (e: MouseEvent) => {\r\n            const dx = ((e.clientX - overlayDragStart.mx) / rect.width) * 100;\r\n            const dy = ((e.clientY - overlayDragStart.my) / rect.height) * 100;\r\n            updateOverlay(selectedOverlayId, {\r\n                x: Math.max(0, Math.min(70, overlayDragStart.ox + dx)),\r\n                y: Math.max(0, Math.min(80, overlayDragStart.oy + dy)),\r\n            });\r\n        };\r\n        const onUp = () => setIsDraggingOverlay(false);\r\n        window.addEventListener('mousemove', onMove);\r\n        window.addEventListener('mouseup', onUp);\r\n        return () => { window.removeEventListener('mousemove', onMove); window.removeEventListener('mouseup', onUp); };\r\n    }, [isDraggingOverlay, overlayDragStart, selectedOverlayId]);\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Export ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    const handleExport = async () => {\r\n        if (!clips.length) return;\r\n        setIsExporting(true); setExportProgress(0); setExportMessage('Preparando...');\r\n        try {\r\n            if (clips.length === 1 && clips[0].startTime === 0 && Math.abs(clips[0].endTime - duration) < 0.1 && !overlays.length) {\r\n                setExportResult(decodeURIComponent(videoUrl));\r\n                setExportMessage('¬°Listo! Sin cambios.');\r\n                setExportProgress(100); setIsExporting(false); return;\r\n            }\r\n            setExportMessage('Recortando clips...');\r\n            const trimmedPaths: string[] = [];\r\n            for (let i = 0; i < clips.length; i++) {\r\n                const clip = clips[i];\r\n                setExportProgress(10 + Math.round((i / clips.length) * 50));\r\n                const data = await apiFetch<{ success: boolean; error?: string; trimmed_path: string }>('/trim-video', {\r\n                    method: 'POST',\r\n                    body: JSON.stringify({ video_url: decodeURIComponent(videoUrl), start_time: clip.startTime, end_time: clip.endTime }),\r\n                });\r\n                if (!data.success) throw new Error(data.error || 'Error recortando');\r\n                trimmedPaths.push(data.trimmed_path);\r\n            }\r\n            setExportMessage('Uniendo y aplicando overlays...');\r\n            setExportProgress(70);\r\n\r\n            // Build composition with overlays\r\n            const composition = {\r\n                clips: trimmedPaths,\r\n                overlays: overlays.map(o => ({\r\n                    media_path: o.mediaUrl.replace(process.env.NEXT_PUBLIC_API_URL || 'http://127.0.0.1:8000', ''),\r\n                    start_time: o.startTime, end_time: o.endTime,\r\n                    x: o.x, y: o.y, width: o.width, opacity: o.opacity,\r\n                })),\r\n            };\r\n\r\n            const mergeData = await apiFetch<{ success: boolean; error?: string; download_url: string }>('/merge-clips', {\r\n                method: 'POST',\r\n                body: JSON.stringify(composition),\r\n            });\r\n            if (!mergeData.success) throw new Error(mergeData.error || 'Error uniendo');\r\n            setExportProgress(100); setExportMessage('¬°Exportado!');\r\n            setExportResult(getApiUrl(mergeData.download_url));\r\n            showToast('¬°Video exportado!', 'success');\r\n        } catch (err) {\r\n            const errorMessage = err instanceof Error ? err.message : 'Error desconocido';\r\n            showToast('Error: ' + errorMessage, 'error');\r\n            setExportMessage('Error en exportaci√≥n');\r\n        } finally { setIsExporting(false); }\r\n    };\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Computed ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    const timelinePixelWidth = Math.max(600, duration * 80 * zoom);\r\n    const getRulerMarks = () => {\r\n        const marks: { time: number; label: string; major: boolean }[] = [];\r\n        if (!duration) return marks;\r\n        let interval = 1;\r\n        if (duration / zoom > 120) interval = 10;\r\n        else if (duration / zoom > 60) interval = 5;\r\n        else if (duration / zoom > 20) interval = 2;\r\n        for (let t = 0; t <= duration; t += interval)\r\n            marks.push({ time: t, label: formatTime(t), major: t % (interval * 5) === 0 || interval >= 5 });\r\n        return marks;\r\n    };\r\n    const selectedClip = clips.find(c => c.id === selectedClipId);\r\n    const selectedOverlay = overlays.find(o => o.id === selectedOverlayId);\r\n    const totalDuration = clips.reduce((a, c) => a + c.duration, 0);\r\n    const activeOverlays = overlays.filter(o => currentTime >= o.startTime && currentTime <= o.endTime);\r\n\r\n    // ‚îÄ‚îÄ‚îÄ Render ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n    return (\r\n        <div className=\"min-h-screen bg-black text-white selection:bg-primary/30 flex flex-col\">\r\n\r\n            {/* Navbar */}\r\n            <nav className=\"fixed top-0 inset-x-0 z-50 bg-black/80 backdrop-blur-2xl border-b border-white/[0.04]\">\r\n                <div className=\"max-w-[1800px] mx-auto px-6 h-14 flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <Link href=\"/editor\" className=\"text-sm font-black tracking-tight uppercase hover:text-primary transition-colors\">\r\n                            ‚Üê <span className=\"text-zinc-500\">VERSION</span><span className=\"text-primary\">.ED</span>\r\n                        </Link>\r\n                        <div className=\"w-px h-5 bg-white/[0.08]\" />\r\n                        <span className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500\">Timeline Pro</span>\r\n                        <div className=\"hidden md:flex items-center gap-2 ml-2\">\r\n                            <div className=\"px-2 py-0.5 rounded-md bg-primary/10 border border-primary/20 text-[8px] font-black uppercase text-primary tracking-tighter\">{targetLength}</div>\r\n                            <div className=\"px-2 py-0.5 rounded-md bg-white/5 border border-white/10 text-[8px] font-black uppercase text-zinc-400 tracking-tighter\">{scriptStyle}</div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"flex items-center gap-2 bg-white/[0.03] border border-white/[0.06] rounded-full px-4 py-1.5\">\r\n                            <span className=\"text-[9px] font-bold text-zinc-500 uppercase tracking-wider\">Duraci√≥n</span>\r\n                            <span className=\"text-xs font-mono font-bold text-white\">{formatTime(totalDuration)}</span>\r\n                        </div>\r\n                        {exportResult ? (\r\n                            <a href={exportResult} download className=\"btn-primary !py-2.5 !px-6 !text-[10px]\">‚¨á Descargar</a>\r\n                        ) : (\r\n                            <button onClick={handleExport} disabled={isExporting || !clips.length}\r\n                                className={`btn-primary !py-2.5 !px-6 !text-[10px] ${isExporting ? 'opacity-50 cursor-not-allowed' : ''}`}>\r\n                                {isExporting ? 'Exportando...' : '‚ö° Exportar'}\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </nav>\r\n\r\n            {/* Main */}\r\n            <div className=\"flex-1 flex flex-col pt-14\">\r\n                {videoError ? (\r\n                    <div className=\"flex-1 flex items-center justify-center\">\r\n                        <div className=\"text-center\">\r\n                            <div className=\"text-6xl mb-6\">‚ö†Ô∏è</div>\r\n                            <h2 className=\"text-xl font-black mb-2\">Error al cargar video</h2>\r\n                            <p className=\"text-zinc-500 text-sm mb-6\">{videoError}</p>\r\n                            <Link href=\"/editor\" className=\"btn-primary !py-3 !px-8\">‚Üê Volver</Link>\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    <>\r\n                        {/* Top: Preview + Sidebar */}\r\n                        <div className=\"flex-1 flex min-h-0\">\r\n                            {/* Video Preview */}\r\n                            <div className=\"flex-1 flex flex-col items-center justify-center p-6 bg-zinc-950/50\">\r\n                                {/* Video + Overlay Canvas */}\r\n                                <div ref={previewRef} className=\"relative w-full max-w-3xl aspect-video bg-black rounded-2xl overflow-hidden border border-white/[0.06] shadow-[0_8px_60px_rgba(0,0,0,0.6)]\"\r\n                                    style={{ cursor: isDraggingOverlay ? 'grabbing' : 'default' }}>\r\n                                    <video ref={videoRef} className=\"w-full h-full object-contain\" onEnded={() => setIsPlaying(false)} preload=\"metadata\" />\r\n                                    {/* Overlay images */}\r\n                                    {activeOverlays.map(o => (\r\n                                        <div key={o.id}\r\n                                            onMouseDown={e => startOverlayDrag(e, o.id)}\r\n                                            className={`absolute cursor-grab active:cursor-grabbing select-none transition-shadow ${selectedOverlayId === o.id ? 'ring-2 ring-primary/60' : ''}`}\r\n                                            style={{ left: `${o.x}%`, top: `${o.y}%`, width: `${o.width}%`, opacity: o.opacity, zIndex: 10 }}>\r\n                                            <img src={o.mediaUrl} alt={o.mediaName} className=\"w-full h-full object-contain pointer-events-none\" draggable={false} />\r\n                                        </div>\r\n                                    ))}\r\n                                    {!isVideoLoaded && !videoError && (\r\n                                        <div className=\"absolute inset-0 flex items-center justify-center bg-black/80\">\r\n                                            <div className=\"w-10 h-10 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n\r\n                                {/* Video Controls */}\r\n                                {isVideoLoaded && (\r\n                                    <div className=\"w-full max-w-3xl mt-4 flex items-center gap-4\">\r\n                                        <button onClick={togglePlay} className=\"w-10 h-10 rounded-full bg-primary/10 border border-primary/20 flex items-center justify-center text-primary hover:bg-primary/20 transition-all hover:scale-105 active:scale-95\">\r\n                                            {isPlaying ? '‚è∏' : '‚ñ∂'}\r\n                                        </button>\r\n                                        <div className=\"text-xs font-mono text-zinc-400 min-w-[120px]\">\r\n                                            <span className=\"text-white font-bold\">{formatTime(currentTime)}</span>\r\n                                            <span className=\"text-zinc-600 mx-1\">/</span>\r\n                                            <span>{formatTime(duration)}</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-1\">\r\n                                            {[0.5, 1, 1.5, 2].map(r => (\r\n                                                <button key={r} onClick={() => { const v = videoRef.current; if (v) { v.playbackRate = r; setPlaybackRate(r); } }}\r\n                                                    className={`px-2 py-1 text-[9px] font-bold uppercase rounded-lg transition-all ${playbackRate === r ? 'bg-white text-black' : 'text-zinc-600 hover:text-white hover:bg-white/[0.05]'}`}>\r\n                                                    {r}x\r\n                                                </button>\r\n                                            ))}\r\n                                        </div>\r\n                                        <div className=\"flex-1\" />\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <button onClick={() => { const v = videoRef.current; if (v) { v.muted = !v.muted; setIsMuted(v.muted); } }} className=\"text-zinc-500 hover:text-white transition-colors text-sm\">\r\n                                                {isMuted ? 'üîá' : volume > 0.5 ? 'üîä' : 'üîâ'}\r\n                                            </button>\r\n                                            <input type=\"range\" min=\"0\" max=\"1\" step=\"0.05\" value={isMuted ? 0 : volume}\r\n                                                onChange={e => { const v = videoRef.current; const val = parseFloat(e.target.value); if (v) { v.volume = val; setVolume(val); setIsMuted(val === 0); } }}\r\n                                                className=\"w-20 accent-primary h-1 cursor-pointer\" />\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Sidebar Panel */}\r\n                            <div className=\"w-80 border-l border-white/[0.04] bg-zinc-950/80 flex flex-col\">\r\n                                {/* Tabs */}\r\n                                <div className=\"flex border-b border-white/[0.04]\">\r\n                                    {(['clips', 'media', 'properties'] as ActivePanel[]).map(tab => (\r\n                                        <button key={tab} onClick={() => setActivePanel(tab)}\r\n                                            className={`flex-1 py-3 text-[9px] font-bold uppercase tracking-widest transition-all ${activePanel === tab ? 'text-white border-b-2 border-primary' : 'text-zinc-600 hover:text-zinc-400'}`}>\r\n                                            {tab === 'clips' ? 'üé¨ Clips' : tab === 'media' ? 'üìÇ Medios' : '‚ú¶ Props'}\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n\r\n                                {/* Tab: Clips */}\r\n                                {activePanel === 'clips' && (\r\n                                    <div className=\"flex-1 flex flex-col overflow-hidden\">\r\n                                        {selectedClip && (\r\n                                            <div className=\"p-4 border-b border-white/[0.04] space-y-3\">\r\n                                                <div className=\"grid grid-cols-2 gap-2\">\r\n                                                    <div className=\"p-2.5 bg-white/[0.02] border border-white/[0.06] rounded-xl\">\r\n                                                        <label className=\"text-[9px] font-bold uppercase text-zinc-600 block mb-1\">Inicio</label>\r\n                                                        <p className=\"text-xs font-mono font-bold text-emerald-400\">{formatTime(selectedClip.startTime)}</p>\r\n                                                    </div>\r\n                                                    <div className=\"p-2.5 bg-white/[0.02] border border-white/[0.06] rounded-xl\">\r\n                                                        <label className=\"text-[9px] font-bold uppercase text-zinc-600 block mb-1\">Fin</label>\r\n                                                        <p className=\"text-xs font-mono font-bold text-red-400\">{formatTime(selectedClip.endTime)}</p>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"p-2.5 bg-white/[0.02] border border-white/[0.06] rounded-xl\">\r\n                                                    <label className=\"text-[9px] font-bold uppercase text-zinc-600 block mb-1\">Duraci√≥n</label>\r\n                                                    <p className=\"text-sm font-mono font-bold\">{formatTime(selectedClip.duration)}</p>\r\n                                                </div>\r\n                                                <button onClick={() => handleDeleteClip(selectedClip.id)}\r\n                                                    className=\"w-full py-2 text-[10px] font-bold uppercase tracking-widest text-red-500 bg-red-500/5 border border-red-500/15 rounded-xl hover:bg-red-500/10 transition-all\">\r\n                                                    üóë Eliminar Clip\r\n                                                </button>\r\n                                            </div>\r\n                                        )}\r\n                                        <div className=\"flex-1 p-4 overflow-y-auto custom-scrollbar\">\r\n                                            <p className=\"text-[9px] font-bold uppercase tracking-widest text-zinc-600 mb-3\">Clips ({clips.length})</p>\r\n                                            <div className=\"space-y-1.5\">\r\n                                                {clips.map(clip => (\r\n                                                    <button key={clip.id} onClick={() => { setSelectedClipId(clip.id); seekTo(clip.startTime); }}\r\n                                                        className={`w-full text-left p-2.5 rounded-xl border transition-all ${selectedClipId === clip.id ? 'bg-primary/5 border-primary/25' : 'bg-white/[0.02] border-white/[0.06] hover:border-white/15'}`}>\r\n                                                        <div className=\"flex items-center gap-2\">\r\n                                                            <div className={`w-2.5 h-2.5 rounded-sm bg-gradient-to-r ${clip.color} flex-shrink-0`} />\r\n                                                            <span className=\"text-[10px] font-bold uppercase tracking-wider flex-1 truncate\">{clip.label}</span>\r\n                                                            <span className=\"text-[9px] font-mono text-zinc-500\">{formatTime(clip.duration)}</span>\r\n                                                        </div>\r\n                                                    </button>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Tab: Media Pool */}\r\n                                {activePanel === 'media' && (\r\n                                    <div className=\"flex-1 flex flex-col overflow-hidden\">\r\n                                        <div className=\"p-4 border-b border-white/[0.04]\">\r\n                                            <input ref={mediaInputRef} type=\"file\" accept=\"image/*,video/mp4,video/webm\" className=\"hidden\" onChange={handleUploadMedia} />\r\n                                            <button onClick={() => mediaInputRef.current?.click()} disabled={isUploadingMedia}\r\n                                                className=\"w-full py-2.5 text-[10px] font-bold uppercase tracking-widest bg-primary/10 border border-primary/20 text-primary rounded-xl hover:bg-primary/20 transition-all disabled:opacity-50\">\r\n                                                {isUploadingMedia ? '‚¨Ü Subiendo...' : '+ Subir Archivo'}\r\n                                            </button>\r\n                                        </div>\r\n                                        <div className=\"flex-1 p-3 overflow-y-auto custom-scrollbar\">\r\n                                            {isLoadingMedia ? (\r\n                                                <div className=\"flex items-center justify-center py-8\">\r\n                                                    <div className=\"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\r\n                                                </div>\r\n                                            ) : mediaFiles.length === 0 ? (\r\n                                                <p className=\"text-center text-zinc-600 text-[10px] py-8 leading-relaxed\">Tu biblioteca est√° vac√≠a.<br />Sube im√°genes o videos para usar como overlays.</p>\r\n                                            ) : (\r\n                                                <div className=\"grid grid-cols-2 gap-2\">\r\n                                                    {mediaFiles.map(file => (\r\n                                                        <div key={file.id} className=\"relative group rounded-xl overflow-hidden border border-white/[0.06] bg-white/[0.02] aspect-video cursor-pointer hover:border-primary/40 transition-all\"\r\n                                                            onClick={() => addOverlay(file)}>\r\n                                                            {file.type === 'image' ? (\r\n                                                                <img src={`${process.env.NEXT_PUBLIC_API_URL || 'http://127.0.0.1:8000'}${file.url}`}\r\n                                                                    alt={file.name} className=\"w-full h-full object-cover\" />\r\n                                                            ) : (\r\n                                                                <div className=\"w-full h-full flex items-center justify-center bg-zinc-900\">\r\n                                                                    <span className=\"text-2xl\">üé¨</span>\r\n                                                                </div>\r\n                                                            )}\r\n                                                            <div className=\"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\">\r\n                                                                <span className=\"text-[9px] font-bold text-white uppercase\">+ A√±adir</span>\r\n                                                            </div>\r\n                                                            <button onClick={e => { e.stopPropagation(); handleDeleteMedia(file.id); }}\r\n                                                                className=\"absolute top-1 right-1 w-5 h-5 rounded-full bg-black/80 text-red-400 text-[9px] flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                                                √ó\r\n                                                            </button>\r\n                                                            <div className=\"absolute bottom-0 inset-x-0 p-1 bg-black/70\">\r\n                                                                <p className=\"text-[8px] text-zinc-300 truncate\">{file.name}</p>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Tab: Properties */}\r\n                                {activePanel === 'properties' && (\r\n                                    <div className=\"flex-1 p-4 overflow-y-auto custom-scrollbar\">\r\n                                        {!selectedOverlay ? (\r\n                                            <div className=\"text-center py-8\">\r\n                                                <p className=\"text-zinc-600 text-[10px]\">Selecciona un overlay</p>\r\n                                                <p className=\"text-zinc-700 text-[9px] mt-2\">A√±ade medios desde la pesta√±a Medios</p>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <div className=\"space-y-4\">\r\n                                                <p className=\"text-[9px] font-bold uppercase tracking-widest text-zinc-500 truncate\">{selectedOverlay.mediaName}</p>\r\n                                                <div className=\"space-y-3\">\r\n                                                    <div>\r\n                                                        <label className=\"text-[9px] font-bold uppercase text-zinc-600 block mb-1\">Inicio (s)</label>\r\n                                                        <input type=\"number\" min=\"0\" max={duration} step=\"0.1\" value={selectedOverlay.startTime.toFixed(1)}\r\n                                                            onChange={e => updateOverlay(selectedOverlay.id, { startTime: parseFloat(e.target.value) || 0 })}\r\n                                                            className=\"w-full bg-white/[0.03] border border-white/[0.08] rounded-lg px-3 py-2 text-xs font-mono text-white outline-none focus:border-primary/40\" />\r\n                                                    </div>\r\n                                                    <div>\r\n                                                        <label className=\"text-[9px] font-bold uppercase text-zinc-600 block mb-1\">Fin (s)</label>\r\n                                                        <input type=\"number\" min=\"0\" max={duration} step=\"0.1\" value={selectedOverlay.endTime.toFixed(1)}\r\n                                                            onChange={e => updateOverlay(selectedOverlay.id, { endTime: parseFloat(e.target.value) || 0 })}\r\n                                                            className=\"w-full bg-white/[0.03] border border-white/[0.08] rounded-lg px-3 py-2 text-xs font-mono text-white outline-none focus:border-primary/40\" />\r\n                                                    </div>\r\n                                                    <div>\r\n                                                        <label className=\"text-[9px] font-bold uppercase text-zinc-600 block mb-1\">Tama√±o: {selectedOverlay.width}%</label>\r\n                                                        <input type=\"range\" min=\"5\" max=\"100\" value={selectedOverlay.width}\r\n                                                            onChange={e => updateOverlay(selectedOverlay.id, { width: parseInt(e.target.value) })}\r\n                                                            className=\"w-full accent-primary cursor-pointer\" />\r\n                                                    </div>\r\n                                                    <div>\r\n                                                        <label className=\"text-[9px] font-bold uppercase text-zinc-600 block mb-1\">Opacidad: {Math.round(selectedOverlay.opacity * 100)}%</label>\r\n                                                        <input type=\"range\" min=\"0\" max=\"100\" value={Math.round(selectedOverlay.opacity * 100)}\r\n                                                            onChange={e => updateOverlay(selectedOverlay.id, { opacity: parseInt(e.target.value) / 100 })}\r\n                                                            className=\"w-full accent-primary cursor-pointer\" />\r\n                                                    </div>\r\n                                                    <div className=\"grid grid-cols-2 gap-2 font-mono text-[9px]\">\r\n                                                        <div className=\"p-2 bg-white/[0.02] rounded-lg border border-white/[0.06]\">\r\n                                                            <span className=\"text-zinc-600 block mb-0.5\">X</span>\r\n                                                            <span className=\"text-white\">{selectedOverlay.x.toFixed(1)}%</span>\r\n                                                        </div>\r\n                                                        <div className=\"p-2 bg-white/[0.02] rounded-lg border border-white/[0.06]\">\r\n                                                            <span className=\"text-zinc-600 block mb-0.5\">Y</span>\r\n                                                            <span className=\"text-white\">{selectedOverlay.y.toFixed(1)}%</span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <button onClick={() => deleteOverlay(selectedOverlay.id)}\r\n                                                        className=\"w-full py-2 text-[10px] font-bold uppercase tracking-widest text-red-500 bg-red-500/5 border border-red-500/15 rounded-xl hover:bg-red-500/10 transition-all\">\r\n                                                        üóë Eliminar Overlay\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Shortcuts footer */}\r\n                                <div className=\"p-4 border-t border-white/[0.04]\">\r\n                                    <div className=\"grid grid-cols-2 gap-1 text-[8px] text-zinc-600\">\r\n                                        <span><kbd className=\"px-1.5 py-0.5 bg-white/[0.04] rounded text-zinc-400 font-mono\">Space</kbd> Play</span>\r\n                                        <span><kbd className=\"px-1.5 py-0.5 bg-white/[0.04] rounded text-zinc-400 font-mono\">S</kbd> Split</span>\r\n                                        <span><kbd className=\"px-1.5 py-0.5 bg-white/[0.04] rounded text-zinc-400 font-mono\">‚Üê‚Üí</kbd> Seek</span>\r\n                                        <span><kbd className=\"px-1.5 py-0.5 bg-white/[0.04] rounded text-zinc-400 font-mono\">Del</kbd> Borrar</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>{/* end top section */}\r\n\r\n                        {/* Export Progress */}\r\n                        {isExporting && (\r\n                            <div className=\"px-6 py-3 bg-zinc-900/80 border-t border-white/[0.04]\">\r\n                                <div className=\"max-w-[1800px] mx-auto flex items-center gap-4\">\r\n                                    <div className=\"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\r\n                                    <div className=\"flex-1\">\r\n                                        <div className=\"h-1.5 bg-white/[0.04] rounded-full overflow-hidden\">\r\n                                            <div className=\"h-full bg-primary rounded-full transition-all duration-500 shadow-[0_0_10px_rgba(220,38,38,0.4)]\" style={{ width: `${exportProgress}%` }} />\r\n                                        </div>\r\n                                    </div>\r\n                                    <span className=\"text-[10px] font-mono text-zinc-400 min-w-[200px]\">{exportMessage}</span>\r\n                                    <span className=\"text-xs font-mono font-bold text-primary\">{exportProgress}%</span>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Bottom: Timeline */}\r\n                        <div className=\"border-t border-white/[0.04] bg-zinc-950\">\r\n                            {/* Toolbar */}\r\n                            <div className=\"flex items-center justify-between px-6 py-2.5 border-b border-white/[0.04] bg-black/50\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <button onClick={handleSplit}\r\n                                        className=\"flex items-center gap-1.5 px-3.5 py-2 text-[10px] font-bold uppercase tracking-wider bg-white/[0.03] border border-white/[0.06] rounded-lg hover:border-primary/30 hover:bg-primary/5 hover:text-primary transition-all\">\r\n                                        ‚úÇÔ∏è Split\r\n                                    </button>\r\n                                    <button onClick={() => selectedClipId && handleDeleteClip(selectedClipId)}\r\n                                        disabled={!selectedClipId || clips.length <= 1}\r\n                                        className=\"flex items-center gap-1.5 px-3.5 py-2 text-[10px] font-bold uppercase tracking-wider bg-white/[0.03] border border-white/[0.06] rounded-lg hover:border-red-500/30 hover:bg-red-500/5 hover:text-red-500 transition-all disabled:opacity-30 disabled:cursor-not-allowed\">\r\n                                        üóë Eliminar\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <span className=\"text-[9px] font-bold text-zinc-600 uppercase tracking-widest\">Zoom</span>\r\n                                    <button onClick={() => setZoom(z => Math.max(z - 0.5, 0.5))} className=\"w-7 h-7 rounded-lg bg-white/[0.03] border border-white/[0.06] text-zinc-500 hover:text-white hover:bg-white/[0.06] transition-all text-xs font-bold\">‚àí</button>\r\n                                    <span className=\"text-[10px] font-mono text-zinc-400 min-w-[40px] text-center\">{zoom.toFixed(1)}x</span>\r\n                                    <button onClick={() => setZoom(z => Math.min(z + 0.5, 5))} className=\"w-7 h-7 rounded-lg bg-white/[0.03] border border-white/[0.06] text-zinc-500 hover:text-white hover:bg-white/[0.06] transition-all text-xs font-bold\">+</button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Timeline */}\r\n                            <div className=\"overflow-x-auto custom-scrollbar\" ref={timelineRef} onClick={handleTimelineClick}>\r\n                                <div className=\"relative\" style={{ width: `${timelinePixelWidth}px`, minWidth: '100%' }}>\r\n\r\n                                    {/* Ruler */}\r\n                                    <div className=\"h-7 border-b border-white/[0.04] relative bg-black/40 select-none\">\r\n                                        {getRulerMarks().map((m, i) => (\r\n                                            <div key={i} className=\"absolute top-0 flex flex-col items-center\" style={{ left: `${(m.time / duration) * 100}%` }}>\r\n                                                <div className={`w-px ${m.major ? 'h-4 bg-zinc-600' : 'h-2.5 bg-zinc-800'}`} />\r\n                                                {m.major && <span className=\"text-[8px] font-mono text-zinc-600 mt-0.5 whitespace-nowrap\">{m.label}</span>}\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n\r\n                                    {/* Video Track Label */}\r\n                                    <div className=\"flex\">\r\n                                        <div className=\"w-16 flex-shrink-0 flex items-center justify-end pr-2 border-r border-white/[0.04] bg-black/20\">\r\n                                            <span className=\"text-[7px] font-bold uppercase tracking-widest text-zinc-600 rotate-0\">VID</span>\r\n                                        </div>\r\n                                        {/* Video Track */}\r\n                                        <div className=\"flex-1 h-16 relative bg-zinc-900/30\">\r\n                                            {clips.map((clip, i) => {\r\n                                                const left = (clip.startTime / duration) * 100;\r\n                                                const width = ((clip.endTime - clip.startTime) / duration) * 100;\r\n                                                const isSelected = selectedClipId === clip.id;\r\n                                                return (\r\n                                                    <div key={clip.id} draggable onClick={e => { e.stopPropagation(); setSelectedClipId(clip.id); }}\r\n                                                        className={`absolute top-2 bottom-2 rounded-xl border-2 cursor-grab active:cursor-grabbing transition-all group bg-gradient-to-r ${clip.color} ${isSelected ? CLIP_BORDERS[i % CLIP_BORDERS.length] : 'border-white/[0.08] hover:border-white/20'}`}\r\n                                                        style={{ left: `${left}%`, width: `${width}%`, minWidth: '30px' }}>\r\n                                                        {/* Trim Left */}\r\n                                                        <div onMouseDown={e => handleTrimStart(e, clip.id, 'start')} className=\"absolute left-0 top-0 bottom-0 w-3 cursor-col-resize group/h hover:bg-white/10 rounded-l-xl flex items-center justify-center\">\r\n                                                            <div className=\"w-0.5 h-5 bg-white/20 group-hover/h:bg-white/60 rounded-full transition-colors\" />\r\n                                                        </div>\r\n                                                        <div className=\"absolute inset-x-4 top-0 bottom-0 flex items-center overflow-hidden\">\r\n                                                            <span className=\"text-[9px] font-bold uppercase tracking-wider text-white/80 truncate\">{clip.label}</span>\r\n                                                            <span className=\"text-[8px] font-mono text-white/40 ml-2 whitespace-nowrap\">{formatTime(clip.duration)}</span>\r\n                                                        </div>\r\n                                                        {/* Waveform decoration */}\r\n                                                        <div className=\"absolute inset-x-3 bottom-1.5 flex items-end gap-px opacity-20 pointer-events-none\">\r\n                                                            {Array.from({ length: Math.max(8, Math.floor(width * 1.5)) }).map((_, j) => (\r\n                                                                <div key={`${clip.id}-wave-${j}`} className=\"flex-1 bg-white rounded-full\" style={{ height: `${4 + Math.sin(j * 0.7) * 6 + ((Math.abs(Math.sin(j * 13.37))) * 6)}px` }} />\r\n                                                            ))}\r\n                                                        </div>\r\n                                                        {/* Trim Right */}\r\n                                                        <div onMouseDown={e => handleTrimStart(e, clip.id, 'end')} className=\"absolute right-0 top-0 bottom-0 w-3 cursor-col-resize group/h hover:bg-white/10 rounded-r-xl flex items-center justify-center\">\r\n                                                            <div className=\"w-0.5 h-5 bg-white/20 group-hover/h:bg-white/60 rounded-full transition-colors\" />\r\n                                                        </div>\r\n                                                    </div>\r\n                                                );\r\n                                            })}\r\n                                            {/* Playhead line */}\r\n                                            {duration > 0 && (\r\n                                                <div className=\"absolute top-0 bottom-0 z-20 pointer-events-none\" style={{ left: `${(currentTime / duration) * 100}%` }}>\r\n                                                    <div className=\"w-px h-full bg-primary/60\" />\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Overlay Tracks */}\r\n                                    {[0, 1, 2].map(trackIdx => {\r\n                                        const trackOverlays = overlays.filter((_, i) => i % 3 === trackIdx);\r\n                                        return (\r\n                                            <div key={trackIdx} className=\"flex border-t border-white/[0.03]\">\r\n                                                <div className=\"w-16 flex-shrink-0 flex items-center justify-end pr-2 border-r border-white/[0.04] bg-black/20\">\r\n                                                    <span className=\"text-[7px] font-bold uppercase tracking-widest text-zinc-700\">OVL {trackIdx + 1}</span>\r\n                                                </div>\r\n                                                <div className=\"flex-1 h-10 relative bg-black/20\">\r\n                                                    {trackOverlays.map(o => {\r\n                                                        const left = (o.startTime / duration) * 100;\r\n                                                        const width = ((o.endTime - o.startTime) / duration) * 100;\r\n                                                        const isSelOv = selectedOverlayId === o.id;\r\n                                                        return (\r\n                                                            <div key={o.id} onClick={e => { e.stopPropagation(); setSelectedOverlayId(o.id); setActivePanel('properties'); }}\r\n                                                                className={`absolute top-1 bottom-1 rounded-lg border cursor-pointer transition-all ${OVERLAY_TRACK_COLORS[trackIdx]} ${isSelOv ? 'ring-1 ring-primary' : 'hover:brightness-125'}`}\r\n                                                                style={{ left: `${left}%`, width: `${width}%`, minWidth: '20px' }}>\r\n                                                                <div className=\"absolute inset-x-2 top-0 bottom-0 flex items-center overflow-hidden\">\r\n                                                                    <span className=\"text-[7px] font-bold text-white/70 truncate\">{o.mediaName}</span>\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        );\r\n                                                    })}\r\n                                                    {duration > 0 && (\r\n                                                        <div className=\"absolute top-0 bottom-0 z-10 pointer-events-none\" style={{ left: `${(currentTime / duration) * 100}%` }}>\r\n                                                            <div className=\"w-px h-full bg-primary/40\" />\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n                                        );\r\n                                    })}\r\n\r\n                                    {/* Playhead (global) */}\r\n                                    {duration > 0 && (\r\n                                        <div className=\"absolute top-0 bottom-0 z-30 pointer-events-none\" style={{ left: `${(currentTime / duration) * 100}%` }}>\r\n                                            <div onMouseDown={handlePlayheadMouseDown} className=\"absolute -top-0 -translate-x-1/2 w-4 h-4 bg-primary rounded-b-sm pointer-events-auto cursor-grab active:cursor-grabbing shadow-[0_0_8px_rgba(220,38,38,0.5)] hover:scale-110 transition-transform\"\r\n                                                style={{ clipPath: 'polygon(0 0, 100% 0, 50% 100%)' }} />\r\n                                            <div className=\"w-px h-full bg-primary shadow-[0_0_4px_rgba(220,38,38,0.4)]\" />\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n\r\n            {/* Toast */}\r\n            {toast && (\r\n                <div className={`fixed bottom-6 left-1/2 -translate-x-1/2 z-50 px-5 py-3 rounded-2xl text-sm font-bold shadow-2xl transition-all animate-fade ${toast.type === 'success' ? 'bg-emerald-500/20 border border-emerald-500/30 text-emerald-300' :\r\n                    toast.type === 'error' ? 'bg-red-500/20 border border-red-500/30 text-red-300' :\r\n                        'bg-zinc-800/90 border border-white/10 text-white'}`}>\r\n                    {toast.msg}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default function TimelineEditorPage() {\r\n    return (\r\n        <Suspense fallback={\r\n            <div className=\"min-h-screen bg-black flex items-center justify-center\">\r\n                <div className=\"w-10 h-10 border-2 border-red-500 border-t-transparent rounded-full animate-spin\" />\r\n            </div>\r\n        }>\r\n            <TimelineEditorContent />\r\n        </Suspense>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\login\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":81,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport { useAuth } from '@/context/AuthContext';\nimport '../globals.css';\n\nexport default function Login() {\n    const [isLogin, setIsLogin] = useState(true);\n    const [credentials, setCredentials] = useState({ email: '', password: '', name: '' });\n    const [error, setError] = useState('');\n    const [success, setSuccess] = useState('');\n    const router = useRouter();\n    const { login } = useAuth();\n\n    const getApiUrl = (path: string) => {\n        const baseUrl = process.env.NEXT_PUBLIC_API_URL || 'http://127.0.0.1:8000';\n        return `${baseUrl}${path}`;\n    };\n\n    const handleAction = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError('');\n        setSuccess('');\n\n        try {\n            if (isLogin) {\n                // --- LOGIN FLOW ---\n                const res = await fetch(getApiUrl('/login'), {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({ email: credentials.email, password: credentials.password })\n                });\n                const data = await res.json();\n\n                if (data.success) {\n                    login(data.token, {\n                        email: credentials.email,\n                        name: data.name,\n                        role: data.role,\n                        credits: data.credits\n                    });\n                    router.push('/dashboard');\n                } else {\n                    setError(data.message || 'Error de autenticaci√≥n.');\n                }\n            } else {\n                // --- REGISTER FLOW ---\n                if (!credentials.email || !credentials.password || !credentials.name) {\n                    return setError('Por favor, completa todos los campos.');\n                }\n\n                const res = await fetch(getApiUrl('/register'), {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        email: credentials.email,\n                        password: credentials.password,\n                        name: credentials.name.toUpperCase()\n                    })\n                });\n                const data = await res.json();\n\n                if (data.success) {\n                    // Auto-login con los datos devueltos\n                    login(data.token, {\n                        email: credentials.email,\n                        name: data.name,\n                        role: data.role,\n                        credits: data.credits\n                    });\n\n                    setSuccess(data.message);\n                    // Peque√±a pausa para leer el mensaje de √©xito antes de redirigir\n                    setTimeout(() => router.push('/dashboard'), 1500);\n                } else {\n                    setError(data.message || 'Error al crear cuenta.');\n                }\n            }\n        } catch (err) {\n            setError('No se pudo conectar con el servidor VERSION. Verifica tu conexi√≥n.');\n        }\n    };\n\n    return (\n        <div className=\"min-h-screen bg-black flex items-center justify-center p-6 relative overflow-hidden\">\n            {/* Background Decor */}\n            <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-primary/5 blur-[150px] rounded-full -z-10\"></div>\n\n            <div className=\"glass-card w-full max-w-md !p-10 animate-fade\">\n                <div className=\"text-center mb-10\">\n                    <Link href=\"/\" className=\"text-3xl font-black tracking-tighter uppercase inline-block hover:scale-105 transition-transform\">\n                        VERSION<span className=\"text-primary\">.</span>\n                    </Link>\n                    <p className=\"text-[10px] text-zinc-500 font-bold tracking-[0.3em] uppercase mt-4\">\n                        {isLogin ? 'Acceso al Ecosistema' : 'Crear Nueva Identidad'}\n                    </p>\n                </div>\n\n                <form onSubmit={handleAction} className=\"flex flex-col gap-5\">\n                    {/* The previous code had a bug where name was inside an inverted logic of login, I will just correct the `!isLogin` check */}\n                    {!isLogin && (\n                        <div className=\"space-y-2\">\n                            <label className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 ml-1\">Nombre Completo</label>\n                            <input\n                                type=\"text\"\n                                placeholder=\"Tu nombre\"\n                                required\n                                value={credentials.name}\n                                onChange={(e) => setCredentials({ ...credentials, name: e.target.value })}\n                                className=\"input-field\"\n                            />\n                        </div>\n                    )}\n\n                    <div className=\"space-y-2\">\n                        <label className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 ml-1\">Email / Usuario</label>\n                        <input\n                            type=\"text\"\n                            placeholder=\"email@ejemplo.com\"\n                            required\n                            value={credentials.email}\n                            onChange={(e) => setCredentials({ ...credentials, email: e.target.value })}\n                            className=\"input-field\"\n                        />\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 ml-1\">C√≥digo de Acceso</label>\n                        <input\n                            type=\"password\"\n                            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                            required\n                            value={credentials.password}\n                            onChange={(e) => setCredentials({ ...credentials, password: e.target.value })}\n                            className=\"input-field\"\n                        />\n                    </div>\n\n                    {error && (\n                        <div className=\"p-4 bg-primary/5 border border-primary/15 text-primary text-[10px] font-bold uppercase tracking-widest text-center rounded-xl animate-pulse\">\n                            {error}\n                        </div>\n                    )}\n\n                    {success && (\n                        <div className=\"p-4 bg-green-500/5 border border-green-500/15 text-green-500 text-[10px] font-bold uppercase tracking-widest text-center rounded-xl\">\n                            {success}\n                        </div>\n                    )}\n\n                    <button type=\"submit\" className=\"btn-primary w-full mt-2 !py-4\">\n                        {isLogin ? 'Iniciar Conexi√≥n' : 'Unirse a la √âlite'}\n                    </button>\n\n                    <button\n                        type=\"button\"\n                        onClick={() => setIsLogin(!isLogin)}\n                        className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 hover:text-white transition-colors cursor-pointer\"\n                    >\n                        {isLogin ? '¬øNo tienes cuenta? Reg√≠strate y obt√©n 30 tokens' : '¬øYa eres miembro? Inicia Sesi√≥n'}\n                    </button>\n                </form>\n\n                <div className=\"text-center mt-10 space-y-4\">\n                    <Link href=\"/\" className=\"text-[9px] text-zinc-600 hover:text-white font-bold uppercase tracking-[0.2em] transition-colors block\">\n                        Al ingresar aceptas los t√©rminos de la red VERSION\n                    </Link>\n                    <div className=\"h-[1px] w-12 bg-white/[0.04] mx-auto\"></div>\n                    <Link href=\"/\" className=\"text-[9px] text-zinc-600 hover:text-primary font-bold uppercase tracking-[0.2em] transition-colors block\">\n                        ‚Üê Regresar a la red p√∫blica\n                    </Link>\n                </div>\n            </div>\n\n            {/* Footer Tag */}\n            <div className=\"absolute bottom-8 text-[8px] font-bold tracking-[0.5em] text-white/10 uppercase italic\">\n                Secure Neural Link v2.0.26\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":3,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Link"},"fix":{"range":[17,48],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":19,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useEffect"},"fix":{"range":[57,67],"text":""},"desc":"Remove unused variable \"useEffect\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":4,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":27,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useRef"},"fix":{"range":[48,92],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { useEffect, useRef } from 'react';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { Navbar } from '@/components/Navbar';\r\nimport dynamic from 'next/dynamic';\r\nconst HeroBackground = dynamic(() => import('@/components/visual/HeroBackground').then(mod => mod.HeroBackground), { ssr: false });\r\nimport { motion } from 'framer-motion';\r\nimport { EliteCard } from '@/components/ui/EliteCard';\r\nimport { EliteButton } from '@/components/ui/EliteButton';\r\nimport { PricingCard } from '@/components/ui/PricingCard';\r\nimport './globals.css';\r\n\r\nconst STATS = [\r\n  { value: '5', label: 'Herramientas AI' },\r\n  { value: '100%', label: 'En la nube' },\r\n  { value: '24/7', label: 'Disponible' },\r\n  { value: '2026', label: 'En producci√≥n' },\r\n];\r\n\r\nconst APPS = [\r\n  { icon: 'üé¨', badge: 'Video Engine', badgeColor: 'border-primary text-primary', title: 'VERSION Editor', desc: 'Generaci√≥n de guion, voz y edici√≥n en segundos.', href: '/editor', linkColor: 'text-primary', linkLabel: 'Abrir Terminal' },\r\n  { icon: 'üñºÔ∏è', badge: 'Visual Core', badgeColor: 'border-purple-500 text-purple-500', title: 'VERSION Thumbnails', desc: 'Dise√±o de miniaturas con an√°lisis de CTR por IA y borrado de fondo.', href: '/thumbnails', linkColor: 'text-purple-500', linkLabel: 'Dise√±ar Ahora' },\r\n  { icon: 'üìù', badge: 'Script Engine', badgeColor: 'border-red-500 text-red-500', title: 'VERSION Writer', desc: 'Guiones virales con estructura de retenci√≥n y Modo Deep.', href: '/writer', linkColor: 'text-red-500', linkLabel: 'Escribir Guion' },\r\n  { icon: 'üöÄ', badge: 'Growth Engine', badgeColor: 'border-green-500 text-green-500', title: 'VERSION SEO', desc: 'Dominaci√≥n de palabras clave y optimizaci√≥n de metadatos.', href: '/seo', linkColor: 'text-green-500', linkLabel: 'Optimizar' },\r\n  { icon: 'ü§ñ', badge: 'Neural System', badgeColor: 'border-primary text-primary', title: 'VERSION AI', desc: 'Tu cerebro digital residente. Consultor√≠a estrat√©gica total.', href: '/ai', linkColor: 'text-primary', linkLabel: 'Iniciar Conexi√≥n', wide: true },\r\n];\r\n\r\nexport default function Home() {\r\n  const { user } = useAuth();\r\n\r\n  return (\r\n    <main className=\"min-h-screen overflow-x-hidden\">\r\n\r\n      {/* Navbar con estado de auth */}\r\n      <Navbar variant=\"public\" />\r\n\r\n      {/* Hero Section */}\r\n      <section className=\"container py-32 md:py-48 text-center relative min-h-[90vh] flex flex-col justify-center items-center\">\r\n        <HeroBackground />\r\n\r\n        <motion.h1\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.8, ease: [0.16, 1, 0.3, 1] }}\r\n          className=\"text-[clamp(2.5rem,10vw,8rem)] font-black leading-[0.8] tracking-tighter mb-8 uppercase\"\r\n        >\r\n          VERSION <br />\r\n          <span className=\"text-primary\">‚Äî</span> AUTOMATIZA <br />\r\n          TU CREATIVIDAD\r\n        </motion.h1>\r\n\r\n        <motion.p\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.8, delay: 0.1, ease: [0.16, 1, 0.3, 1] }}\r\n          className=\"text-muted-custom text-lg md:text-xl max-w-2xl mx-auto mb-12 font-medium\"\r\n        >\r\n          La plataforma definitiva de IA y automatizaci√≥n dise√±ada para la nueva √©lite de creadores digitales.\r\n        </motion.p>\r\n\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.8, delay: 0.2, ease: [0.16, 1, 0.3, 1] }}\r\n          className=\"flex flex-col md:flex-row gap-4 justify-center items-center\"\r\n        >\r\n          <EliteButton href=\"#apps\" size=\"xl\" className=\"w-full md:w-auto\">Explorar Ecosistema</EliteButton>\r\n          <EliteButton href={user ? '/dashboard' : '/login'} variant=\"outline\" size=\"xl\" className=\"w-full md:w-auto\">\r\n            {user ? 'Ir al Dashboard' : 'Unirse a la √âlite'}\r\n          </EliteButton>\r\n        </motion.div>\r\n\r\n        {/* Stats bar */}\r\n        <motion.div\r\n          initial={{ opacity: 0 }}\r\n          animate={{ opacity: 1 }}\r\n          transition={{ delay: 1, duration: 1 }}\r\n          className=\"flex flex-wrap justify-center gap-8 mt-20 border-t border-white/[0.04] pt-12\"\r\n        >\r\n          {STATS.map(s => (\r\n            <div key={s.label} className=\"text-center\">\r\n              <div className=\"text-2xl font-black text-white\">{s.value}</div>\r\n              <div className=\"text-[9px] font-bold uppercase tracking-widest text-zinc-600 mt-1\">{s.label}</div>\r\n            </div>\r\n          ))}\r\n        </motion.div>\r\n      </section>\r\n\r\n      {/* Apps Section */}\r\n      <section id=\"apps\" className=\"container py-24 border-t border-white/[0.04]\">\r\n        <div className=\"flex flex-col md:flex-row justify-between items-end mb-16 gap-4\">\r\n          <div>\r\n            <span className=\"text-[10px] font-bold text-primary uppercase tracking-[0.3em] mb-4 block\">Ecosistema 2026</span>\r\n            <h2 className=\"text-4xl md:text-5xl font-black tracking-tighter uppercase\">Armamento <span className=\"text-primary\">Digital</span></h2>\r\n          </div>\r\n          <p className=\"text-muted-custom max-w-sm text-sm\">Herramientas de grado industrial para dominar los algoritmos modernos.</p>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n          {APPS.map((app, i) => (\r\n            <motion.div\r\n              key={app.title}\r\n              initial={{ opacity: 0, y: 20 }}\r\n              whileInView={{ opacity: 1, y: 0 }}\r\n              viewport={{ once: true }}\r\n              transition={{ duration: 0.5, delay: i * 0.1 }}\r\n              className={app.wide ? 'md:col-span-2 lg:col-span-1' : ''}\r\n            >\r\n              <EliteCard\r\n                title={app.title}\r\n                subtitle={app.badge}\r\n                description={app.desc}\r\n                glowColor={app.badgeColor.includes('red') ? '#dc2626' : (app.badgeColor.includes('purple') ? '#a855f7' : '#dc2626')}\r\n                className=\"h-full\"\r\n                footer={\r\n                  <EliteButton href={app.href} variant=\"outline\" size=\"sm\" className=\"w-full md:w-auto\">\r\n                    {app.linkLabel}\r\n                  </EliteButton>\r\n                }\r\n              >\r\n                <div className=\"absolute top-0 right-0 p-8 text-4xl opacity-5 group-hover/card:opacity-20 transition-all duration-700 rotate-12 group-hover/card:rotate-0\">\r\n                  {app.icon}\r\n                </div>\r\n              </EliteCard>\r\n            </motion.div>\r\n          ))}\r\n        </div>\r\n      </section>\r\n\r\n      {/* Academy Section */}\r\n      <section id=\"cursos\" className=\"bg-zinc-950/50 py-32 border-y border-white/[0.04]\">\r\n        <div className=\"container grid grid-cols-1 lg:grid-cols-2 gap-16 items-center\">\r\n          <motion.div\r\n            initial={{ opacity: 0, x: -30 }}\r\n            whileInView={{ opacity: 1, x: 0 }}\r\n            viewport={{ once: true }}\r\n          >\r\n            <span className=\"text-primary font-bold tracking-widest text-[10px] uppercase mb-4 block\">Formaci√≥n de √âlite</span>\r\n            <h2 className=\"text-5xl md:text-7xl font-black tracking-tighter leading-none mb-8 uppercase\">\r\n              DEJA DE <br /> <span className=\"text-primary\">CONSUMIR</span>, <br /> EMPIEZA A <br /> CREAR.\r\n            </h2>\r\n            <p className=\"text-muted-custom text-lg mb-10 max-w-md italic\">\r\n              &quot;En la era de la IA, la √∫nica moneda real es la capacidad de orquestar m√°quinas.&quot;\r\n            </p>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex items-center gap-6 p-5 border border-primary/20 hover:border-primary/40 transition-all bg-primary/[0.03] rounded-2xl group\">\r\n                <span className=\"text-primary font-black text-lg\">01</span>\r\n                <div>\r\n                  <h4 className=\"text-sm font-black uppercase\">Master en IA Generativa</h4>\r\n                  <p className=\"text-[10px] text-zinc-500 uppercase tracking-widest\">Contenido viral y escalado masivo</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-center gap-6 p-5 border border-white/[0.04] hover:border-white/15 transition-all bg-black/40 rounded-2xl\">\r\n                <span className=\"font-black text-lg\">02</span>\r\n                <div>\r\n                  <h4 className=\"text-sm font-black uppercase\">Automatizaci√≥n No-Code</h4>\r\n                  <p className=\"text-[10px] text-zinc-500 uppercase tracking-widest\">Sistemas aut√≥nomos de ingresos</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </motion.div>\r\n\r\n          <motion.div\r\n            initial={{ opacity: 0, scale: 0.9 }}\r\n            whileInView={{ opacity: 1, scale: 1 }}\r\n            viewport={{ once: true }}\r\n            className=\"relative aspect-square md:aspect-video lg:aspect-square bg-gradient-to-tr from-zinc-900 to-black border border-white/[0.06] flex items-center justify-center overflow-hidden rounded-3xl\"\r\n          >\r\n            <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_center,var(--primary-glow)_0%,transparent_70%)]\" />\r\n            <div className=\"z-10 text-center\">\r\n              <div className=\"text-[10vw] font-black text-white/5 select-none mb-4\">REBEL</div>\r\n              <EliteButton href={user ? '/dashboard' : '/login'} variant=\"outline\">\r\n                Acceder a la Academia\r\n              </EliteButton>\r\n            </div>\r\n          </motion.div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Pricing Section */}\r\n      <section id=\"precios\" className=\"container py-32\">\r\n        <div className=\"text-center mb-20\">\r\n          <h2 className=\"text-4xl md:text-6xl font-black tracking-tighter uppercase mb-4\">Inversi√≥n en tu Arsenal</h2>\r\n          <p className=\"text-muted-custom\">Desbloquea el poder total de la automatizaci√≥n.</p>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto\">\r\n          <PricingCard\r\n            title=\"Access Free\"\r\n            subtitle=\"Nivel 1\"\r\n            price=\"0\"\r\n            period=\"/mes\"\r\n            features={[\r\n              { text: 'VERSION AI Chat Acceso' },\r\n              { text: 'Creaci√≥n de Cuenta Gratis' }\r\n            ]}\r\n            buttonText=\"Crear Cuenta Gratis\"\r\n            buttonHref=\"/login\"\r\n          />\r\n\r\n          <PricingCard\r\n            title=\"Elite Access\"\r\n            subtitle=\"Nivel Master\"\r\n            price=\"29\"\r\n            period=\".USD\"\r\n            glowColor=\"#dc2626\"\r\n            isPopular={true}\r\n            badge=\"Pack Elite\"\r\n            features={[\r\n              { text: '1.000 Tokens (100 Videos)', highlighted: true },\r\n              { text: 'VERSION Editor Desbloqueado' }\r\n            ]}\r\n            buttonText=\"Adquirir Tokens Ahora\"\r\n            buttonHref=\"/pricing\"\r\n          />\r\n        </div>\r\n      </section>\r\n\r\n      {/* CTA Final */}\r\n      <section className=\"bg-primary py-32 text-center rounded-t-[4rem] relative overflow-hidden\">\r\n        <div className=\"absolute inset-0 bg-black/10 mix-blend-overlay\" />\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          whileInView={{ opacity: 1, y: 0 }}\r\n          viewport={{ once: true }}\r\n          className=\"container relative z-10\"\r\n        >\r\n          <h2 className=\"text-4xl md:text-7xl font-black tracking-tighter mb-12 uppercase italic leading-none\">¬øVAS A SER EL ARQUITECTO<br />O EL QUE ES REEMPLAZADO?</h2>\r\n          <EliteButton href={user ? '/dashboard' : '/login'} variant=\"secondary\" size=\"xl\">\r\n            {user ? 'Ir al Dashboard' : 'Unirse a VERSION Ahora'}\r\n          </EliteButton>\r\n        </motion.div>\r\n      </section>\r\n\r\n      {/* Footer */}\r\n      <footer className=\"container py-12 flex flex-col md:flex-row justify-between items-center gap-8 border-t border-white/[0.04] opacity-50\">\r\n        <div className=\"text-[10px] font-bold uppercase tracking-widest\">¬© {new Date().getFullYear()} VERSION. ‚Äî Tech Rebel Architecture Systems.</div>\r\n        <div className=\"flex gap-8 text-[10px] font-bold uppercase tracking-widest\">\r\n          <a href=\"#\" className=\"hover:text-primary transition-colors\">Instagram</a>\r\n          <a href=\"#\" className=\"hover:text-primary transition-colors\">Twitter (X)</a>\r\n          <a href=\"#\" className=\"hover:text-primary transition-colors\">YouTube</a>\r\n        </div>\r\n      </footer>\r\n    </main>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\pricing\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":29,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useEffect"},"fix":{"range":[34,45],"text":""},"desc":"Remove unused variable \"useEffect\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[562,565],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[562,565],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":49,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1948,1951],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1948,1951],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2237,2240],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2237,2240],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/navigation';\r\nimport { EliteButton } from '@/components/ui/EliteButton';\r\nimport { EliteCard } from '@/components/ui/EliteCard';\r\nimport { EliteBadge } from '@/components/ui/EliteBadge';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { PayPalScriptProvider, PayPalButtons } from \"@paypal/react-paypal-js\";\r\nimport '../globals.css';\r\n\r\nexport default function Pricing() {\r\n    const [selectedPlan, setSelectedPlan] = useState<any>(null);\r\n    const { isAuthenticated, refreshCredits } = useAuth();\r\n    const router = useRouter();\r\n\r\n    const PAYPAL_CLIENT_ID = \"Afc2cT4XrOnJmxiBifQR_EBJjtGVICXJMtvF4zGiZqIaQ8sIy76-7DdCNHVqmbODzv3MTO63SjjMbW_2\";\r\n\r\n    const plans = [\r\n        {\r\n            id: 'starter',\r\n            name: 'Starter Pack',\r\n            price: '25',\r\n            credits: '250',\r\n            description: 'Para probar y crear tus primeros videos virales.',\r\n            features: ['250 Cr√©ditos (~25 Videos Medios)', 'Soporte B√°sico', 'Generador Est√°ndar']\r\n        },\r\n        {\r\n            id: 'creator',\r\n            name: 'Pro Creator',\r\n            price: '49',\r\n            credits: '500',\r\n            description: 'El est√°ndar para creadores de contenido consistentes.',\r\n            features: ['500 Cr√©ditos (~50 Videos Medios)', 'Soporte Prioritario', 'Acceso a Herramientas Beta', 'Sin Marcas de Agua'],\r\n            popular: true\r\n        },\r\n        {\r\n            id: 'agency',\r\n            name: 'Agency Elite',\r\n            price: '99',\r\n            credits: '1000',\r\n            description: 'Poder masivo para agencias y automatizaci√≥n total.',\r\n            features: ['1000 Cr√©ditos (~100 Videos Medios)', 'Soporte VIP 24/7', 'Acceso API (Pr√≥ximamente)', 'Licencia Comercial'],\r\n            popular: false\r\n        }\r\n    ];\r\n\r\n    const handlePurchaseSuccess = (details: any) => {\r\n        refreshCredits();\r\n\r\n        alert(`üéâ ¬°PAGO PROCESADO EXITOSAMENTE! \\n\\nGracias, ${details.payer.name.given_name}. Se han a√±adido ${selectedPlan.credits} tokens a tu cuenta de VERSION.`);\r\n        router.push('/dashboard');\r\n    };\r\n\r\n    const handlePurchase = (plan: any) => {\r\n        if (!isAuthenticated) {\r\n            router.push('/login');\r\n            return;\r\n        }\r\n        setSelectedPlan(plan);\r\n    };\r\n\r\n    return (\r\n        <PayPalScriptProvider options={{ clientId: PAYPAL_CLIENT_ID, currency: \"USD\" }}>\r\n            <div className=\"min-h-screen bg-black text-white selection:bg-primary/30\">\r\n                {/* Navbar */}\r\n                <nav className=\"container flex justify-between items-center py-8 border-b border-white/[0.04]\">\r\n                    <Link href=\"/\" className=\"text-2xl font-black tracking-tighter uppercase\">\r\n                        VERSION<span className=\"text-primary\">.</span>\r\n                    </Link>\r\n                    <div className=\"flex gap-6 items-center\">\r\n                        <Link href=\"/dashboard\" className=\"text-[10px] font-bold uppercase tracking-widest hover:text-primary transition-all\">Panel Control</Link>\r\n                        <Link href=\"/\" className=\"btn-outline !py-2.5 !px-5 !text-[9px]\">Salir</Link>\r\n                    </div>\r\n                </nav>\r\n\r\n                <main className=\"container py-24\">\r\n                    {!selectedPlan ? (\r\n                        <div className=\"animate-fade\">\r\n                            <header className=\"text-center mb-20\">\r\n                                <span className=\"badge mb-4\">Adquisici√≥n de Recursos</span>\r\n                                <h1 className=\"text-5xl md:text-7xl font-black tracking-tighter uppercase mb-6\">RECARGA TU <span className=\"text-primary\">ARSENAL</span></h1>\r\n                                <p className=\"text-zinc-500 max-w-xl mx-auto font-medium\">Selecciona el paquete de tokens que mejor se adapte a tu nivel de producci√≥n digital.</p>\r\n                            </header>\r\n\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto\">\r\n                                {plans.map((plan) => (\r\n                                    <EliteCard\r\n                                        key={plan.id}\r\n                                        variant=\"glass\"\r\n                                        title={plan.name}\r\n                                        subtitle={plan.popular ? \"Recomendado\" : \"Dep√≥sito de Recursos\"}\r\n                                        description={plan.description}\r\n                                        className={plan.popular ? 'border-primary/20 bg-primary/[0.02]' : ''}\r\n                                        headerAction={plan.popular ? <EliteBadge variant=\"primary\">M√°s Popular</EliteBadge> : null}\r\n                                    >\r\n                                        <div className=\"mb-10 mt-2\">\r\n                                            <div className=\"text-6xl font-black mb-2\">${plan.price}<span className=\"text-xs text-zinc-500 font-normal\">.USD</span></div>\r\n                                            <div className=\"text-primary font-bold text-[10px] tracking-[0.3em] uppercase\">{plan.credits} TOKENS</div>\r\n                                        </div>\r\n\r\n                                        <ul className=\"space-y-4 text-xs mb-12 text-left w-full border-t border-white/[0.04] pt-8\">\r\n                                            {plan.features.map((feature, i) => (\r\n                                                <li key={i} className=\"flex items-center gap-3 font-medium text-zinc-400\">\r\n                                                    <span className=\"text-primary font-bold\">‚úì</span> {feature}\r\n                                                </li>\r\n                                            ))}\r\n                                        </ul>\r\n\r\n                                        <EliteButton\r\n                                            variant={plan.popular ? \"primary\" : \"outline\"}\r\n                                            fullWidth\r\n                                            size=\"lg\"\r\n                                            onClick={() => handlePurchase(plan)}\r\n                                        >\r\n                                            Adquirir Arsenal\r\n                                        </EliteButton>\r\n                                    </EliteCard>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"max-w-4xl mx-auto animate-fade\">\r\n                            <button\r\n                                onClick={() => setSelectedPlan(null)}\r\n                                className=\"text-[10px] font-bold uppercase tracking-widest text-zinc-500 hover:text-white mb-12 transition-colors rounded-full px-4 py-2 hover:bg-white/[0.05]\"\r\n                            >\r\n                                ‚Üê Volver a Planes\r\n                            </button>\r\n\r\n                            <div className=\"space-y-6\">\r\n                                {/* Order Summary */}\r\n                                <div className=\"glass-card !p-8 border-primary/20 flex flex-col md:flex-row justify-between items-center gap-8\">\r\n                                    <div>\r\n                                        <div className=\"text-[10px] font-bold text-primary uppercase tracking-widest mb-1\">Orden de Compra</div>\r\n                                        <h2 className=\"text-2xl font-black uppercase tracking-tighter\">{selectedPlan.name} ‚Äî {selectedPlan.credits} TOKENS</h2>\r\n                                    </div>\r\n                                    <div className=\"text-4xl font-black\">${selectedPlan.price} USD</div>\r\n                                </div>\r\n\r\n                                {/* PayPal Integration */}\r\n                                <div className=\"glass-card flex flex-col items-center justify-center py-12 bg-zinc-950/50\">\r\n                                    <div className=\"w-full max-w-md\">\r\n                                        <h3 className=\"text-xs font-bold uppercase tracking-[0.3em] text-zinc-500 mb-10 text-center\">Finalizar Pago Seguro con PayPal</h3>\r\n\r\n                                        <PayPalButtons\r\n                                            style={{\r\n                                                layout: \"vertical\",\r\n                                                color: \"gold\",\r\n                                                shape: \"pill\",\r\n                                                label: \"pay\"\r\n                                            }}\r\n                                            createOrder={(data, actions) => {\r\n                                                return actions.order.create({\r\n                                                    intent: \"CAPTURE\",\r\n                                                    purchase_units: [\r\n                                                        {\r\n                                                            description: `${selectedPlan.name} - VERSION`,\r\n                                                            amount: {\r\n                                                                currency_code: \"USD\",\r\n                                                                value: selectedPlan.price,\r\n                                                            },\r\n                                                        },\r\n                                                    ],\r\n                                                });\r\n                                            }}\r\n                                            onApprove={async (data, actions) => {\r\n                                                if (actions.order) {\r\n                                                    const details = await actions.order.capture();\r\n                                                    handlePurchaseSuccess(details);\r\n                                                }\r\n                                            }}\r\n                                            onError={(err) => {\r\n                                                console.error(\"PayPal Error:\", err);\r\n                                                alert(\"Ocurri√≥ un error con el pago de PayPal. Por favor, intenta de nuevo.\");\r\n                                            }}\r\n                                        />\r\n\r\n                                        <p className=\"text-[8px] text-zinc-600 font-bold uppercase tracking-widest text-center mt-12\">\r\n                                            üîí Transacci√≥n Protegida por la Red Encriptada de PayPal\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </main>\r\n            </div>\r\n        </PayPalScriptProvider>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\seo\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\seo\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\thumbnails\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\thumbnails\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setBgFilters' is assigned a value but never used.","line":43,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":35},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\thumbnails\\page.tsx:51:9\n  49 |     // Inicializar capa por defecto\n  50 |     useEffect(() => {\n> 51 |         setLayers([{\n     |         ^^^^^^^^^ Avoid calling setState() directly within an effect\n  52 |             id: '1',\n  53 |             type: 'text',\n  54 |             content: 'EDICI√ìN PRO',","line":51,"column":9,"nodeType":null,"endLine":51,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":96,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n\"use client\";\r\n\r\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { aiVersionClient } from '../../services/aiVersionClient';\r\nimport Link from 'next/link';\r\nimport { useAuth } from '@/context/AuthContext';\r\n\r\ninterface Layer {\r\n    id: string;\r\n    type: 'text' | 'image';\r\n    content: string; // Texto o DataURL de imagen\r\n    x: number;\r\n    y: number;\r\n    fontSize: number;    // Solo para texto\r\n    width: number;       // Para im√°genes\r\n    height: number;      // Para im√°genes\r\n    color: string;\r\n    strokeColor: string;\r\n    strokeWidth: number;\r\n    fontFamily: string;\r\n    visible: boolean;\r\n    imageElement?: HTMLImageElement;\r\n    // Nuevas propiedades\r\n    opacity: number;\r\n    rotation: number;\r\n    brightness: number;\r\n    contrast: number;\r\n    saturation: number;\r\n    blur: number;\r\n}\r\n\r\nconst VIRAL_FONTS = [\r\n    'Inter', 'Bebas Neue', 'Luckiest Guy', 'Montserrat', 'Roboto', 'Anton'\r\n];\r\n\r\nexport default function ThumbnailPage() {\r\n    const { user, deductCredits, refreshCredits } = useAuth();\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const [layers, setLayers] = useState<Layer[]>([]);\r\n    const [selectedLayerId, setSelectedLayerId] = useState<string | null>(null);\r\n    const [backgroundImage, setBackgroundImage] = useState<HTMLImageElement | null>(null);\r\n    const [bgFilters, setBgFilters] = useState({ blur: 0, brightness: 100, contrast: 100 });\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\r\n    const [feedback, setFeedback] = useState('');\r\n    const [loadingAnalysis, setLoadingAnalysis] = useState(false);\r\n\r\n    // Inicializar capa por defecto\r\n    useEffect(() => {\r\n        setLayers([{\r\n            id: '1',\r\n            type: 'text',\r\n            content: 'EDICI√ìN PRO',\r\n            x: 640,\r\n            y: 360,\r\n            fontSize: 150,\r\n            width: 0, height: 0,\r\n            color: '#ffffff',\r\n            strokeColor: '#000000',\r\n            strokeWidth: 20,\r\n            fontFamily: 'Inter',\r\n            visible: true,\r\n            opacity: 1,\r\n            rotation: 0,\r\n            brightness: 100,\r\n            contrast: 100,\r\n            saturation: 100,\r\n            blur: 0\r\n        }]);\r\n        setSelectedLayerId('1');\r\n    }, []);\r\n\r\n    // Cargar fondo por defecto\r\n    useEffect(() => {\r\n        const img = new Image();\r\n        img.src = 'https://images.unsplash.com/photo-1614850523459-c2f4c699c52e?q=80&w=1280&h=720&auto=format&fit=crop';\r\n        img.crossOrigin = \"anonymous\";\r\n        img.onload = () => setBackgroundImage(img);\r\n    }, []);\r\n\r\n    const draw = useCallback(() => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) return;\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx) return;\r\n\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n        // Dibujar Fondo\r\n        ctx.save();\r\n        if (backgroundImage) {\r\n            ctx.filter = `blur(${bgFilters.blur}px) brightness(${bgFilters.brightness}%) contrast(${bgFilters.contrast}%)`;\r\n            try {\r\n                ctx.drawImage(backgroundImage, 0, 0, canvas.width, canvas.height);\r\n            } catch (e) {\r\n                // Fallback si hay error de cross-origin\r\n                ctx.fillStyle = '#111';\r\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n            }\r\n        } else {\r\n            ctx.fillStyle = '#0a0a0a';\r\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n        }\r\n        ctx.restore();\r\n\r\n        layers.forEach(layer => {\r\n            if (!layer.visible) return;\r\n\r\n            ctx.save();\r\n            ctx.globalAlpha = layer.opacity;\r\n            ctx.filter = `brightness(${layer.brightness}%) contrast(${layer.contrast}%) saturate(${layer.saturation}%) blur(${layer.blur}px)`;\r\n\r\n            ctx.translate(layer.x, layer.y);\r\n            ctx.rotate((layer.rotation * Math.PI) / 180);\r\n\r\n            if (layer.type === 'text') {\r\n                ctx.font = `bold ${layer.fontSize}px '${layer.fontFamily}', sans-serif`;\r\n                ctx.textAlign = 'center';\r\n                ctx.textBaseline = 'middle';\r\n\r\n                ctx.shadowColor = 'rgba(0,0,0,0.8)';\r\n                ctx.shadowBlur = 20;\r\n                ctx.shadowOffsetX = 8;\r\n                ctx.shadowOffsetY = 8;\r\n\r\n                ctx.strokeStyle = layer.strokeColor;\r\n                ctx.lineWidth = layer.strokeWidth;\r\n                ctx.lineJoin = 'round';\r\n                ctx.strokeText(layer.content, 0, 0);\r\n\r\n                ctx.fillStyle = layer.color;\r\n                ctx.fillText(layer.content, 0, 0);\r\n\r\n                if (selectedLayerId === layer.id) {\r\n                    ctx.shadowBlur = 0;\r\n                    ctx.strokeStyle = '#22c55e'; // Green 500\r\n                    ctx.lineWidth = 3;\r\n                    const metrics = ctx.measureText(layer.content);\r\n                    ctx.strokeRect(-metrics.width / 2 - 15, -layer.fontSize / 2 - 15, metrics.width + 30, layer.fontSize + 30);\r\n                }\r\n            } else if (layer.type === 'image' && layer.imageElement) {\r\n                ctx.shadowColor = 'rgba(0,0,0,0.5)';\r\n                ctx.shadowBlur = 15;\r\n                ctx.shadowOffsetX = 5;\r\n                ctx.shadowOffsetY = 5;\r\n\r\n                ctx.drawImage(layer.imageElement, -layer.width / 2, -layer.height / 2, layer.width, layer.height);\r\n\r\n                if (selectedLayerId === layer.id) {\r\n                    ctx.shadowBlur = 0;\r\n                    ctx.strokeStyle = '#22c55e';\r\n                    ctx.lineWidth = 3;\r\n                    ctx.strokeRect(-layer.width / 2 - 5, -layer.height / 2 - 5, layer.width + 10, layer.height + 10);\r\n                }\r\n            }\r\n            ctx.restore();\r\n        });\r\n\r\n    }, [layers, backgroundImage, selectedLayerId, bgFilters]);\r\n\r\n    useEffect(() => {\r\n        draw();\r\n    }, [draw]);\r\n\r\n    const handleMouseDown = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) return;\r\n        const rect = canvas.getBoundingClientRect();\r\n        const scaleX = canvas.width / rect.width;\r\n        const scaleY = canvas.height / rect.height;\r\n        const x = (e.clientX - rect.left) * scaleX;\r\n        const y = (e.clientY - rect.top) * scaleY;\r\n\r\n        const clickedLayer = [...layers].reverse().find(layer => {\r\n            if (layer.type === 'text') {\r\n                const ctx = canvas.getContext('2d');\r\n                if (!ctx) return false;\r\n                ctx.font = `bold ${layer.fontSize}px ${layer.fontFamily}`;\r\n                const metrics = ctx.measureText(layer.content);\r\n                const w = metrics.width;\r\n                const h = layer.fontSize;\r\n                return x >= layer.x - w / 2 && x <= layer.x + w / 2 && y >= layer.y - h / 2 && y <= layer.y + h / 2;\r\n            } else if (layer.type === 'image') {\r\n                return x >= layer.x - layer.width / 2 && x <= layer.x + layer.width / 2 &&\r\n                    y >= layer.y - layer.height / 2 && y <= layer.y + layer.height / 2;\r\n            }\r\n            return false;\r\n        });\r\n\r\n        if (clickedLayer) {\r\n            setSelectedLayerId(clickedLayer.id);\r\n            setIsDragging(true);\r\n            setDragOffset({ x: x - clickedLayer.x, y: y - clickedLayer.y });\r\n        } else {\r\n            setSelectedLayerId(null);\r\n        }\r\n    };\r\n\r\n    const handleMouseMove = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n        if (!isDragging || !selectedLayerId) return;\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) return;\r\n        const rect = canvas.getBoundingClientRect();\r\n        const scaleX = canvas.width / rect.width;\r\n        const scaleY = canvas.height / rect.height;\r\n        const x = (e.clientX - rect.left) * scaleX;\r\n        const y = (e.clientY - rect.top) * scaleY;\r\n\r\n        setLayers(prev => prev.map(l =>\r\n            l.id === selectedLayerId ? { ...l, x: x - dragOffset.x, y: y - dragOffset.y } : l\r\n        ));\r\n    };\r\n\r\n    const handleMouseUp = () => setIsDragging(false);\r\n\r\n    // Atajos de Teclado\r\n    useEffect(() => {\r\n        const handleKeyDown = (e: KeyboardEvent) => {\r\n            if (['INPUT', 'TEXTAREA', 'SELECT'].includes(document.activeElement?.tagName || '')) return;\r\n\r\n            if (e.key === 'Delete' || e.key === 'Backspace') {\r\n                if (selectedLayerId) {\r\n                    setLayers(prev => prev.filter(l => l.id !== selectedLayerId));\r\n                    setSelectedLayerId(null);\r\n                }\r\n            }\r\n            if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {\r\n                if (selectedLayerId) {\r\n                    e.preventDefault();\r\n                    const step = e.shiftKey ? 10 : 1;\r\n                    setLayers(prev => prev.map(l => {\r\n                        if (l.id === selectedLayerId) {\r\n                            if (e.key === 'ArrowUp') return { ...l, y: l.y - step };\r\n                            if (e.key === 'ArrowDown') return { ...l, y: l.y + step };\r\n                            if (e.key === 'ArrowLeft') return { ...l, x: l.x - step };\r\n                            if (e.key === 'ArrowRight') return { ...l, x: l.x + step };\r\n                        }\r\n                        return l;\r\n                    }));\r\n                }\r\n            }\r\n        };\r\n        window.addEventListener('keydown', handleKeyDown);\r\n        return () => window.removeEventListener('keydown', handleKeyDown);\r\n    }, [selectedLayerId]);\r\n\r\n    const addTextLayer = () => {\r\n        const id = Date.now().toString();\r\n        setLayers([...layers, {\r\n            id, type: 'text', content: 'TEXTO', x: 640, y: 360, fontSize: 100, width: 0, height: 0,\r\n            color: '#ffffff', strokeColor: '#000000', strokeWidth: 10, fontFamily: 'Inter', visible: true,\r\n            opacity: 1, rotation: 0, brightness: 100, contrast: 100, saturation: 100, blur: 0\r\n        }]);\r\n        setSelectedLayerId(id);\r\n    };\r\n\r\n    const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n        if (file.size > 5 * 1024 * 1024) {\r\n            alert(\"‚ö†Ô∏è La imagen es demasiado grande. El tama√±o m√°ximo permitido es 5MB.\");\r\n            return;\r\n        }\r\n        const reader = new FileReader();\r\n        reader.onload = (event) => {\r\n            const img = new Image();\r\n            img.onload = () => {\r\n                const id = Date.now().toString();\r\n                const ratio = Math.min(400 / img.width, 400 / img.height, 1);\r\n                setLayers(prev => [...prev, {\r\n                    id, type: 'image', content: '', x: 640, y: 360, fontSize: 0,\r\n                    width: img.width * ratio, height: img.height * ratio,\r\n                    color: '', strokeColor: '', strokeWidth: 0, fontFamily: 'Inter', visible: true,\r\n                    imageElement: img,\r\n                    opacity: 1, rotation: 0, brightness: 100, contrast: 100, saturation: 100, blur: 0\r\n                }]);\r\n                setSelectedLayerId(id);\r\n            };\r\n            img.src = event.target?.result as string;\r\n        };\r\n        reader.readAsDataURL(file);\r\n    };\r\n\r\n    const handleBackgroundUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n        if (file.size > 5 * 1024 * 1024) {\r\n            alert(\"‚ö†Ô∏è La imagen es demasiado grande. El tama√±o m√°ximo permitido es 5MB.\");\r\n            return;\r\n        }\r\n        const reader = new FileReader();\r\n        reader.onload = (event) => {\r\n            const img = new Image();\r\n            img.onload = () => setBackgroundImage(img);\r\n            img.src = event.target?.result as string;\r\n        };\r\n        reader.readAsDataURL(file);\r\n    };\r\n\r\n    const updateLayerProperty = <K extends keyof Layer>(id: string, property: K, value: Layer[K]) => {\r\n        setLayers(prev => prev.map(l => l.id === id ? { ...l, [property]: value } : l));\r\n    };\r\n\r\n    const removeBackground = async () => {\r\n        if (!selectedLayerId) return;\r\n        const COST = 20;\r\n\r\n        if (!user || user.credits < COST) {\r\n            alert(`‚ùå Saldo insuficiente. Necesitas ${COST} tokens.`);\r\n            return;\r\n        }\r\n\r\n        const layer = layers.find(l => l.id === selectedLayerId);\r\n        if (!layer || layer.type !== 'image' || !layer.imageElement) return;\r\n\r\n        setLoadingAnalysis(true);\r\n        const response = await aiVersionClient.removeBackground(layer.imageElement.src);\r\n\r\n        if (response.success && response.image) {\r\n            deductCredits(COST);\r\n            const img = new Image();\r\n            img.onload = () => {\r\n                setLayers(prev => prev.map(l =>\r\n                    l.id === selectedLayerId ? { ...l, imageElement: img } : l\r\n                ));\r\n                setLoadingAnalysis(false);\r\n                refreshCredits();\r\n            };\r\n            img.src = response.image;\r\n        } else {\r\n            alert(\"Error: \" + (response.error || \"Fallo desconocido\"));\r\n            setLoadingAnalysis(false);\r\n            refreshCredits();\r\n        }\r\n    };\r\n\r\n    const analyzeThumbnail = async () => {\r\n        const COST = 10;\r\n        if (!user || user.credits < COST) {\r\n            setFeedback(`‚ùå Saldo insuficiente. Necesitas ${COST} tokens.`);\r\n            return;\r\n        }\r\n\r\n        setLoadingAnalysis(true);\r\n        const desc = layers.map(l => `${l.type}: ${l.content || 'imagen'}`).join(', ');\r\n        const response = await aiVersionClient.analyzeThumbnail(desc);\r\n\r\n        if (response.success && response.result) {\r\n            deductCredits(COST);\r\n            setFeedback(response.result);\r\n            refreshCredits();\r\n        } else {\r\n            setFeedback(\"Error al analizar.\");\r\n            refreshCredits();\r\n        }\r\n        setLoadingAnalysis(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-black text-white p-6 pb-20\">\r\n            {/* Google Fonts Pre-load */}\r\n            <style dangerouslySetInnerHTML={{\r\n                __html: `\r\n                @import url('https://fonts.googleapis.com/css2?family=Anton&family=Bebas+Neue&family=Luckiest+Guy&family=Montserrat:wght@900&family=Roboto:wght@900&display=swap');\r\n            `}} />\r\n\r\n            <Link href=\"/dashboard\" className=\"text-zinc-500 hover:text-white mb-6 block text-xs font-bold tracking-widest uppercase\">‚Üê Volver al Dashboard</Link>\r\n\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <h1 className=\"text-3xl font-black uppercase tracking-tighter\">\r\n                    VERSION <span className=\"text-purple-500\">THUMBNAILS</span>\r\n                </h1>\r\n                <div className=\"flex gap-2\">\r\n                    <button onClick={addTextLayer} className=\"bg-zinc-800 hover:bg-zinc-700 text-white text-xs font-bold py-2 px-4 rounded-lg uppercase tracking-wider transition-colors\">\r\n                        + Texto\r\n                    </button>\r\n                    <label className=\"bg-zinc-800 hover:bg-zinc-700 text-white text-xs font-bold py-2 px-4 rounded-lg uppercase tracking-wider transition-colors cursor-pointer\">\r\n                        + Imagen\r\n                        <input type=\"file\" hidden onChange={handleImageUpload} accept=\"image/*\" />\r\n                    </label>\r\n                    <label className=\"bg-zinc-800 hover:bg-zinc-700 text-white text-xs font-bold py-2 px-4 rounded-lg uppercase tracking-wider transition-colors cursor-pointer\">\r\n                        üñºÔ∏è Fondo\r\n                        <input type=\"file\" hidden onChange={handleBackgroundUpload} accept=\"image/*\" />\r\n                    </label>\r\n                    <button\r\n                        onClick={() => selectedLayerId && setLayers(prev => prev.filter(l => l.id !== selectedLayerId))}\r\n                        disabled={!selectedLayerId}\r\n                        className=\"bg-red-500/10 text-red-500 hover:bg-red-500/20 disabled:opacity-50 text-xs font-bold py-2 px-4 rounded-lg uppercase tracking-wider transition-colors\"\r\n                    >\r\n                        Eliminar\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-6 h-[75vh]\">\r\n                {/* Canvas Area */}\r\n                <div className=\"flex-1 bg-zinc-900/50 rounded-2xl border border-white/5 overflow-hidden flex items-center justify-center relative shadow-2xl\">\r\n                    <div className=\"border border-white/10 shadow-xl w-full max-w-[80%] aspect-video\">\r\n                        <canvas\r\n                            ref={canvasRef}\r\n                            width={1280}\r\n                            height={720}\r\n                            className={`w-full h-full ${isDragging ? 'cursor-grabbing' : 'cursor-crosshair'}`}\r\n                            onMouseDown={handleMouseDown}\r\n                            onMouseMove={handleMouseMove}\r\n                            onMouseUp={handleMouseUp}\r\n                            onMouseLeave={handleMouseUp}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Sidebar Controls */}\r\n                <div className=\"w-[320px] bg-zinc-950 border border-white/5 rounded-2xl p-6 flex flex-col gap-6 overflow-y-auto\">\r\n                    {selectedLayerId ? (() => {\r\n                        const layer = layers.find(l => l.id === selectedLayerId);\r\n                        if (!layer) return null;\r\n                        return (\r\n                            <>\r\n                                <div className=\"flex justify-between items-center\">\r\n                                    <h3 className=\"text-xs font-bold uppercase tracking-widest text-zinc-500\">Propiedades</h3>\r\n                                    <div className=\"flex gap-1\">\r\n                                        <button onClick={() => {\r\n                                            const l = layers.find(x => x.id === selectedLayerId);\r\n                                            if (l) setLayers([...layers.filter(x => x.id !== selectedLayerId), l]);\r\n                                        }} className=\"text-[10px] bg-zinc-800 p-1 rounded hover:bg-zinc-700\">‚¨ÜÔ∏è</button>\r\n                                        <button onClick={() => {\r\n                                            const l = layers.find(x => x.id === selectedLayerId);\r\n                                            if (l) setLayers([l, ...layers.filter(x => x.id !== selectedLayerId)]);\r\n                                        }} className=\"text-[10px] bg-zinc-800 p-1 rounded hover:bg-zinc-700\">‚¨áÔ∏è</button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {layer.type === 'image' && (\r\n                                    <button\r\n                                        onClick={removeBackground}\r\n                                        disabled={loadingAnalysis}\r\n                                        className=\"w-full py-2 bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 border border-blue-600/30 rounded-lg text-xs font-bold uppercase tracking-widest transition-colors flex items-center justify-center gap-2\"\r\n                                    >\r\n                                        {loadingAnalysis ? 'Procesando...' : '‚ú® Borrar Fondo AI'}\r\n                                    </button>\r\n                                )}\r\n\r\n                                <div className=\"space-y-4\">\r\n                                    {layer.type === 'text' && (\r\n                                        <>\r\n                                            <div className=\"space-y-1\">\r\n                                                <label className=\"text-[10px] uppercase font-bold text-zinc-600\">Contenido</label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    value={layer.content}\r\n                                                    onChange={(e) => updateLayerProperty(layer.id, 'content', e.target.value)}\r\n                                                    className=\"w-full bg-black border border-white/10 p-2 rounded text-xs text-white\"\r\n                                                />\r\n                                            </div>\r\n                                            <div className=\"space-y-1\">\r\n                                                <label className=\"text-[10px] uppercase font-bold text-zinc-600\">Fuente</label>\r\n                                                <select\r\n                                                    value={layer.fontFamily}\r\n                                                    onChange={(e) => updateLayerProperty(layer.id, 'fontFamily', e.target.value)}\r\n                                                    className=\"w-full bg-black border border-white/10 p-2 rounded text-xs text-white\"\r\n                                                >\r\n                                                    {VIRAL_FONTS.map(f => <option key={f} value={f}>{f}</option>)}\r\n                                                </select>\r\n                                            </div>\r\n                                            <div className=\"space-y-1\">\r\n                                                <label className=\"text-[10px] uppercase font-bold text-zinc-600\">Color</label>\r\n                                                <div className=\"flex gap-2\">\r\n                                                    <input type=\"color\" value={layer.color} onChange={(e) => updateLayerProperty(layer.id, 'color', e.target.value)} className=\"h-8 w-full bg-transparent cursor-pointer\" />\r\n                                                </div>\r\n                                            </div>\r\n                                        </>\r\n                                    )}\r\n\r\n                                    <div className=\"space-y-1\">\r\n                                        <label className=\"text-[10px] uppercase font-bold text-zinc-600 flex justify-between\">\r\n                                            <span>Tama√±o</span> <span>{layer.type === 'text' ? layer.fontSize : Math.round(layer.width)}</span>\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"range\"\r\n                                            min=\"10\"\r\n                                            max={layer.type === 'text' ? \"400\" : \"1500\"}\r\n                                            value={layer.type === 'text' ? layer.fontSize : layer.width}\r\n                                            onChange={(e) => {\r\n                                                const val = parseInt(e.target.value);\r\n                                                if (layer.type === 'text') {\r\n                                                    updateLayerProperty(layer.id, 'fontSize', val);\r\n                                                } else if (layer.imageElement) {\r\n                                                    const aspect = layer.imageElement.height / layer.imageElement.width;\r\n                                                    setLayers(layers.map(l => l.id === selectedLayerId ? { ...l, width: val, height: val * aspect } : l));\r\n                                                }\r\n                                            }}\r\n                                            className=\"w-full accent-white h-1 bg-zinc-800 rounded-lg appearance-none cursor-pointer\"\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div className=\"space-y-1\">\r\n                                        <label className=\"text-[10px] uppercase font-bold text-zinc-600 flex justify-between\">\r\n                                            <span>Rotaci√≥n</span> <span>{layer.rotation}¬∞</span>\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"range\" min=\"-180\" max=\"180\"\r\n                                            value={layer.rotation}\r\n                                            onChange={(e) => updateLayerProperty(layer.id, 'rotation', parseInt(e.target.value))}\r\n                                            className=\"w-full accent-white h-1 bg-zinc-800 rounded-lg appearance-none cursor-pointer\"\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div className=\"space-y-1\">\r\n                                        <label className=\"text-[10px] uppercase font-bold text-zinc-600 flex justify-between\">\r\n                                            <span>Opacidad</span> <span>{Math.round(layer.opacity * 100)}%</span>\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"range\" min=\"0\" max=\"1\" step=\"0.01\"\r\n                                            value={layer.opacity}\r\n                                            onChange={(e) => updateLayerProperty(layer.id, 'opacity', parseFloat(e.target.value))}\r\n                                            className=\"w-full accent-white h-1 bg-zinc-800 rounded-lg appearance-none cursor-pointer\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </>\r\n                        );\r\n                    })() : (\r\n                        <div className=\"text-center text-zinc-600 text-xs py-10\">\r\n                            Selecciona un elemento para editar\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"border-t border-white/10 pt-6 mt-auto\">\r\n                        <button\r\n                            onClick={analyzeThumbnail}\r\n                            disabled={loadingAnalysis}\r\n                            className=\"w-full py-3 bg-purple-600/10 text-purple-400 hover:bg-purple-600/20 border border-purple-600/30 rounded-xl text-xs font-black uppercase tracking-widest transition-all mb-3 flex items-center justify-center gap-2\"\r\n                        >\r\n                            {loadingAnalysis ? 'Analizando...' : 'üëÅÔ∏è Analizar CTR (IA)'}\r\n                        </button>\r\n                        <button\r\n                            onClick={() => {\r\n                                const canvas = canvasRef.current;\r\n                                if (!canvas) return;\r\n                                const link = document.createElement('a');\r\n                                link.download = 'version-thumb.png';\r\n                                link.href = canvas.toDataURL();\r\n                                link.click();\r\n                            }}\r\n                            className=\"w-full py-3 bg-white text-black hover:bg-zinc-200 rounded-xl text-xs font-black uppercase tracking-widest transition-all\"\r\n                        >\r\n                            Descargar PNG\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {feedback && (\r\n                <div className=\"mt-8 animate-fade-in-up\">\r\n                    <div className=\"bg-zinc-950 p-6 rounded-2xl border-l-4 border-purple-500\">\r\n                        <h4 className=\"text-sm font-bold text-white mb-2 uppercase tracking-widest\">Feedback Estrat√©gico</h4>\r\n                        <p className=\"text-zinc-400 text-xs leading-relaxed whitespace-pre-wrap\">{feedback}</p>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\tools\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\tools\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":25,"column":38,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[1311,1508],"text":"\r\n                        Genera guiones profundos y estructurados con la metodolog√≠a de retenci√≥n de VERSION.\r\n                        Soporta modo &quot;Mega\" para videos largos.\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[1311,1508],"text":"\r\n                        Genera guiones profundos y estructurados con la metodolog√≠a de retenci√≥n de VERSION.\r\n                        Soporta modo &ldquo;Mega\" para videos largos.\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[1311,1508],"text":"\r\n                        Genera guiones profundos y estructurados con la metodolog√≠a de retenci√≥n de VERSION.\r\n                        Soporta modo &#34;Mega\" para videos largos.\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[1311,1508],"text":"\r\n                        Genera guiones profundos y estructurados con la metodolog√≠a de retenci√≥n de VERSION.\r\n                        Soporta modo &rdquo;Mega\" para videos largos.\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":25,"column":43,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[1311,1508],"text":"\r\n                        Genera guiones profundos y estructurados con la metodolog√≠a de retenci√≥n de VERSION.\r\n                        Soporta modo \"Mega&quot; para videos largos.\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[1311,1508],"text":"\r\n                        Genera guiones profundos y estructurados con la metodolog√≠a de retenci√≥n de VERSION.\r\n                        Soporta modo \"Mega&ldquo; para videos largos.\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[1311,1508],"text":"\r\n                        Genera guiones profundos y estructurados con la metodolog√≠a de retenci√≥n de VERSION.\r\n                        Soporta modo \"Mega&#34; para videos largos.\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[1311,1508],"text":"\r\n                        Genera guiones profundos y estructurados con la metodolog√≠a de retenci√≥n de VERSION.\r\n                        Soporta modo \"Mega&rdquo; para videos largos.\r\n                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport Link from \"next/link\";\r\n\r\nexport default function ToolsPage() {\r\n    return (\r\n        <div className=\"flex flex-col items-center justify-center min-h-[60vh] text-center\">\r\n            <h1 className=\"text-4xl md:text-6xl font-bold tracking-tighter mb-6\">\r\n                Herramientas de <span className=\"text-red-500\">Alta Potencia</span>\r\n            </h1>\r\n            <p className=\"text-gray-400 max-w-2xl text-lg mb-12\">\r\n                Accede a la suite de utilidades exclusivas de VERSION para maximizar tu alcance viral.\r\n            </p>\r\n\r\n            <div className=\"grid md:grid-cols-2 gap-6 w-full max-w-4xl\">\r\n                <Link\r\n                    href=\"/tools/script-generator\"\r\n                    className=\"group relative bg-[#111] border border-white/10 p-8 rounded-2xl hover:border-red-500/50 transition-all duration-300 hover:bg-[#151515]\"\r\n                >\r\n                    <div className=\"absolute top-4 right-4 text-xs font-bold bg-red-500/10 text-red-500 px-2 py-1 rounded-full border border-red-500/20\">\r\n                        POPULAR\r\n                    </div>\r\n                    <h2 className=\"text-2xl font-bold mb-2 group-hover:text-red-500 transition-colors\">Guionista AI 2.0</h2>\r\n                    <p className=\"text-gray-400 text-sm leading-relaxed\">\r\n                        Genera guiones profundos y estructurados con la metodolog√≠a de retenci√≥n de VERSION.\r\n                        Soporta modo \"Mega\" para videos largos.\r\n                    </p>\r\n                </Link>\r\n\r\n                <Link\r\n                    href=\"/tools/seo-assistant\"\r\n                    className=\"group bg-[#111] border border-white/10 p-8 rounded-2xl hover:border-green-500/50 transition-all duration-300 hover:bg-[#151515]\"\r\n                >\r\n                    <h2 className=\"text-2xl font-bold mb-2 group-hover:text-green-500 transition-colors\">SEO Viral</h2>\r\n                    <p className=\"text-gray-400 text-sm leading-relaxed\">\r\n                        Optimiza t√≠tulos, etiquetas y descripciones para dominar el algoritmo de b√∫squeda.\r\n                    </p>\r\n                </Link>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\tools\\script-generator\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\tools\\seo-assistant\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\writer\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\app\\writer\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EliteButton' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":21,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"EliteButton"},"fix":{"range":[274,334],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'refreshCredits'. Either include it or remove the dependency array.","line":55,"column":8,"nodeType":"ArrayExpression","endLine":55,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [taskId, loading, refreshCredits]","fix":{"range":[2339,2356],"text":"[taskId, loading, refreshCredits]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { aiVersionClient } from '../../services/aiVersionClient';\r\nimport Link from 'next/link';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { EliteCard } from '@/components/ui/EliteCard';\r\nimport { EliteButton } from '@/components/ui/EliteButton';\r\n\r\nexport default function WriterPage() {\r\n    const { user, deductCredits, refreshCredits } = useAuth();\r\n    const [topic, setTopic] = useState('');\r\n    const [tone, setTone] = useState('educativo');\r\n    const [script, setScript] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const [isMegaMode, setIsMegaMode] = useState(false);\r\n    const [progress, setProgress] = useState(0);\r\n    const [status, setStatus] = useState('');\r\n    const [taskId, setTaskId] = useState<string | null>(null);\r\n\r\n    // Efecto para polling de estado\r\n    useEffect(() => {\r\n        let intervalId: NodeJS.Timeout;\r\n\r\n        if (taskId && loading) {\r\n            intervalId = setInterval(async () => {\r\n                const taskStatus = await aiVersionClient.getTaskStatus(taskId);\r\n\r\n                if (taskStatus) {\r\n                    setProgress(taskStatus.progress);\r\n                    setStatus(taskStatus.message);\r\n\r\n                    // Actualizar script parcial si existe (para efecto streaming visual)\r\n                    if (taskStatus.result && taskStatus.result.script) {\r\n                        setScript(taskStatus.result.script);\r\n                    }\r\n\r\n                    if (taskStatus.status === 'completed') {\r\n                        setLoading(false);\r\n                        setTaskId(null);\r\n                        setStatus('‚úÖ Guion completado con √©xito.');\r\n                        if (taskStatus.result?.script) setScript(taskStatus.result.script);\r\n                        refreshCredits();\r\n                    } else if (taskStatus.status === 'failed' || taskStatus.status === 'cancelled') {\r\n                        setLoading(false);\r\n                        setTaskId(null);\r\n                        setStatus(`‚ùå Error: ${taskStatus.message}`);\r\n                        refreshCredits();\r\n                    }\r\n                }\r\n            }, 2000); // Poll cada 2 segundos\r\n        }\r\n\r\n        return () => clearInterval(intervalId);\r\n    }, [taskId, loading]);\r\n\r\n    const COST = 50;\r\n\r\n    const handleGenerate = async () => {\r\n        if (!topic) return;\r\n\r\n        if (!user || user.credits < COST) {\r\n            setStatus(`‚ùå Saldo insuficiente. Necesitas ${COST} tokens.`);\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        setScript('');\r\n        setProgress(0);\r\n        setStatus('Debitando tokens e iniciando sistema...');\r\n\r\n        const response = await aiVersionClient.startScriptGeneration(topic, tone, isMegaMode);\r\n\r\n        if (response.success && response.task_id) {\r\n            deductCredits(COST); // Optimistic UI update\r\n            setTaskId(response.task_id);\r\n            setStatus(response.message || 'Encolado...');\r\n        } else {\r\n            setLoading(false);\r\n            setStatus(`‚ùå Error: ${response.message || response.error}`);\r\n            refreshCredits();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-black text-white p-8 md:p-12\">\r\n            <Link href=\"/dashboard\" className=\"text-zinc-500 hover:text-white mb-8 block text-xs font-bold tracking-widest uppercase\">‚Üê Volver al Dashboard</Link>\r\n\r\n            <div className=\"max-w-4xl mx-auto\">\r\n                <div className=\"text-center mb-10\">\r\n                    <h1 className=\"text-5xl font-black mb-2 tracking-tighter uppercase\">\r\n                        VERSION <span className=\"text-red-600\">WRITER</span>\r\n                    </h1>\r\n                    <p className=\"text-zinc-500 text-sm font-medium uppercase tracking-widest\">\r\n                        Arquitectura de Guiones Virales\r\n                    </p>\r\n                </div>\r\n\r\n                <EliteCard variant=\"glass\" glowColor=\"var(--color-writer)\" className=\"mb-8 p-8\">\r\n                    <div className=\"grid gap-6\">\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-red-600 uppercase mb-2 block tracking-widest\">\r\n                                Concepto Central o Link\r\n                            </label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={topic}\r\n                                onChange={(e) => setTopic(e.target.value)}\r\n                                placeholder=\"Ej: La ca√≠da del Imperio Romano en 2026...\"\r\n                                className=\"w-full p-5 bg-black/40 border border-white/10 rounded-xl text-white focus:outline-none focus:border-red-600/50 transition-colors placeholder:text-zinc-700\"\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-zinc-500 uppercase mb-2 block tracking-widest\">\r\n                                    Tono de Comunicaci√≥n\r\n                                </label>\r\n                                <select\r\n                                    value={tone}\r\n                                    onChange={(e) => setTone(e.target.value)}\r\n                                    className=\"w-full p-5 bg-black/40 border border-white/10 rounded-xl text-white focus:outline-none focus:border-white/20 transition-colors appearance-none cursor-pointer\"\r\n                                >\r\n                                    <option value=\"educativo\">üéì Educativo / Documental</option>\r\n                                    <option value=\"humor√≠stico\">üòÇ Humor√≠stico / S√°tira</option>\r\n                                    <option value=\"estoico/firme\">üóø Estoico / Firme</option>\r\n                                    <option value=\"corporativo\">üíº Profesional / Tech</option>\r\n                                    <option value=\"agresivo/clickbait\">üî• Agresivo / Viral</option>\r\n                                </select>\r\n                            </div>\r\n\r\n                            <div\r\n                                onClick={() => setIsMegaMode(!isMegaMode)}\r\n                                className={`\r\n                                    p-5 border rounded-xl cursor-pointer flex items-center justify-between transition-all duration-300\r\n                                    ${isMegaMode\r\n                                        ? 'bg-red-600/10 border-red-600'\r\n                                        : 'bg-black/40 border-white/10 hover:border-white/20'}\r\n                                `}\r\n                            >\r\n                                <div>\r\n                                    <span className={`text-xs font-bold block mb-1 tracking-widest uppercase ${isMegaMode ? 'text-red-500' : 'text-zinc-500'}`}>\r\n                                        Modo Mega Deep\r\n                                    </span>\r\n                                    <span className={`text-[10px] ${isMegaMode ? 'text-red-400' : 'text-zinc-600'}`}>\r\n                                        An√°lisis profundo (20+ min)\r\n                                    </span>\r\n                                </div>\r\n                                <div className={`w-10 h-5 rounded-full relative transition-colors ${isMegaMode ? 'bg-red-600' : 'bg-zinc-800'}`}>\r\n                                    <div className={`absolute top-[2px] w-4 h-4 bg-white rounded-full transition-all duration-200 ${isMegaMode ? 'right-[2px]' : 'left-[2px]'}`} />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </EliteCard>\r\n\r\n                <button\r\n                    onClick={handleGenerate}\r\n                    disabled={loading}\r\n                    className={`\r\n                        w-full p-6 rounded-xl font-black text-lg tracking-[0.2em] uppercase transition-all duration-300 shadow-2xl\r\n                        ${loading\r\n                            ? 'bg-zinc-900 text-zinc-600 cursor-not-allowed border border-white/5'\r\n                            : 'bg-white text-black hover:bg-red-600 hover:text-white'}\r\n                    `}\r\n                >\r\n                    {loading ? 'Procesando Datos...' : 'Ejecutar Protocolo de Escritura'}\r\n                </button>\r\n\r\n                {loading && (\r\n                    <div className=\"mt-12 animate-fade-in-up\">\r\n                        <div className=\"flex justify-between mb-3\">\r\n                            <span className=\"text-[10px] font-bold text-red-500 uppercase tracking-widest animate-pulse\">{status}</span>\r\n                            <span className=\"text-[10px] font-bold text-zinc-500 tabular-nums\">{Math.round(progress)}%</span>\r\n                        </div>\r\n                        <div className=\"h-1 bg-zinc-900 rounded-full overflow-hidden\">\r\n                            <div\r\n                                className=\"h-full bg-red-600 transition-all duration-500 ease-out shadow-[0_0_20px_rgba(220,38,38,0.8)]\"\r\n                                style={{ width: `${progress}%` }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {script && (\r\n                    <div className=\"mt-12 animate-fade-in-up\">\r\n                        <div className=\"flex justify-between items-center mb-6\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\r\n                                <h3 className=\"text-xs font-bold text-zinc-500 uppercase tracking-widest\">Output Generado</h3>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => navigator.clipboard.writeText(script)}\r\n                                className=\"text-[10px] bg-white/5 hover:bg-white/10 border border-white/10 text-zinc-400 px-4 py-2 rounded-lg hover:text-white transition-all font-bold uppercase tracking-widest\"\r\n                            >\r\n                                Copiar al Portapapeles\r\n                            </button>\r\n                        </div>\r\n                        <EliteCard variant=\"glass\" glowColor=\"var(--color-writer)\" className=\"p-0 overflow-hidden\">\r\n                            <div className=\"bg-zinc-950/40 p-10 text-zinc-200 text-sm leading-relaxed font-sans max-h-[800px] overflow-y-auto selection:bg-red-900/50 shadow-inner\">\r\n                                {script.split('\\n').map((line: string, i: number) => (\r\n                                    <p key={i} className={`mb-4 ${line.startsWith('#') ? 'text-red-500 font-black text-lg uppercase tracking-tighter' : ''}`}>\r\n                                        {line}\r\n                                    </p>\r\n                                ))}\r\n                            </div>\r\n                        </EliteCard>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\Navbar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used.","line":7,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":47,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ExternalLink"},"fix":{"range":[231,245],"text":""},"desc":"Remove unused variable \"ExternalLink\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Moon' is defined but never used.","line":7,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":53,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Moon"},"fix":{"range":[245,251],"text":""},"desc":"Remove unused variable \"Moon\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sun' is defined but never used.","line":7,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":58,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sun"},"fix":{"range":[251,256],"text":""},"desc":"Remove unused variable \"Sun\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useTheme } from '@/context/ThemeContext';\r\nimport { EliteButton } from './ui/EliteButton';\r\nimport { LayoutDashboard, LogOut, ExternalLink, Moon, Sun } from 'lucide-react';\r\n\r\ninterface NavbarProps {\r\n    variant?: 'public' | 'app';\r\n}\r\n\r\nconst TOOL_NAV = [\r\n    { label: 'Aplicaciones', href: '/#apps' },\r\n    { label: 'Cursos', href: '/#cursos' },\r\n    { label: 'Precios', href: '/pricing' },\r\n];\r\n\r\nexport function Navbar({ variant = 'public' }: NavbarProps) {\r\n    const { user, logout } = useAuth();\r\n    const { theme, toggleTheme } = useTheme();\r\n    const isDark = theme === 'dark';\r\n\r\n    return (\r\n        <nav className=\"w-full border-b sticky top-0 z-50 backdrop-blur-2xl transition-colors duration-300\"\r\n            style={{ borderColor: 'var(--border)', background: isDark ? 'rgba(0,0,0,0.85)' : 'rgba(248,248,249,0.85)' }}>\r\n            <div className=\"container flex justify-between items-center py-4\">\r\n                <Link href=\"/\" className=\"text-xl font-black tracking-tighter uppercase group flex items-center gap-2\">\r\n                    <div className=\"w-8 h-8 bg-primary rounded-lg flex items-center justify-center text-white text-md group-hover:rotate-12 transition-transform duration-300 shadow-[0_0_20px_rgba(220,38,38,0.3)]\">V</div>\r\n                    <span className=\"hidden sm:block\" style={{ color: 'var(--foreground)' }}>VERSION</span>\r\n                </Link>\r\n\r\n                <div className=\"hidden md:flex gap-6 items-center\">\r\n                    {variant === 'public' && TOOL_NAV.map(item => (\r\n                        <Link key={item.href} href={item.href} className=\"nav-link\">{item.label}</Link>\r\n                    ))}\r\n\r\n                    {/* Theme Toggle */}\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={toggleTheme}\r\n                        aria-label={isDark ? 'Cambiar a modo claro' : 'Cambiar a modo oscuro'}\r\n                        className=\"relative w-12 h-6 rounded-full border transition-all duration-300 flex items-center px-0.5 hover:scale-110 active:scale-95\"\r\n                        style={{\r\n                            borderColor: isDark ? 'rgba(255,255,255,0.12)' : 'rgba(0,0,0,0.15)',\r\n                            background: isDark ? 'rgba(255,255,255,0.06)' : 'rgba(0,0,0,0.08)',\r\n                        }}>\r\n                        <span className=\"absolute left-1 text-[11px] select-none\">{isDark ? 'üåô' : ''}</span>\r\n                        <span className=\"absolute right-1 text-[11px] select-none\">{!isDark ? '‚òÄÔ∏è' : ''}</span>\r\n                        <span\r\n                            className=\"w-5 h-5 rounded-full transition-transform duration-300 shadow-sm flex-shrink-0\"\r\n                            style={{\r\n                                background: isDark ? '#fff' : '#000',\r\n                                transform: isDark ? 'translateX(0)' : 'translateX(24px)',\r\n                            }}\r\n                        />\r\n                    </button>\r\n\r\n                    {user ? (\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <EliteButton href=\"/dashboard\" size=\"sm\" variant=\"primary\" leftIcon={<LayoutDashboard size={14} />}>\r\n                                Dashboard\r\n                            </EliteButton>\r\n                            <button\r\n                                onClick={logout}\r\n                                className=\"w-10 h-10 rounded-full border border-white/10 flex items-center justify-center text-zinc-500 hover:text-red-500 hover:bg-red-500/10 transition-all\"\r\n                                title=\"Cerrar Sesi√≥n\"\r\n                            >\r\n                                <LogOut size={16} />\r\n                            </button>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <Link href=\"/login\"\r\n                                className=\"text-[11px] font-bold uppercase tracking-widest px-6 py-2.5 hover:text-primary transition-colors\"\r\n                            >\r\n                                Ingresar\r\n                            </Link>\r\n                            <EliteButton href=\"/dashboard\" size=\"sm\" variant=\"outline\">\r\n                                Acceso VIP\r\n                            </EliteButton>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Mobile */}\r\n                <div className=\"flex md:hidden items-center gap-3\">\r\n                    <button type=\"button\" onClick={toggleTheme}\r\n                        className=\"text-lg hover:scale-110 transition-transform\"\r\n                        aria-label=\"Toggle theme\">\r\n                        {isDark ? 'üåô' : '‚òÄÔ∏è'}\r\n                    </button>\r\n                    {user ? (\r\n                        <Link href=\"/dashboard\" className=\"text-primary text-[10px] font-bold\">Dashboard</Link>\r\n                    ) : (\r\n                        <Link href=\"/login\" className=\"text-[10px] font-bold\" style={{ color: 'var(--foreground)' }}>Ingresar</Link>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </nav>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ProtectedRoute.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\SmoothScroll.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\Toast.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\Toast.tsx:18:9\n  16 |\n  17 |     useEffect(() => {\n> 18 |         setIsVisible(true);\n     |         ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  19 |         const timer = setTimeout(() => {\n  20 |             setIsVisible(false);\n  21 |             setTimeout(onClose, 300); // Wait for fade out animation","line":18,"column":9,"nodeType":null,"endLine":18,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\nexport type ToastType = 'success' | 'error' | 'warning' | 'info';\r\n\r\ninterface ToastProps {\r\n    message: string;\r\n    type: ToastType;\r\n    duration?: number;\r\n    onClose: () => void;\r\n}\r\n\r\nexport default function Toast({ message, type, duration = 4000, onClose }: ToastProps) {\r\n    const [isVisible, setIsVisible] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setIsVisible(true);\r\n        const timer = setTimeout(() => {\r\n            setIsVisible(false);\r\n            setTimeout(onClose, 300); // Wait for fade out animation\r\n        }, duration);\r\n\r\n        return () => clearTimeout(timer);\r\n    }, [duration, onClose]);\r\n\r\n    const colors = {\r\n        success: 'bg-emerald-500/10 border-emerald-500/20 text-emerald-400',\r\n        error: 'bg-red-500/10 border-red-500/20 text-red-400',\r\n        warning: 'bg-amber-500/10 border-amber-500/20 text-amber-400',\r\n        info: 'bg-blue-500/10 border-blue-500/20 text-blue-400'\r\n    };\r\n\r\n    const icons = {\r\n        success: '‚ú®',\r\n        error: '‚ö†Ô∏è',\r\n        warning: 'üîî',\r\n        info: '‚ÑπÔ∏è'\r\n    };\r\n\r\n    return (\r\n        <div className={`fixed bottom-8 left-1/2 -translate-x-1/2 z-[200] transition-all duration-300 transform ${isVisible ? 'translate-y-0 opacity-100 scale-100' : 'translate-y-4 opacity-0 scale-95'}`}>\r\n            <div className={`px-5 py-3.5 rounded-2xl border backdrop-blur-xl shadow-[0_8px_30px_rgb(0,0,0,0.5)] flex items-center gap-3 min-w-[300px] max-w-md ${colors[type]}`}>\r\n                <span className=\"text-lg\">{icons[type]}</span>\r\n                <p className=\"text-[11px] font-black tracking-tight uppercase\">{message}</p>\r\n                <button onClick={() => setIsVisible(false)} className=\"ml-auto text-zinc-500 hover:text-white transition-colors\">‚úï</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ai\\EliteAssistant.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EliteButton' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":21,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"EliteButton"},"fix":{"range":[323,383],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ai\\EliteAssistant.tsx:28:17\n  26 |             const skillMessage = getContextualSkillResponse(pathname);\n  27 |             if (skillMessage) {\n> 28 |                 setShowSkillTip(true);\n     |                 ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  29 |                 // Trigger an AI message if it's the first time on this tool\n  30 |                 if (messages.length === 0) {\n  31 |                     setMessages([{ role: 'ai', content: skillMessage }]);","line":28,"column":17,"nodeType":null,"endLine":28,"endColumn":32}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { usePathname } from 'next/navigation';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { getAIResponse, getContextualSkillResponse } from '@/services/aiResponseService';\r\nimport { EliteCard } from '@/components/ui/EliteCard';\r\nimport { EliteButton } from '@/components/ui/EliteButton';\r\n\r\nexport const EliteAssistant = () => {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [messages, setMessages] = useState<{ role: 'ai' | 'user'; content: string }[]>([]);\r\n    const [input, setInput] = useState('');\r\n    const [isTyping, setIsTyping] = useState(false);\r\n    const [showSkillTip, setShowSkillTip] = useState(false);\r\n    const [lastPath, setLastPath] = useState('');\r\n\r\n    const pathname = usePathname();\r\n    const { user, deductCredits, refreshCredits } = useAuth();\r\n    const credits = user?.credits || 0;\r\n    const scrollRef = useRef<HTMLDivElement>(null);\r\n\r\n    // Contextual detection\r\n    useEffect(() => {\r\n        if (pathname !== lastPath) {\r\n            const skillMessage = getContextualSkillResponse(pathname);\r\n            if (skillMessage) {\r\n                setShowSkillTip(true);\r\n                // Trigger an AI message if it's the first time on this tool\r\n                if (messages.length === 0) {\r\n                    setMessages([{ role: 'ai', content: skillMessage }]);\r\n                }\r\n            }\r\n            setLastPath(pathname);\r\n        }\r\n    }, [pathname, lastPath, messages.length]);\r\n\r\n    useEffect(() => {\r\n        if (scrollRef.current) {\r\n            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n        }\r\n    }, [messages, isTyping]);\r\n\r\n    const handleSend = () => {\r\n        if (!input.trim()) return;\r\n\r\n        const COST = 1;\r\n        if (credits < COST) {\r\n            setMessages(prev => [...prev, { role: 'ai', content: '‚ùå Saldo insuficiente.' }]);\r\n            return;\r\n        }\r\n\r\n        const userMsg = { role: 'user' as const, content: input };\r\n        setMessages(prev => [...prev, userMsg]);\r\n        setInput('');\r\n        setIsTyping(true);\r\n        deductCredits(COST);\r\n\r\n        setTimeout(() => {\r\n            const aiContent = getAIResponse(userMsg.content);\r\n            setMessages(prev => [...prev, { role: 'ai', content: aiContent }]);\r\n            setIsTyping(false);\r\n            refreshCredits();\r\n        }, 800);\r\n    };\r\n\r\n    if (pathname === '/login' || pathname === '/register') return null;\r\n\r\n    return (\r\n        <div className=\"fixed bottom-8 right-8 z-[100] flex flex-col items-end gap-4\">\r\n            {/* Contextual Tip */}\r\n            {showSkillTip && !isOpen && (\r\n                <div className=\"bg-zinc-950/80 backdrop-blur-md border border-primary/20 p-3 rounded-2xl shadow-2xl animate-bounce-slow max-w-[200px] relative\">\r\n                    <button\r\n                        onClick={() => setShowSkillTip(false)}\r\n                        className=\"absolute -top-2 -right-2 w-5 h-5 bg-zinc-900 border border-white/10 rounded-full flex items-center justify-center text-[8px]\"\r\n                    >\r\n                        ‚úï\r\n                    </button>\r\n                    <p className=\"text-[9px] font-bold text-primary uppercase tracking-widest mb-1\">Elite Skill Activa</p>\r\n                    <p className=\"text-[10px] text-zinc-300 leading-tight\">Pulsa para asistencia t√©cnica en esta secci√≥n.</p>\r\n                </div>\r\n            )}\r\n\r\n            {/* Chat Window */}\r\n            {isOpen && (\r\n                <EliteCard\r\n                    variant=\"glass\"\r\n                    title=\"VERSION Elite\"\r\n                    subtitle=\"Neural Support\"\r\n                    className=\"w-[350px] md:w-[400px] h-[500px] flex flex-col shadow-[0_0_50px_rgba(0,0,0,0.5)] border-primary/10 animate-fade-up\"\r\n                    headerAction={\r\n                        <button onClick={() => setIsOpen(false)} className=\"text-zinc-500 hover:text-white transition-colors\">\r\n                            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                            </svg>\r\n                        </button>\r\n                    }\r\n                >\r\n                    <div ref={scrollRef} className=\"flex-1 overflow-y-auto space-y-4 pr-2 custom-scrollbar min-h-0\">\r\n                        {messages.length === 0 && (\r\n                            <div className=\"text-center py-10\">\r\n                                <div className=\"text-3xl mb-4 group-hover:animate-pulse\">ü§ñ</div>\r\n                                <p className=\"text-xs text-zinc-500 font-medium\">Hola Rebelde. Soy tu soporte integrado. ¬øQu√© datos del Master necesitas?</p>\r\n                            </div>\r\n                        )}\r\n                        {messages.map((m, i) => (\r\n                            <div key={i} className={`flex flex-col ${m.role === 'user' ? 'items-end' : 'items-start'}`}>\r\n                                <div className={`p-4 rounded-2xl text-xs leading-relaxed ${m.role === 'ai'\r\n                                    ? 'bg-white/[0.03] border border-white/[0.05] text-zinc-300 rounded-tl-none'\r\n                                    : 'bg-primary text-white rounded-tr-none'\r\n                                    } max-w-[85%]`}>\r\n                                    {m.content}\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                        {isTyping && (\r\n                            <div className=\"flex gap-1 items-center px-1\">\r\n                                <div className=\"w-1 h-1 bg-primary rounded-full animate-bounce\" style={{ animationDelay: '0ms' }} />\r\n                                <div className=\"w-1 h-1 bg-primary rounded-full animate-bounce\" style={{ animationDelay: '150ms' }} />\r\n                                <div className=\"w-1 h-1 bg-primary rounded-full animate-bounce\" style={{ animationDelay: '300ms' }} />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"mt-4 pt-4 border-t border-white/[0.04]\">\r\n                        <div className=\"relative\">\r\n                            <input\r\n                                type=\"text\"\r\n                                value={input}\r\n                                onChange={(e) => setInput(e.target.value)}\r\n                                onKeyDown={(e) => e.key === 'Enter' && handleSend()}\r\n                                placeholder=\"Escribe tu consulta...\"\r\n                                className=\"w-full bg-white/[0.03] border border-white/[0.06] rounded-xl p-3 pr-20 text-xs focus:outline-none focus:border-primary/30 transition-all font-medium\"\r\n                            />\r\n                            <button\r\n                                onClick={handleSend}\r\n                                className=\"absolute right-1 top-1/2 -translate-y-1/2 px-3 py-1.5 bg-primary text-[9px] font-bold uppercase tracking-widest rounded-lg hover:bg-primary/90 transition-all active:scale-95\"\r\n                            >\r\n                                Enviar\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </EliteCard>\r\n            )}\r\n\r\n            {/* Floating Orb Button */}\r\n            <button\r\n                onClick={() => { setIsOpen(!isOpen); setShowSkillTip(false); }}\r\n                className={`\r\n                    w-16 h-16 rounded-full flex items-center justify-center text-2xl transition-all duration-500 shadow-2xl relative group\r\n                    ${isOpen ? 'bg-zinc-900 border border-white/5 scale-90 rotate-90' : 'bg-black border border-primary/20 hover:border-primary/50 hover:shadow-[0_0_30px_rgba(220,38,38,0.3)]'}\r\n                `}\r\n            >\r\n                <div className={`absolute inset-0 rounded-full bg-primary/10 animate-ping opacity-20 ${isOpen ? 'hidden' : ''}`} />\r\n                <span className={isOpen ? 'text-zinc-500' : 'group-hover:scale-110 transition-transform'}>\r\n                    {isOpen ? '‚úï' : 'ü§ñ'}\r\n                </span>\r\n\r\n                {!isOpen && (\r\n                    <div className=\"absolute -top-1 -right-1 w-4 h-4 bg-primary text-[8px] font-black flex items-center justify-center rounded-full border-2 border-black animate-bounce\">\r\n                        !\r\n                    </div>\r\n                )}\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\CreditsBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\EliteBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\EliteButton.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":121,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4847,4850],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4847,4850],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\EliteButton.tsx:123:22\n  121 |                     {...(props as any)}\n  122 |                 >\n> 123 |                     <Content />\n      |                      ^^^^^^^ This component is created during render\n  124 |                 </Link>\n  125 |             </motion.div>\n  126 |         );\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\EliteButton.tsx:84:21\n   82 |     const variantStyle = getVariantStyles();\n   83 |\n>  84 |     const Content = () => (\n      |                     ^^^^^^^\n>  85 |         <>\n      | ^^^^^^^^^^\n>  86 |             {isLoading ? (\n      ‚Ä¶\n      | ^^^^^^^^^^\n> 104 |         </>\n      | ^^^^^^^^^^\n> 105 |     );\n      | ^^^^^^ The component is created during render here\n  106 |\n  107 |     const animationProps = {\n  108 |         whileHover: { scale: 1.02, y: -1 },","line":123,"column":22,"nodeType":null,"endLine":123,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":137,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":137,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5329,5332],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5329,5332],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\EliteButton.tsx:139:14\n  137 |             {...props as any}\n  138 |         >\n> 139 |             <Content />\n      |              ^^^^^^^ This component is created during render\n  140 |         </motion.button>\n  141 |     );\n  142 | };\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\EliteButton.tsx:84:21\n   82 |     const variantStyle = getVariantStyles();\n   83 |\n>  84 |     const Content = () => (\n      |                     ^^^^^^^\n>  85 |         <>\n      | ^^^^^^^^^^\n>  86 |             {isLoading ? (\n      ‚Ä¶\n      | ^^^^^^^^^^\n> 104 |         </>\n      | ^^^^^^^^^^\n> 105 |     );\n      | ^^^^^^ The component is created during render here\n  106 |\n  107 |     const animationProps = {\n  108 |         whileHover: { scale: 1.02, y: -1 },","line":139,"column":14,"nodeType":null,"endLine":139,"endColumn":21}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { motion } from 'framer-motion';\r\n\r\ninterface EliteButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\r\n    variant?: 'primary' | 'secondary' | 'outline' | 'ghost' | 'danger' | 'success';\r\n    size?: 'sm' | 'md' | 'lg' | 'xl';\r\n    isLoading?: boolean;\r\n    leftIcon?: React.ReactNode;\r\n    rightIcon?: React.ReactNode;\r\n    fullWidth?: boolean;\r\n    href?: string;\r\n}\r\n\r\nexport const EliteButton = ({\r\n    children,\r\n    variant = 'primary',\r\n    size = 'md',\r\n    isLoading = false,\r\n    leftIcon,\r\n    rightIcon,\r\n    fullWidth = false,\r\n    href,\r\n    className = '',\r\n    disabled,\r\n    ...props\r\n}: EliteButtonProps) => {\r\n    const baseStyles = 'inline-flex items-center justify-center font-bold uppercase tracking-widest transition-all duration-300 rounded-xl disabled:opacity-50 disabled:cursor-not-allowed border group relative overflow-hidden focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-black';\r\n\r\n    const sizeStyles = {\r\n        sm: 'px-4 py-2 text-[10px]',\r\n        md: 'px-6 py-3 text-[11px]',\r\n        lg: 'px-8 py-4 text-xs',\r\n        xl: 'px-10 py-5 text-sm tracking-[0.2em]'\r\n    };\r\n\r\n    const getVariantStyles = () => {\r\n        switch (variant) {\r\n            case 'primary':\r\n                return {\r\n                    backgroundColor: 'var(--foreground)',\r\n                    color: 'var(--background)',\r\n                    borderColor: 'var(--foreground)',\r\n                };\r\n            case 'secondary':\r\n                return {\r\n                    backgroundColor: 'var(--surface-2)',\r\n                    color: 'var(--foreground)',\r\n                    borderColor: 'var(--border)'\r\n                };\r\n            case 'outline':\r\n                return {\r\n                    backgroundColor: 'transparent',\r\n                    color: 'var(--foreground)',\r\n                    borderColor: 'var(--border)'\r\n                };\r\n            case 'ghost':\r\n                return {\r\n                    backgroundColor: 'transparent',\r\n                    color: 'var(--muted)',\r\n                    borderColor: 'transparent'\r\n                };\r\n            case 'danger':\r\n                return {\r\n                    backgroundColor: 'rgba(220, 38, 38, 0.1)',\r\n                    color: '#ef4444',\r\n                    borderColor: 'rgba(220, 38, 38, 0.2)'\r\n                };\r\n            case 'success':\r\n                return {\r\n                    backgroundColor: 'rgba(34, 197, 94, 0.1)',\r\n                    color: '#22c55e',\r\n                    borderColor: 'rgba(34, 197, 94, 0.2)'\r\n                };\r\n            default:\r\n                return {};\r\n        }\r\n    };\r\n\r\n    const widthStyle = fullWidth ? 'w-full' : '';\r\n    const variantStyle = getVariantStyles();\r\n\r\n    const Content = () => (\r\n        <>\r\n            {isLoading ? (\r\n                <div className=\"flex items-center gap-2\">\r\n                    <svg className=\"animate-spin h-3 w-3\" viewBox=\"0 0 24 24\">\r\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\"></circle>\r\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                    </svg>\r\n                    <span>Procesando...</span>\r\n                </div>\r\n            ) : (\r\n                <div className=\"flex items-center justify-center relative z-10\">\r\n                    {leftIcon && <span className=\"mr-2 opacity-70 transition-opacity group-hover:opacity-100\">{leftIcon}</span>}\r\n                    {children}\r\n                    {rightIcon && <span className=\"ml-2 opacity-70 transition-opacity group-hover:opacity-100\">{rightIcon}</span>}\r\n                </div>\r\n            )}\r\n\r\n            {/* Hover Glow effect */}\r\n            <div className=\"absolute inset-0 bg-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300\" />\r\n        </>\r\n    );\r\n\r\n    const animationProps = {\r\n        whileHover: { scale: 1.02, y: -1 },\r\n        whileTap: { scale: 0.98, y: 0 },\r\n        transition: { type: 'spring' as const, stiffness: 400, damping: 10 }\r\n    };\r\n\r\n    if (href) {\r\n        return (\r\n            <motion.div {...animationProps} className={widthStyle}>\r\n                <Link\r\n                    href={href}\r\n                    className={`${baseStyles} ${sizeStyles[size]} ${widthStyle} ${className} ${variant === 'outline' ? 'hover:bg-foreground hover:text-background border-zinc-800' : ''}`}\r\n                    style={variantStyle}\r\n                    aria-disabled={disabled || isLoading}\r\n                    {...(props as any)}\r\n                >\r\n                    <Content />\r\n                </Link>\r\n            </motion.div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <motion.button\r\n            {...animationProps}\r\n            className={`${baseStyles} ${sizeStyles[size]} ${widthStyle} ${className}`}\r\n            style={variantStyle}\r\n            disabled={disabled || isLoading}\r\n            aria-disabled={disabled || isLoading}\r\n            aria-busy={isLoading}\r\n            {...props as any}\r\n        >\r\n            <Content />\r\n        </motion.button>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\EliteCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\EliteInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\EmptyState.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\ui\\PricingCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\visual\\HeroBackground.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\visual\\HeroBackground.tsx:13:33\n  11 |         const positions = new Float32Array(count * 3)\n  12 |         for (let i = 0; i < count; i++) {\n> 13 |             positions[i * 3] = (Math.random() - 0.5) * 10\n     |                                 ^^^^^^^^^^^^^ Cannot call impure function\n  14 |             positions[i * 3 + 1] = (Math.random() - 0.5) * 10\n  15 |             positions[i * 3 + 2] = (Math.random() - 0.5) * 10\n  16 |         }","line":13,"column":33,"nodeType":null,"endLine":13,"endColumn":46},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\visual\\HeroBackground.tsx:14:37\n  12 |         for (let i = 0; i < count; i++) {\n  13 |             positions[i * 3] = (Math.random() - 0.5) * 10\n> 14 |             positions[i * 3 + 1] = (Math.random() - 0.5) * 10\n     |                                     ^^^^^^^^^^^^^ Cannot call impure function\n  15 |             positions[i * 3 + 2] = (Math.random() - 0.5) * 10\n  16 |         }\n  17 |         return positions","line":14,"column":37,"nodeType":null,"endLine":14,"endColumn":50},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\components\\visual\\HeroBackground.tsx:15:37\n  13 |             positions[i * 3] = (Math.random() - 0.5) * 10\n  14 |             positions[i * 3 + 1] = (Math.random() - 0.5) * 10\n> 15 |             positions[i * 3 + 2] = (Math.random() - 0.5) * 10\n     |                                     ^^^^^^^^^^^^^ Cannot call impure function\n  16 |         }\n  17 |         return positions\n  18 |     }, [])","line":15,"column":37,"nodeType":null,"endLine":15,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'z' is assigned a value but never used.","line":29,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":20}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\nimport React, { useRef, useMemo } from 'react'\r\nimport { Canvas, useFrame } from '@react-three/fiber'\r\nimport * as THREE from 'three'\r\n\r\nfunction ParticleGrid() {\r\n    const pointsRef = useRef<THREE.Points>(null!)\r\n    const count = 2000\r\n\r\n    const particles = useMemo(() => {\r\n        const positions = new Float32Array(count * 3)\r\n        for (let i = 0; i < count; i++) {\r\n            positions[i * 3] = (Math.random() - 0.5) * 10\r\n            positions[i * 3 + 1] = (Math.random() - 0.5) * 10\r\n            positions[i * 3 + 2] = (Math.random() - 0.5) * 10\r\n        }\r\n        return positions\r\n    }, [])\r\n\r\n    useFrame((state) => {\r\n        const time = state.clock.getElapsedTime()\r\n        pointsRef.current.rotation.y = time * 0.05\r\n        pointsRef.current.rotation.x = time * 0.03\r\n\r\n        // Suave movimiento ondulado\r\n        const positions = pointsRef.current.geometry.attributes.position.array as Float32Array\r\n        for (let i = 0; i < count; i++) {\r\n            const x = positions[i * 3]\r\n            const z = positions[i * 3 + 2]\r\n            positions[i * 3 + 1] += Math.sin(time + x) * 0.001\r\n        }\r\n        pointsRef.current.geometry.attributes.position.needsUpdate = true\r\n    })\r\n\r\n    return (\r\n        <points ref={pointsRef}>\r\n            <bufferGeometry>\r\n                <bufferAttribute\r\n                    attach=\"attributes-position\"\r\n                    args={[particles, 3]}\r\n                />\r\n            </bufferGeometry>\r\n            <pointsMaterial\r\n                size={0.015}\r\n                color=\"#ff0000\"\r\n                transparent\r\n                opacity={0.4}\r\n                sizeAttenuation\r\n                blending={THREE.AdditiveBlending}\r\n            />\r\n        </points>\r\n    )\r\n}\r\n\r\nexport function HeroBackground() {\r\n    return (\r\n        <div className=\"absolute inset-0 -z-20 bg-black pointer-events-none overflow-hidden\">\r\n            <div className=\"absolute inset-0 bg-gradient-to-b from-transparent via-black/50 to-black\" />\r\n            <Canvas camera={{ position: [0, 0, 5], fov: 60 }}>\r\n                <fog attach=\"fog\" args={['#000', 5, 15]} />\r\n                <ambientLight intensity={0.5} />\r\n                <ParticleGrid />\r\n            </Canvas>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\context\\AuthContext.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\context\\AuthContext.tsx:40:13\n  38 |\n  39 |         if (storedToken && storedUser) {\n> 40 |             setToken(storedToken);\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  41 |             try {\n  42 |                 setUser(JSON.parse(storedUser));\n  43 |             } catch (e) {","line":40,"column":13,"nodeType":null,"endLine":40,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface UserProfile {\r\n    id?: string;\r\n    email: string;\r\n    name: string;\r\n    role: string;\r\n    credits: number;\r\n}\r\n\r\ninterface AuthContextType {\r\n    user: UserProfile | null;\r\n    token: string | null;\r\n    isAuthenticated: boolean;\r\n    isAdmin: boolean;\r\n    loading: boolean;\r\n    login: (token: string, user: UserProfile) => void;\r\n    logout: () => void;\r\n    deductCredits: (amount: number) => void;\r\n    refreshCredits: () => Promise<void>;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\r\n    const [user, setUser] = useState<UserProfile | null>(null);\r\n    const [token, setToken] = useState<string | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        // Inicializar desde LocalStorage al cargar\r\n        const storedToken = localStorage.getItem('token');\r\n        const storedUser = localStorage.getItem('user_profile');\r\n\r\n        if (storedToken && storedUser) {\r\n            setToken(storedToken);\r\n            try {\r\n                setUser(JSON.parse(storedUser));\r\n            } catch (e) {\r\n                console.error(\"Error parseando usuario:\", e);\r\n                // logout();\r\n            }\r\n        }\r\n        setLoading(false);\r\n    }, []);\r\n\r\n    const login = (newToken: string, newUser: UserProfile) => {\r\n        setToken(newToken);\r\n        setUser(newUser);\r\n        localStorage.setItem('token', newToken);\r\n        localStorage.setItem('user_profile', JSON.stringify(newUser));\r\n    };\r\n\r\n    const logout = (reason?: string) => {\r\n        console.warn('Forcing logout. Reason:', reason);\r\n        setToken(null);\r\n        setUser(null);\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('user_profile');\r\n        localStorage.removeItem('backend_url');\r\n        router.push('/login');\r\n    };\r\n\r\n    const deductCredits = (amount: number) => {\r\n        if (user) {\r\n            const updatedUser = { ...user, credits: Math.max(0, user.credits - amount) };\r\n            setUser(updatedUser);\r\n            localStorage.setItem('user_profile', JSON.stringify(updatedUser));\r\n        }\r\n    };\r\n\r\n    const refreshCredits = async () => {\r\n        if (!token || !user) return;\r\n        try {\r\n            const apiUrl = localStorage.getItem('backend_url') || process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8000\";\r\n            const res = await fetch(`${apiUrl}/users/me/credits`, {\r\n                headers: { 'Authorization': `Bearer ${token}` }\r\n            });\r\n\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                if (data.credits !== undefined) {\r\n                    const updatedUser = { ...user, credits: data.credits, role: data.role || user.role };\r\n                    setUser(updatedUser);\r\n                    localStorage.setItem('user_profile', JSON.stringify(updatedUser));\r\n                }\r\n            } else {\r\n                console.warn('refreshCredits fall√≥ con status:', res.status);\r\n                if (res.status === 401) {\r\n                    // logout('401 in refreshCredits'); \r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error fetching latest credits:\", error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{\r\n            user,\r\n            token,\r\n            isAuthenticated: !!token,\r\n            isAdmin: user?.role === 'admin',\r\n            loading,\r\n            login,\r\n            logout,\r\n            deductCredits,\r\n            refreshCredits\r\n        }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useAuth() {\r\n    const context = useContext(AuthContext);\r\n    if (context === undefined) {\r\n        throw new Error('useAuth must be used within an AuthProvider');\r\n    }\r\n    return context;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\context\\ThemeContext.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`applyTheme` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\context\\ThemeContext.tsx:31:9\n  29 |             resolved = prefersDark ? 'dark' : 'light';\n  30 |         }\n> 31 |         applyTheme(resolved);\n     |         ^^^^^^^^^^ `applyTheme` accessed before it is declared\n  32 |         setThemeState(resolved);\n  33 |         setMounted(true);\n  34 |     }, []);\n\nC:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\context\\ThemeContext.tsx:36:5\n  34 |     }, []);\n  35 |\n> 36 |     const applyTheme = (t: Theme) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 37 |         const html = document.documentElement;\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 38 |         if (t === 'light') {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 39 |             html.classList.add('light');\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |         } else {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 41 |             html.classList.remove('light');\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 42 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 43 |         localStorage.setItem('version_theme', t);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 44 |     };\n     | ^^^^^^^ `applyTheme` is declared here\n  45 |\n  46 |     const setTheme = (t: Theme) => {\n  47 |         applyTheme(t);","line":31,"column":9,"nodeType":null,"endLine":31,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { createContext, useContext, useEffect, useState, ReactNode } from 'react';\r\n\r\ntype Theme = 'dark' | 'light';\r\n\r\ninterface ThemeContextValue {\r\n    theme: Theme;\r\n    toggleTheme: () => void;\r\n    setTheme: (t: Theme) => void;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextValue>({\r\n    theme: 'dark',\r\n    toggleTheme: () => { },\r\n    setTheme: () => { },\r\n});\r\n\r\nexport function ThemeProvider({ children }: { children: ReactNode }) {\r\n    const [theme, setThemeState] = useState<Theme>('dark');\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        // Read from localStorage or fall back to system preference\r\n        const stored = localStorage.getItem('version_theme') as Theme | null;\r\n        let resolved: Theme = stored || 'dark';\r\n        if (!stored) {\r\n            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;\r\n            resolved = prefersDark ? 'dark' : 'light';\r\n        }\r\n        applyTheme(resolved);\r\n        setThemeState(resolved);\r\n        setMounted(true);\r\n    }, []);\r\n\r\n    const applyTheme = (t: Theme) => {\r\n        const html = document.documentElement;\r\n        if (t === 'light') {\r\n            html.classList.add('light');\r\n        } else {\r\n            html.classList.remove('light');\r\n        }\r\n        localStorage.setItem('version_theme', t);\r\n    };\r\n\r\n    const setTheme = (t: Theme) => {\r\n        applyTheme(t);\r\n        setThemeState(t);\r\n    };\r\n\r\n    const toggleTheme = () => setTheme(theme === 'dark' ? 'light' : 'dark');\r\n\r\n    // Prevent flash: inject theme class on first render via inline script\r\n    if (!mounted) return (\r\n        <ThemeContext.Provider value={{ theme: 'dark', toggleTheme, setTheme }}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n\r\n    return (\r\n        <ThemeContext.Provider value={{ theme, toggleTheme, setTheme }}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n}\r\n\r\nexport const useTheme = () => useContext(ThemeContext);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\lib\\api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\services\\aiResponseService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\valen\\Documents\\PROYECTOS\\VERSION\\version-web\\src\\services\\aiVersionClient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]